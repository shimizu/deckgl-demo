var Yf=Object.defineProperty;var qf=(t,e,n)=>e in t?Yf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var pe=(t,e,n)=>qf(t,typeof e!="symbol"?e+"":e,n);import{r as E,a as ai,R as Xl,b as R,c as Xf,g as li,d as Xn}from"./react-ZEDBDnLt.js";import{l as Ei,L as It,p as Lt,a as Gt,M as Je,b as Cr,C as gt,c as Jl,d as Wo,U as Bt,G as jt,e as Be,f as Jf,g as Ql,T as ec,h as ci,i as Qf,A as tc,j as Os,k as oe,m as ed,n as $e,Q as ks,o as Hi,q as yr,E as td,r as nd,s as rd,W as Rs,R as id,t as Jn,u as od,v as sd,w as ad,x as ld,y as cd,z as ud,B as nc,F as fd,H as dd,I as hd,S as rc,J as pd}from"./deckgl_core-C7kG8c7H.js";import{D as gd}from"./deckgl_react-DF_Ky9qC.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var ic={exports:{}},ui={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var md=E,yd=Symbol.for("react.element"),vd=Symbol.for("react.fragment"),bd=Object.prototype.hasOwnProperty,xd=md.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_d={key:!0,ref:!0,__self:!0,__source:!0};function oc(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)bd.call(e,r)&&!_d.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:yd,type:t,key:o,ref:s,props:i,_owner:xd.current}}ui.Fragment=vd;ui.jsx=oc;ui.jsxs=oc;ic.exports=ui;var de=ic.exports,Gi={},Is=ai;Gi.createRoot=Is.createRoot,Gi.hydrateRoot=Is.hydrateRoot;function wd(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function sc(...t){return e=>t.forEach(n=>wd(n,e))}function Kt(...t){return E.useCallback(sc(...t),t)}var ac=E.forwardRef((t,e)=>{const{children:n,...r}=t,i=E.Children.toArray(n),o=i.find(Sd);if(o){const s=o.props.children,a=i.map(l=>l===o?E.Children.count(s)>1?E.Children.only(null):E.isValidElement(s)?s.props.children:null:l);return de.jsx(Ki,{...r,ref:e,children:E.isValidElement(s)?E.cloneElement(s,void 0,a):null})}return de.jsx(Ki,{...r,ref:e,children:n})});ac.displayName="Slot";var Ki=E.forwardRef((t,e)=>{const{children:n,...r}=t;if(E.isValidElement(n)){const i=Ed(n);return E.cloneElement(n,{...Cd(r,n.props),ref:e?sc(e,i):i})}return E.Children.count(n)>1?E.Children.only(null):null});Ki.displayName="SlotClone";var lc=({children:t})=>de.jsx(de.Fragment,{children:t});function Sd(t){return E.isValidElement(t)&&t.type===lc}function Cd(t,e){const n={...e};for(const r in e){const i=t[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...a)=>{o(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...t,...n}}function Ed(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Pd=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Mt=Pd.reduce((t,e)=>{const n=E.forwardRef((r,i)=>{const{asChild:o,...s}=r,a=o?ac:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),de.jsx(a,{...s,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Ad(t,e){t&&ai.flushSync(()=>t.dispatchEvent(e))}var Ut=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},Td="Portal",cc=E.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[i,o]=E.useState(!1);Ut(()=>o(!0),[]);const s=n||i&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return s?Xl.createPortal(de.jsx(Mt.div,{...r,ref:e}),s):null});cc.displayName=Td;var Od=cc,Ls=Object.prototype.hasOwnProperty;function In(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&In(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(Ls.call(t,n)&&++r&&!Ls.call(e,n)||!(n in e)||!In(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}function fi(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(e,n[r])||!Object.is(t[n[r]],e[n[r]]))return!1;return!0}var di=function(e,n,r,i){this.name=e,this.fn=n,this.args=r,this.modifiers=i};di.prototype._test=function(e){var n=this.fn;try{on(this.modifiers.slice(),n,this)(e)}catch{n=function(){return!1}}try{return on(this.modifiers.slice(),n,this)(e)}catch{return!1}};di.prototype._check=function(e){try{on(this.modifiers.slice(),this.fn,this)(e)}catch{if(on(this.modifiers.slice(),function(r){return r},this)(!1))return}if(!on(this.modifiers.slice(),this.fn,this)(e))throw null};di.prototype._testAsync=function(e){var n=this;return new Promise(function(r,i){fc(n.modifiers.slice(),n.fn,n)(e).then(function(o){o?r(e):i(null)}).catch(function(o){return i(o)})})};function uc(t,e){return e===void 0&&(e="simple"),typeof t=="object"?t[e]:t}function on(t,e,n){if(t.length){var r=t.shift(),i=on(t,e,n);return r.perform(i,n)}else return uc(e)}function fc(t,e,n){if(t.length){var r=t.shift(),i=fc(t,e,n);return r.performAsync(i,n)}else return function(o){return Promise.resolve(uc(e,"async")(o))}}var kd=function(e,n,r){this.name=e,this.perform=n,this.performAsync=r},Vo=function(t){function e(n,r,i,o){for(var s=[],a=arguments.length-4;a-- >0;)s[a]=arguments[a+4];t.call(this,s),t.captureStackTrace&&t.captureStackTrace(this,e),this.rule=n,this.value=r,this.cause=i,this.target=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),at=function(e,n){e===void 0&&(e=[]),n===void 0&&(n=[]),this.chain=e,this.nextRuleModifiers=n};at.prototype._applyRule=function(e,n){var r=this;return function(){for(var i=[],o=arguments.length;o--;)i[o]=arguments[o];return r.chain.push(new di(n,e.apply(r,i),i,r.nextRuleModifiers)),r.nextRuleModifiers=[],r}};at.prototype._applyModifier=function(e,n){return this.nextRuleModifiers.push(new kd(n,e.simple,e.async)),this};at.prototype._clone=function(){return new at(this.chain.slice(),this.nextRuleModifiers.slice())};at.prototype.test=function(e){return this.chain.every(function(n){return n._test(e)})};at.prototype.testAll=function(e){var n=[];return this.chain.forEach(function(r){try{r._check(e)}catch(i){n.push(new Vo(r,e,i))}}),n};at.prototype.check=function(e){this.chain.forEach(function(n){try{n._check(e)}catch(r){throw new Vo(n,e,r)}})};at.prototype.testAsync=function(e){var n=this;return new Promise(function(r,i){dc(e,n.chain.slice(),r,i)})};function dc(t,e,n,r){if(e.length){var i=e.shift();i._testAsync(t).then(function(){dc(t,e,n,r)},function(o){r(new Vo(i,t,o))})}else n(t)}var Ms=function(t,e){return e&&typeof t=="string"&&t.trim().length===0?!0:t==null};function Rd(t,e){return e===void 0&&(e=!1),{simple:function(n){return Ms(n,e)||t.check(n)===void 0},async:function(n){return Ms(n,e)||t.testAsync(n)}}}function We(){return typeof Proxy<"u"?hc(new at):Zi(new at)}var Ln={};We.extend=function(t){Object.assign(Ln,t)};We.clearCustomRules=function(){Ln={}};function hc(t){return new Proxy(t,{get:function(n,r){if(r in n)return n[r];var i=hc(t._clone());if(r in Er)return i._applyModifier(Er[r],r);if(r in Ln)return i._applyRule(Ln[r],r);if(r in Yi)return i._applyRule(Yi[r],r)}})}function Zi(t){var e=function(i,o){return Object.keys(i).forEach(function(s){o[s]=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var c=Zi(o._clone()),u=c._applyRule(i[s],s).apply(void 0,a);return u}}),o},n=e(Yi,t),r=e(Ln,n);return Object.keys(Er).forEach(function(i){Object.defineProperty(r,i,{get:function(){var o=Zi(r._clone());return o._applyModifier(Er[i],i)}})}),r}var Er={not:{simple:function(t){return function(e){return!t(e)}},async:function(t){return function(e){return Promise.resolve(t(e)).then(function(n){return!n}).catch(function(){return!0})}}},some:{simple:function(t){return function(e){return Qn(e).some(function(n){try{return t(n)}catch{return!1}})}},async:function(t){return function(e){return Promise.all(Qn(e).map(function(n){try{return t(n).catch(function(){return!1})}catch{return!1}})).then(function(n){return n.some(Boolean)})}}},every:{simple:function(t){return function(e){return e!==!1&&Qn(e).every(t)}},async:function(t){return function(e){return Promise.all(Qn(e).map(t)).then(function(n){return n.every(Boolean)})}}},strict:{simple:function(t,e){return function(n){return Ds(e)&&n&&typeof n=="object"?Object.keys(e.args[0]).length===Object.keys(n).length&&t(n):t(n)}},async:function(t,e){return function(n){return Promise.resolve(t(n)).then(function(r){return Ds(e)&&n&&typeof n=="object"?Object.keys(e.args[0]).length===Object.keys(n).length&&r:r}).catch(function(){return!1})}}}};function Ds(t){return t&&t.name==="schema"&&t.args.length>0&&typeof t.args[0]=="object"}function Qn(t){return typeof t=="string"?t.split(""):t}var Yi={equal:function(t){return function(e){return e==t}},exact:function(t){return function(e){return e===t}},number:function(t){return t===void 0&&(t=!0),function(e){return typeof e=="number"&&(t||isFinite(e))}},integer:function(){return function(t){var e=Number.isInteger||Id;return e(t)}},numeric:function(){return function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},string:function(){return Yt("string")},boolean:function(){return Yt("boolean")},undefined:function(){return Yt("undefined")},null:function(){return Yt("null")},array:function(){return Yt("array")},object:function(){return Yt("object")},instanceOf:function(t){return function(e){return e instanceof t}},pattern:function(t){return function(e){return t.test(e)}},lowercase:function(){return function(t){return typeof t=="boolean"||t===t.toLowerCase()&&t.trim()!==""}},uppercase:function(){return function(t){return t===t.toUpperCase()&&t.trim()!==""}},vowel:function(){return function(t){return/^[aeiou]+$/i.test(t)}},consonant:function(){return function(t){return/^(?=[^aeiou])([a-z]+)$/i.test(t)}},first:function(t){return function(e){return e[0]==t}},last:function(t){return function(e){return e[e.length-1]==t}},empty:function(){return function(t){return t.length===0}},length:function(t,e){return function(n){return n.length>=t&&n.length<=(e||t)}},minLength:function(t){return function(e){return e.length>=t}},maxLength:function(t){return function(e){return e.length<=t}},negative:function(){return function(t){return t<0}},positive:function(){return function(t){return t>=0}},between:function(t,e){return function(n){return n>=t&&n<=e}},range:function(t,e){return function(n){return n>=t&&n<=e}},lessThan:function(t){return function(e){return e<t}},lessThanOrEqual:function(t){return function(e){return e<=t}},greaterThan:function(t){return function(e){return e>t}},greaterThanOrEqual:function(t){return function(e){return e>=t}},even:function(){return function(t){return t%2===0}},odd:function(){return function(t){return t%2!==0}},includes:function(t){return function(e){return~e.indexOf(t)}},schema:function(t){return Ld(t)},passesAnyOf:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function(n){return t.some(function(r){return r.test(n)})}},optional:Rd};function Yt(t){return function(e){return Array.isArray(e)&&t==="array"||e===null&&t==="null"||typeof e===t}}function Id(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function Ld(t){return{simple:function(e){var n=[];if(Object.keys(t).forEach(function(r){var i=t[r];try{i.check((e||{})[r])}catch(o){o.target=r,n.push(o)}}),n.length>0)throw n;return!0},async:function(e){var n=[],r=Object.keys(t).map(function(i){var o=t[i];return o.testAsync((e||{})[i]).catch(function(s){s.target=i,n.push(s)})});return Promise.all(r).then(function(){if(n.length>0)throw n;return!0})}}}var me="colors",De="sizes",ie="space",Md={gap:ie,gridGap:ie,columnGap:ie,gridColumnGap:ie,rowGap:ie,gridRowGap:ie,inset:ie,insetBlock:ie,insetBlockEnd:ie,insetBlockStart:ie,insetInline:ie,insetInlineEnd:ie,insetInlineStart:ie,margin:ie,marginTop:ie,marginRight:ie,marginBottom:ie,marginLeft:ie,marginBlock:ie,marginBlockEnd:ie,marginBlockStart:ie,marginInline:ie,marginInlineEnd:ie,marginInlineStart:ie,padding:ie,paddingTop:ie,paddingRight:ie,paddingBottom:ie,paddingLeft:ie,paddingBlock:ie,paddingBlockEnd:ie,paddingBlockStart:ie,paddingInline:ie,paddingInlineEnd:ie,paddingInlineStart:ie,top:ie,right:ie,bottom:ie,left:ie,scrollMargin:ie,scrollMarginTop:ie,scrollMarginRight:ie,scrollMarginBottom:ie,scrollMarginLeft:ie,scrollMarginX:ie,scrollMarginY:ie,scrollMarginBlock:ie,scrollMarginBlockEnd:ie,scrollMarginBlockStart:ie,scrollMarginInline:ie,scrollMarginInlineEnd:ie,scrollMarginInlineStart:ie,scrollPadding:ie,scrollPaddingTop:ie,scrollPaddingRight:ie,scrollPaddingBottom:ie,scrollPaddingLeft:ie,scrollPaddingX:ie,scrollPaddingY:ie,scrollPaddingBlock:ie,scrollPaddingBlockEnd:ie,scrollPaddingBlockStart:ie,scrollPaddingInline:ie,scrollPaddingInlineEnd:ie,scrollPaddingInlineStart:ie,fontSize:"fontSizes",background:me,backgroundColor:me,backgroundImage:me,borderImage:me,border:me,borderBlock:me,borderBlockEnd:me,borderBlockStart:me,borderBottom:me,borderBottomColor:me,borderColor:me,borderInline:me,borderInlineEnd:me,borderInlineStart:me,borderLeft:me,borderLeftColor:me,borderRight:me,borderRightColor:me,borderTop:me,borderTopColor:me,caretColor:me,color:me,columnRuleColor:me,fill:me,outline:me,outlineColor:me,stroke:me,textDecorationColor:me,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:De,minBlockSize:De,maxBlockSize:De,inlineSize:De,minInlineSize:De,maxInlineSize:De,width:De,minWidth:De,maxWidth:De,height:De,minHeight:De,maxHeight:De,flexBasis:De,gridTemplateColumns:De,gridTemplateRows:De,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},Dd=(t,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,dn=()=>{const t=Object.create(null);return(e,n,...r)=>{const i=(o=>JSON.stringify(o,Dd))(e);return i in t?t[i]:t[i]=n(e,...r)}},Nt=Symbol.for("sxs.internal"),Ho=(t,e)=>Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)),zs=t=>{for(const e in t)return!0;return!1},{hasOwnProperty:zd}=Object.prototype,qi=t=>t.includes("-")?t:t.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),Nd=/\s+(?![^()]*\))/,qt=t=>e=>t(...typeof e=="string"?String(e).split(Nd):[e]),Ns={appearance:t=>({WebkitAppearance:t,appearance:t}),backfaceVisibility:t=>({WebkitBackfaceVisibility:t,backfaceVisibility:t}),backdropFilter:t=>({WebkitBackdropFilter:t,backdropFilter:t}),backgroundClip:t=>({WebkitBackgroundClip:t,backgroundClip:t}),boxDecorationBreak:t=>({WebkitBoxDecorationBreak:t,boxDecorationBreak:t}),clipPath:t=>({WebkitClipPath:t,clipPath:t}),content:t=>({content:t.includes('"')||t.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(t)?t:`"${t}"`}),hyphens:t=>({WebkitHyphens:t,hyphens:t}),maskImage:t=>({WebkitMaskImage:t,maskImage:t}),maskSize:t=>({WebkitMaskSize:t,maskSize:t}),tabSize:t=>({MozTabSize:t,tabSize:t}),textSizeAdjust:t=>({WebkitTextSizeAdjust:t,textSizeAdjust:t}),userSelect:t=>({WebkitUserSelect:t,userSelect:t}),marginBlock:qt((t,e)=>({marginBlockStart:t,marginBlockEnd:e||t})),marginInline:qt((t,e)=>({marginInlineStart:t,marginInlineEnd:e||t})),maxSize:qt((t,e)=>({maxBlockSize:t,maxInlineSize:e||t})),minSize:qt((t,e)=>({minBlockSize:t,minInlineSize:e||t})),paddingBlock:qt((t,e)=>({paddingBlockStart:t,paddingBlockEnd:e||t})),paddingInline:qt((t,e)=>({paddingInlineStart:t,paddingInlineEnd:e||t}))},Pi=/([\d.]+)([^]*)/,$d=(t,e)=>t.length?t.reduce((n,r)=>(n.push(...e.map(i=>i.includes("&")?i.replace(/&/g,/[ +>|~]/.test(r)&&/&.*&/.test(i)?`:is(${r})`:r):r+" "+i)),n),[]):e,Fd=(t,e)=>t in Bd&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(n,r,i,o)=>r+(i==="stretch"?`-moz-available${o};${qi(t)}:${r}-webkit-fill-available`:`-moz-fit-content${o};${qi(t)}:${r}fit-content`)+o):String(e),Bd={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},vt=t=>t?t+"-":"",pc=(t,e,n)=>t.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(r,i,o,s,a)=>s=="$"==!!o?r:(i||s=="--"?"calc(":"")+"var(--"+(s==="$"?vt(e)+(a.includes("$")?"":vt(n))+a.replace(/\$/g,"-"):a)+")"+(i||s=="--"?"*"+(i||"")+(o||"1")+")":"")),jd=/\s*,\s*(?![^()]*\))/,Ud=Object.prototype.toString,en=(t,e,n,r,i)=>{let o,s,a;const l=(c,u,f)=>{let d,h;const g=p=>{for(d in p){const b=d.charCodeAt(0)===64,_=b&&Array.isArray(p[d])?p[d]:[p[d]];for(h of _){const w=/[A-Z]/.test(y=d)?y:y.replace(/-[^]/g,O=>O[1].toUpperCase()),C=typeof h=="object"&&h&&h.toString===Ud&&(!r.utils[w]||!u.length);if(w in r.utils&&!C){const O=r.utils[w];if(O!==s){s=O,g(O(h)),s=null;continue}}else if(w in Ns){const O=Ns[w];if(O!==a){a=O,g(O(h)),a=null;continue}}if(b&&(m=d.slice(1)in r.media?"@media "+r.media[d.slice(1)]:d,d=m.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(O,T,I,k,M,j)=>{const S=Pi.test(T),L=.0625*(S?-1:1),[x,z]=S?[k,T]:[T,k];return"("+(I[0]==="="?"":I[0]===">"===S?"max-":"min-")+x+":"+(I[0]!=="="&&I.length===1?z.replace(Pi,(q,W,X)=>Number(W)+L*(I===">"?1:-1)+X):z)+(M?") and ("+(M[0]===">"?"min-":"max-")+x+":"+(M.length===1?j.replace(Pi,(q,W,X)=>Number(W)+L*(M===">"?-1:1)+X):j):"")+")"})),C){const O=b?f.concat(d):[...f],T=b?[...u]:$d(u,d.split(jd));o!==void 0&&i($s(...o)),o=void 0,l(h,T,O)}else o===void 0&&(o=[[],u,f]),d=b||d.charCodeAt(0)!==36?d:`--${vt(r.prefix)}${d.slice(1).replace(/\$/g,"-")}`,h=C?h:typeof h=="number"?h&&w in Wd?String(h)+"px":String(h):pc(Fd(w,h??""),r.prefix,r.themeMap[w]),o[0].push(`${b?`${d} `:`${qi(d)}:`}${h}`)}}var m,y};g(c),o!==void 0&&i($s(...o)),o=void 0};l(t,e,n)},$s=(t,e,n)=>`${n.map(r=>`${r}{`).join("")}${e.length?`${e.join(",")}{`:""}${t.join(";")}${e.length?"}":""}${Array(n.length?n.length+1:0).join("}")}`,Wd={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},Fs=t=>String.fromCharCode(t+(t>25?39:97)),$t=t=>(e=>{let n,r="";for(n=Math.abs(e);n>52;n=n/52|0)r=Fs(n%52)+r;return Fs(n%52)+r})(((e,n)=>{let r=n.length;for(;r;)e=33*e^n.charCodeAt(--r);return e})(5381,JSON.stringify(t))>>>0),Pn=["themed","global","styled","onevar","resonevar","allvar","inline"],Vd=t=>{if(t.href&&!t.href.startsWith(location.origin))return!1;try{return!!t.cssRules}catch{return!1}},Hd=t=>{let e;const n=()=>{const{cssRules:i}=e.sheet;return[].map.call(i,(o,s)=>{const{cssText:a}=o;let l="";if(a.startsWith("--sxs"))return"";if(i[s-1]&&(l=i[s-1].cssText).startsWith("--sxs")){if(!o.cssRules.length)return"";for(const c in e.rules)if(e.rules[c].group===o)return`--sxs{--sxs:${[...e.rules[c].cache].join(" ")}}${a}`;return o.cssRules.length?`${l}${a}`:""}return a}).join("")},r=()=>{if(e){const{rules:a,sheet:l}=e;if(!l.deleteRule){for(;Object(Object(l.cssRules)[0]).type===3;)l.cssRules.splice(0,1);l.cssRules=[]}for(const c in a)delete a[c]}const i=Object(t).styleSheets||[];for(const a of i)if(Vd(a)){for(let l=0,c=a.cssRules;c[l];++l){const u=Object(c[l]);if(u.type!==1)continue;const f=Object(c[l+1]);if(f.type!==4)continue;++l;const{cssText:d}=u;if(!d.startsWith("--sxs"))continue;const h=d.slice(14,-3).trim().split(/\s+/),g=Pn[h[0]];g&&(e||(e={sheet:a,reset:r,rules:{},toString:n}),e.rules[g]={group:f,index:l,cache:new Set(h)})}if(e)break}if(!e){const a=(l,c)=>({type:c,cssRules:[],insertRule(u,f){this.cssRules.splice(f,0,a(u,{import:3,undefined:1}[(u.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return l==="@media{}"?`@media{${[].map.call(this.cssRules,u=>u.cssText).join("")}}`:l}});e={sheet:t?(t.head||t).appendChild(document.createElement("style")).sheet:a("","text/css"),rules:{},reset:r,toString:n}}const{sheet:o,rules:s}=e;for(let a=Pn.length-1;a>=0;--a){const l=Pn[a];if(!s[l]){const c=Pn[a+1],u=s[c]?s[c].index:o.cssRules.length;o.insertRule("@media{}",u),o.insertRule(`--sxs{--sxs:${a}}`,u),s[l]={group:o.cssRules[u+1],index:u,cache:new Set([a])}}Gd(s[l])}};return r(),e},Gd=t=>{const e=t.group;let n=e.cssRules.length;t.apply=r=>{try{e.insertRule(r,n),++n}catch{}}},xn=Symbol(),Kd=dn(),Bs=(t,e)=>Kd(t,()=>(...n)=>{let r={type:null,composers:new Set};for(const i of n)if(i!=null)if(i[Nt]){r.type==null&&(r.type=i[Nt].type);for(const o of i[Nt].composers)r.composers.add(o)}else i.constructor!==Object||i.$$typeof?r.type==null&&(r.type=i):r.composers.add(Zd(i,t));return r.type==null&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),Yd(t,r,e)}),Zd=({variants:t,compoundVariants:e,defaultVariants:n,...r},i)=>{const o=`${vt(i.prefix)}c-${$t(r)}`,s=[],a=[],l=Object.create(null),c=[];for(const d in n)l[d]=String(n[d]);if(typeof t=="object"&&t)for(const d in t){u=l,f=d,zd.call(u,f)||(l[d]="undefined");const h=t[d];for(const g in h){const p={[d]:String(g)};String(g)==="undefined"&&c.push(d);const m=h[g],y=[p,m,!zs(m)];s.push(y)}}var u,f;if(typeof e=="object"&&e)for(const d of e){let{css:h,...g}=d;h=typeof h=="object"&&h||{};for(const m in g)g[m]=String(g[m]);const p=[g,h,!zs(h)];a.push(p)}return[o,r,s,a,l,c]},Yd=(t,e,n)=>{const[r,i,o,s]=qd(e.composers),a=typeof e.type=="function"||e.type.$$typeof?(f=>{function d(){for(let h=0;h<d[xn].length;h++){const[g,p]=d[xn][h];f.rules[g].apply(p)}return d[xn]=[],null}return d[xn]=[],d.rules={},Pn.forEach(h=>d.rules[h]={apply:g=>d[xn].push([h,g])}),d})(n):null,l=(a||n).rules,c=`.${r}${i.length>1?`:where(.${i.slice(1).join(".")})`:""}`,u=f=>{f=typeof f=="object"&&f||Xd;const{css:d,...h}=f,g={};for(const y in o)if(delete h[y],y in f){let b=f[y];typeof b=="object"&&b?g[y]={"@initial":o[y],...b}:(b=String(b),g[y]=b!=="undefined"||s.has(y)?b:o[y])}else g[y]=o[y];const p=new Set([...i]);for(const[y,b,_,w]of e.composers){n.rules.styled.cache.has(y)||(n.rules.styled.cache.add(y),en(b,[`.${y}`],[],t,T=>{l.styled.apply(T)}));const C=js(_,g,t.media),O=js(w,g,t.media,!0);for(const T of C)if(T!==void 0)for(const[I,k,M]of T){const j=`${y}-${$t(k)}-${I}`;p.add(j);const S=(M?n.rules.resonevar:n.rules.onevar).cache,L=M?l.resonevar:l.onevar;S.has(j)||(S.add(j),en(k,[`.${j}`],[],t,x=>{L.apply(x)}))}for(const T of O)if(T!==void 0)for(const[I,k]of T){const M=`${y}-${$t(k)}-${I}`;p.add(M),n.rules.allvar.cache.has(M)||(n.rules.allvar.cache.add(M),en(k,[`.${M}`],[],t,j=>{l.allvar.apply(j)}))}}if(typeof d=="object"&&d){const y=`${r}-i${$t(d)}-css`;p.add(y),n.rules.inline.cache.has(y)||(n.rules.inline.cache.add(y),en(d,[`.${y}`],[],t,b=>{l.inline.apply(b)}))}for(const y of String(f.className||"").trim().split(/\s+/))y&&p.add(y);const m=h.className=[...p].join(" ");return{type:e.type,className:m,selector:c,props:h,toString:()=>m,deferredInjector:a}};return Ho(u,{className:r,selector:c,[Nt]:e,toString:()=>(n.rules.styled.cache.has(r)||u(),r)})},qd=t=>{let e="";const n=[],r={},i=[];for(const[o,,,,s,a]of t){e===""&&(e=o),n.push(o),i.push(...a);for(const l in s){const c=s[l];(r[l]===void 0||c!=="undefined"||a.includes(c))&&(r[l]=c)}}return[e,n,r,new Set(i)]},js=(t,e,n,r)=>{const i=[];e:for(let[o,s,a]of t){if(a)continue;let l,c=0,u=!1;for(l in o){const f=o[l];let d=e[l];if(d!==f){if(typeof d!="object"||!d)continue e;{let h,g,p=0;for(const m in d){if(f===String(d[m])){if(m!=="@initial"){const y=m.slice(1);(g=g||[]).push(y in n?n[y]:m.replace(/^@media ?/,"")),u=!0}c+=p,h=!0}++p}if(g&&g.length&&(s={["@media "+g.join(", ")]:s}),!h)continue e}}}(i[c]=i[c]||[]).push([r?"cv":`${l}-${o[l]}`,s,u])}return i},Xd={},Jd=dn(),Qd=(t,e)=>Jd(t,()=>(...n)=>{const r=()=>{for(let i of n){i=typeof i=="object"&&i||{};let o=$t(i);if(!e.rules.global.cache.has(o)){if(e.rules.global.cache.add(o),"@import"in i){let s=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let a of[].concat(i["@import"]))a=a.includes('"')||a.includes("'")?a:`"${a}"`,e.sheet.insertRule(`@import ${a};`,s++);delete i["@import"]}en(i,[],[],t,s=>{e.rules.global.apply(s)})}}return""};return Ho(r,{toString:r})}),eh=dn(),th=(t,e)=>eh(t,()=>n=>{const r=`${vt(t.prefix)}k-${$t(n)}`,i=()=>{if(!e.rules.global.cache.has(r)){e.rules.global.cache.add(r);const o=[];en(n,[],[],t,a=>o.push(a));const s=`@keyframes ${r}{${o.join("")}}`;e.rules.global.apply(s)}return r};return Ho(i,{get name(){return i()},toString:i})}),nh=class{constructor(t,e,n,r){this.token=t==null?"":String(t),this.value=e==null?"":String(e),this.scale=n==null?"":String(n),this.prefix=r==null?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+vt(this.prefix)+vt(this.scale)+this.token}toString(){return this.computedValue}},rh=dn(),ih=(t,e)=>rh(t,()=>(n,r)=>{r=typeof n=="object"&&n||Object(r);const i=`.${n=(n=typeof n=="string"?n:"")||`${vt(t.prefix)}t-${$t(r)}`}`,o={},s=[];for(const l in r){o[l]={};for(const c in r[l]){const u=`--${vt(t.prefix)}${l}-${c}`,f=pc(String(r[l][c]),t.prefix,l);o[l][c]=new nh(c,f,l,t.prefix),s.push(`${u}:${f}`)}}const a=()=>{if(s.length&&!e.rules.themed.cache.has(n)){e.rules.themed.cache.add(n);const l=`${r===t.theme?":root,":""}.${n}{${s.join(";")}}`;e.rules.themed.apply(l)}return n};return{...o,get className(){return a()},selector:i,toString:a}}),oh=dn(),sh=dn(),ah=t=>{const e=(n=>{let r=!1;const i=oh(n,o=>{r=!0;const s="prefix"in(o=typeof o=="object"&&o||{})?String(o.prefix):"",a=typeof o.media=="object"&&o.media||{},l=typeof o.root=="object"?o.root||null:globalThis.document||null,c=typeof o.theme=="object"&&o.theme||{},u={prefix:s,media:a,theme:c,themeMap:typeof o.themeMap=="object"&&o.themeMap||{...Md},utils:typeof o.utils=="object"&&o.utils||{}},f=Hd(l),d={css:Bs(u,f),globalCss:Qd(u,f),keyframes:th(u,f),createTheme:ih(u,f),reset(){f.reset(),d.theme.toString()},theme:{},sheet:f,config:u,prefix:s,getCssText:f.toString,toString:f.toString};return String(d.theme=d.createTheme(c)),d});return r||i.reset(),i})(t);return e.styled=(({config:n,sheet:r})=>sh(n,()=>{const i=Bs(n,r);return(...o)=>{const s=i(...o),a=s[Nt].type,l=R.forwardRef((c,u)=>{const f=c&&c.as||a,{props:d,deferredInjector:h}=s(c);return delete d.as,d.ref=u,h?R.createElement(R.Fragment,null,R.createElement(f,d),R.createElement(h,null)):R.createElement(f,d)});return l.className=s.className,l.displayName=`Styled.${a.displayName||a.name||a}`,l.selector=s.selector,l.toString=()=>s.selector,l[Nt]=s[Nt],l}}))(e),e};function lh(t,e,n){return Math.max(e,Math.min(t,n))}const Le={toVector(t,e){return t===void 0&&(t=e),Array.isArray(t)?t:[t,t]},add(t,e){return[t[0]+e[0],t[1]+e[1]]},sub(t,e){return[t[0]-e[0],t[1]-e[1]]},addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function Us(t,e,n){return e===0||Math.abs(e)===1/0?Math.pow(t,n*5):t*e*n/(e+n*t)}function Ws(t,e,n,r=.15){return r===0?lh(t,e,n):t<e?-Us(e-t,n-e,r)+e:t>n?+Us(t-n,n-e,r)+n:t}function ch(t,[e,n],[r,i]){const[[o,s],[a,l]]=t;return[Ws(e,o,s,r),Ws(n,a,l,i)]}function uh(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fh(t){var e=uh(t,"string");return typeof e=="symbol"?e:String(e)}function Ue(t,e,n){return e=fh(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ae(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Vs(Object(n),!0).forEach(function(r){Ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vs(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const gc={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Hs(t){return t?t[0].toUpperCase()+t.slice(1):""}const dh=["enter","leave"];function hh(t=!1,e){return t&&!dh.includes(e)}function ph(t,e="",n=!1){const r=gc[t],i=r&&r[e]||e;return"on"+Hs(t)+Hs(i)+(hh(n,i)?"Capture":"")}const gh=["gotpointercapture","lostpointercapture"];function mh(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const r=gh.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(r);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:n}}function yh(t,e=""){const n=gc[t],r=n&&n[e]||e;return t+r}function hi(t){return"touches"in t}function mc(t){return hi(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function vh(t){return Array.from(t.touches).filter(e=>{var n,r;return e.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,e.target))})}function bh(t){return t.type==="touchend"||t.type==="touchcancel"?t.changedTouches:t.targetTouches}function yc(t){return hi(t)?bh(t)[0]:t}function xh(t){return vh(t).map(e=>e.identifier)}function Ai(t){const e=yc(t);return hi(t)?e.identifier:e.pointerId}function Gs(t){const e=yc(t);return[e.clientX,e.clientY]}function _h(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:r,metaKey:i,ctrlKey:o}=t;Object.assign(e,{shiftKey:n,altKey:r,metaKey:i,ctrlKey:o})}return e}function Pr(t,...e){return typeof t=="function"?t(...e):t}function wh(){}function Sh(...t){return t.length===0?wh:t.length===1?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function Ks(t,e){return Object.assign({},e,t||{})}const Ch=32;class Eh{constructor(e,n,r){this.ctrl=e,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:r,args:i}=this;n[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=r.from?Pr(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:r,shared:i}=this;n.args=this.args;let o=0;if(e&&(n.event=e,r.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,_h(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,o=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const O=n._delta.map(Math.abs);Le.addTo(n._distance,O)}this.axisIntent&&this.axisIntent(e);const[s,a]=n._movement,[l,c]=r.threshold,{_step:u,values:f}=n;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(s)>=l&&f[0]),u[1]===!1&&(u[1]=Math.abs(a)>=c&&f[1])):(u[0]===!1&&(u[0]=Math.abs(s)>=l&&Math.sign(s)*l),u[1]===!1&&(u[1]=Math.abs(a)>=c&&Math.sign(a)*c)),n.intentional=u[0]!==!1||u[1]!==!1,!n.intentional)return;const d=[0,0];if(r.hasCustomTransform){const[O,T]=f;d[0]=u[0]!==!1?O-u[0]:0,d[1]=u[1]!==!1?T-u[1]:0}else d[0]=u[0]!==!1?s-u[0]:0,d[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(d);const h=n.offset,g=n._active&&!n._blocked||n.active;g&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=i[this.ingKey]=n._active,e&&(n.first&&("bounds"in r&&(n._bounds=Pr(r.bounds,n)),this.setup&&this.setup()),n.movement=d,this.computeOffset()));const[p,m]=n.offset,[[y,b],[_,w]]=n._bounds;n.overflow=[p<y?-1:p>b?1:0,m<_?-1:m>w?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const C=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=ch(n._bounds,n.offset,C),n.delta=Le.sub(n.offset,h),this.computeMovement(),g&&(!n.last||o>Ch)){n.delta=Le.sub(n.offset,h);const O=n.delta.map(Math.abs);Le.addTo(n.distance,O),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&o>0&&(n.velocity=[O[0]/o,O[1]/o],n.timeDelta=o)}}emit(){const e=this.state,n=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const i=this.handler(Ae(Ae(Ae({},n),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function Ph([t,e],n){const r=Math.abs(t),i=Math.abs(e);if(r>i&&r>n)return"x";if(i>r&&i>n)return"y"}class Ah extends Eh{constructor(...e){super(...e),Ue(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Le.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Le.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,r=this.config;if(!n.axis&&e){const i=typeof r.axisThreshold=="object"?r.axisThreshold[mc(e)]:r.axisThreshold;n.axis=Ph(n._movement,i)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const Th=t=>t,Zs=.15,vc={enabled(t=!0){return t},eventOptions(t,e,n){return Ae(Ae({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[Zs,Zs];case!1:return[0,0];default:return Le.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return Le.toVector(t)},transform(t,e,n){const r=t||n.shared.transform;return this.hasCustomTransform=!!r,r||Th},threshold(t){return Le.toVector(t,0)}},Oh=0,Wn=Ae(Ae({},vc),{},{axis(t,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=Oh){return t},bounds(t={}){if(typeof t=="function")return o=>Wn.bounds(t(o));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:r=-1/0,bottom:i=1/0}=t;return[[e,n],[r,i]]}}),Ys={ArrowRight:(t,e=1)=>[t*e,0],ArrowLeft:(t,e=1)=>[-1*t*e,0],ArrowUp:(t,e=1)=>[0,-1*t*e],ArrowDown:(t,e=1)=>[0,t*e]};class kh extends Ah{constructor(...e){super(...e),Ue(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const n=e._bounds.getBoundingClientRect(),r=e.currentTarget.getBoundingClientRect(),i={left:n.left-r.left+e.offset[0],right:n.right-r.right+e.offset[0],top:n.top-r.top+e.offset[1],bottom:n.bottom-r.bottom+e.offset[1]};e._bounds=Wn.bounds(i)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const n=this.config,r=this.state;if(e.buttons!=null&&(Array.isArray(n.pointerButtons)?!n.pointerButtons.includes(e.buttons):n.pointerButtons!==-1&&n.pointerButtons!==e.buttons))return;const i=this.ctrl.setEventIds(e);n.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(i&&i.size>1&&r._pointerActive)&&(this.start(e),this.setupPointer(e),r._pointerId=Ai(e),r._pointerActive=!0,this.computeValues(Gs(e)),this.computeInitial(),n.preventScrollAxis&&mc(e)!=="mouse"?(r._active=!1,this.setupScrollPrevention(e)):n.delay>0?(this.setupDelayTrigger(e),n.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const n=this.state;n._active=!0,n._preventScroll=!0,n._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const n=this.state,r=this.config;if(!n._pointerActive)return;const i=Ai(e);if(n._pointerId!==void 0&&i!==n._pointerId)return;const o=Gs(e);if(document.pointerLockElement===e.target?n._delta=[e.movementX,e.movementY]:(n._delta=Le.sub(o,n._values),this.computeValues(o)),Le.addTo(n._movement,n._delta),this.compute(e),n._delayed&&n.intentional){this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(e);return}if(r.preventScrollAxis&&!n._preventScroll)if(n.axis)if(n.axis===r.preventScrollAxis||r.preventScrollAxis==="xy"){n._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const n=this.state,r=this.config;if(!n._active||!n._pointerActive)return;const i=Ai(e);if(n._pointerId!==void 0&&i!==n._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[o,s]=n._distance;if(n.tap=o<=r.tapsThreshold&&s<=r.tapsThreshold,n.tap&&r.filterTaps)n._force=!0;else{const[a,l]=n._delta,[c,u]=n._movement,[f,d]=r.swipe.velocity,[h,g]=r.swipe.distance,p=r.swipe.duration;if(n.elapsedTime<p){const m=Math.abs(a/n.timeDelta),y=Math.abs(l/n.timeDelta);m>f&&Math.abs(c)>h&&(n.swipe[0]=Math.sign(a)),y>d&&Math.abs(u)>g&&(n.swipe[1]=Math.sign(l))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const n=this.config,r=n.device;n.pointerLock&&e.currentTarget.requestPointerLock(),n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,r,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,Rh(e);const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n),this.eventStore.add(this.sharedConfig.window,"touch","cancel",n),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const n=Ys[e.key];if(n){const r=this.state,i=e.shiftKey?10:e.altKey?.1:1;this.start(e),r._delta=n(this.config.keyboardDisplacement,i),r._keyboardActive=!0,Le.addTo(r._movement,r._delta),this.compute(e),this.emit()}}keyUp(e){e.key in Ys&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const n=this.config.device;e(n,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(n,"change",this.pointerMove.bind(this)),e(n,"end",this.pointerUp.bind(this)),e(n,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function Rh(t){"persist"in t&&typeof t.persist=="function"&&t.persist()}const Vn=typeof window<"u"&&window.document&&window.document.createElement;function bc(){return Vn&&"ontouchstart"in window}function Ih(){return bc()||Vn&&window.navigator.maxTouchPoints>1}function Lh(){return Vn&&"onpointerdown"in window}function Mh(){return Vn&&"exitPointerLock"in window.document}function Dh(){try{return"constructor"in GestureEvent}catch{return!1}}const Ze={isBrowser:Vn,gesture:Dh(),touch:bc(),touchscreen:Ih(),pointer:Lh(),pointerLock:Mh()},zh=250,Nh=180,$h=.5,Fh=50,Bh=250,jh=10,qs={mouse:0,touch:0,pen:8},Uh=Ae(Ae({},Wn),{},{device(t,e,{pointer:{touch:n=!1,lock:r=!1,mouse:i=!1}={}}){return this.pointerLock=r&&Ze.pointerLock,Ze.touch&&n?"touch":this.pointerLock?"mouse":Ze.pointer&&!i?"pointer":Ze.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?zh:void 0,!(!Ze.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:r=1,keys:i=!0}={}}){return this.pointerButtons=r,this.keys=i,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:r=3,axis:i=void 0}){const o=Le.toVector(t,n?r:i?1:0);return this.filterTaps=n,this.tapsThreshold=r,o},swipe({velocity:t=$h,distance:e=Fh,duration:n=Bh}={}){return{velocity:this.transform(Le.toVector(t)),distance:this.transform(Le.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return Nh;case!1:return 0;default:return t}},axisThreshold(t){return t?Ae(Ae({},qs),t):qs},keyboardDisplacement(t=jh){return t}});Ae(Ae({},vc),{},{device(t,e,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!Ze.touch&&Ze.gesture)return"gesture";if(Ze.touch&&r)return"touch";if(Ze.touchscreen){if(Ze.pointer)return"pointer";if(Ze.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:r={}}){const i=s=>{const a=Ks(Pr(n,s),{min:-1/0,max:1/0});return[a.min,a.max]},o=s=>{const a=Ks(Pr(r,s),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof n!="function"&&typeof r!="function"?[i(),o()]:s=>[i(s),o(s)]},threshold(t,e,n){return this.lockDirection=n.axis==="lock",Le.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});Ae(Ae({},Wn),{},{mouseOnly:(t=!0)=>t});Ae(Ae({},Wn),{},{mouseOnly:(t=!0)=>t});const xc=new Map,Xi=new Map;function Wh(t){xc.set(t.key,t.engine),Xi.set(t.key,t.resolver)}const Vh={key:"drag",engine:kh,resolver:Uh};function Hh(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Gh(t,e){if(t==null)return{};var n=Hh(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}const Kh={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=Ze.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},Zh=["target","eventOptions","window","enabled","transform"];function vr(t={},e){const n={};for(const[r,i]of Object.entries(e))switch(typeof i){case"function":n[r]=i.call(n,t[r],r,t);break;case"object":n[r]=vr(t[r],i);break;case"boolean":i&&(n[r]=t[r]);break}return n}function Yh(t,e,n={}){const r=t,{target:i,eventOptions:o,window:s,enabled:a,transform:l}=r,c=Gh(r,Zh);if(n.shared=vr({target:i,eventOptions:o,window:s,enabled:a,transform:l},Kh),e){const u=Xi.get(e);n[e]=vr(Ae({shared:n.shared},c),u)}else for(const u in c){const f=Xi.get(u);f&&(n[u]=vr(Ae({shared:n.shared},c[u]),f))}return n}class _c{constructor(e,n){Ue(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,r,i,o){const s=this._listeners,a=yh(n,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=Ae(Ae({},l),o);e.addEventListener(a,i,c);const u=()=>{e.removeEventListener(a,i,c),s.delete(u)};return s.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class qh{constructor(){Ue(this,"_timeouts",new Map)}add(e,n,r=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(n,r,...i))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class Xh{constructor(e){Ue(this,"gestures",new Set),Ue(this,"_targetEventStore",new _c(this)),Ue(this,"gestureEventStores",{}),Ue(this,"gestureTimeoutStores",{}),Ue(this,"handlers",{}),Ue(this,"config",{}),Ue(this,"pointerIds",new Set),Ue(this,"touchIds",new Set),Ue(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Jh(this,e)}setEventIds(e){if(hi(e))return this.touchIds=new Set(xh(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=Yh(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,r={};let i;if(!(n.target&&(i=n.target(),!i))){if(n.enabled){for(const s of this.gestures){const a=this.config[s],l=Xs(r,a.eventOptions,!!i);if(a.enabled){const c=xc.get(s);new c(this,e,s).bind(l)}}const o=Xs(r,n.eventOptions,!!i);for(const s in this.nativeHandlers)o(s,"",a=>this.nativeHandlers[s](Ae(Ae({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const o in r)r[o]=Sh(...r[o]);if(!i)return r;for(const o in r){const{device:s,capture:a,passive:l}=mh(o);this._targetEventStore.add(i,s,"",r[o],{capture:a,passive:l})}}}}function Xt(t,e){t.gestures.add(e),t.gestureEventStores[e]=new _c(t,e),t.gestureTimeoutStores[e]=new qh}function Jh(t,e){e.drag&&Xt(t,"drag"),e.wheel&&Xt(t,"wheel"),e.scroll&&Xt(t,"scroll"),e.move&&Xt(t,"move"),e.pinch&&Xt(t,"pinch"),e.hover&&Xt(t,"hover")}const Xs=(t,e,n)=>(r,i,o,s={},a=!1)=>{var l,c;const u=(l=s.capture)!==null&&l!==void 0?l:e.capture,f=(c=s.passive)!==null&&c!==void 0?c:e.passive;let d=a?r:ph(r,i,u);n&&f&&(d+="Passive"),t[d]=t[d]||[],t[d].push(o)};function Qh(t,e={},n,r){const i=R.useMemo(()=>new Xh(t),[]);if(i.applyHandlers(t,r),i.applyConfig(e,n),R.useEffect(i.effect.bind(i)),R.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function ep(t,e){return Wh(Vh),Qh({drag:t},e||{},"drag")}function ht(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function wc(t,e=[]){let n=[];function r(o,s){const a=E.createContext(s),l=n.length;n=[...n,s];function c(f){const{scope:d,children:h,...g}=f,p=(d==null?void 0:d[t][l])||a,m=E.useMemo(()=>g,Object.values(g));return de.jsx(p.Provider,{value:m,children:h})}function u(f,d){const h=(d==null?void 0:d[t][l])||a,g=E.useContext(h);if(g)return g;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${o}\``)}return c.displayName=o+"Provider",[c,u]}const i=()=>{const o=n.map(s=>E.createContext(s));return function(a){const l=(a==null?void 0:a[t])||o;return E.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,tp(i,...e)]}function tp(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=r.reduce((a,{useScope:l,scopeName:c})=>{const f=l(o)[`__scope${c}`];return{...a,...f}},{});return E.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return n.scopeName=e.scopeName,n}function hn(t){const e=E.useRef(t);return E.useEffect(()=>{e.current=t}),E.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function np(t,e=globalThis==null?void 0:globalThis.document){const n=hn(t);E.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var rp="DismissableLayer",Ji="dismissableLayer.update",ip="dismissableLayer.pointerDownOutside",op="dismissableLayer.focusOutside",Js,Sc=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Cc=E.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:s,onDismiss:a,...l}=t,c=E.useContext(Sc),[u,f]=E.useState(null),d=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=E.useState({}),g=Kt(e,T=>f(T)),p=Array.from(c.layers),[m]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=p.indexOf(m),b=u?p.indexOf(u):-1,_=c.layersWithOutsidePointerEventsDisabled.size>0,w=b>=y,C=lp(T=>{const I=T.target,k=[...c.branches].some(M=>M.contains(I));!w||k||(i==null||i(T),s==null||s(T),T.defaultPrevented||a==null||a())},d),O=cp(T=>{const I=T.target;[...c.branches].some(M=>M.contains(I))||(o==null||o(T),s==null||s(T),T.defaultPrevented||a==null||a())},d);return np(T=>{b===c.layers.size-1&&(r==null||r(T),!T.defaultPrevented&&a&&(T.preventDefault(),a()))},d),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Js=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),Qs(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=Js)}},[u,d,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),Qs())},[u,c]),E.useEffect(()=>{const T=()=>h({});return document.addEventListener(Ji,T),()=>document.removeEventListener(Ji,T)},[]),de.jsx(Mt.div,{...l,ref:g,style:{pointerEvents:_?w?"auto":"none":void 0,...t.style},onFocusCapture:ht(t.onFocusCapture,O.onFocusCapture),onBlurCapture:ht(t.onBlurCapture,O.onBlurCapture),onPointerDownCapture:ht(t.onPointerDownCapture,C.onPointerDownCapture)})});Cc.displayName=rp;var sp="DismissableLayerBranch",ap=E.forwardRef((t,e)=>{const n=E.useContext(Sc),r=E.useRef(null),i=Kt(e,r);return E.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),de.jsx(Mt.div,{...t,ref:i})});ap.displayName=sp;function lp(t,e=globalThis==null?void 0:globalThis.document){const n=hn(t),r=E.useRef(!1),i=E.useRef(()=>{});return E.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let l=function(){Ec(ip,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},s=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function cp(t,e=globalThis==null?void 0:globalThis.document){const n=hn(t),r=E.useRef(!1);return E.useEffect(()=>{const i=o=>{o.target&&!r.current&&Ec(op,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Qs(){const t=new CustomEvent(Ji);document.dispatchEvent(t)}function Ec(t,e,n,{discrete:r}){const i=n.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?Ad(i,o):i.dispatchEvent(o)}var up=Xf.useId||(()=>{}),fp=0;function dp(t){const[e,n]=E.useState(up());return Ut(()=>{n(r=>r??String(fp++))},[t]),e?`radix-${e}`:""}const hp=["top","right","bottom","left"],st=Math.min,He=Math.max,Ar=Math.round,er=Math.floor,Tt=t=>({x:t,y:t}),pp={left:"right",right:"left",bottom:"top",top:"bottom"},gp={start:"end",end:"start"};function Qi(t,e,n){return He(t,st(e,n))}function bt(t,e){return typeof t=="function"?t(e):t}function xt(t){return t.split("-")[0]}function pn(t){return t.split("-")[1]}function Go(t){return t==="x"?"y":"x"}function Ko(t){return t==="y"?"height":"width"}function Ot(t){return["top","bottom"].includes(xt(t))?"y":"x"}function Zo(t){return Go(Ot(t))}function mp(t,e,n){n===void 0&&(n=!1);const r=pn(t),i=Zo(t),o=Ko(i);let s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=Tr(s)),[s,Tr(s)]}function yp(t){const e=Tr(t);return[eo(t),e,eo(e)]}function eo(t){return t.replace(/start|end/g,e=>gp[e])}function vp(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function bp(t,e,n,r){const i=pn(t);let o=vp(xt(t),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(eo)))),o}function Tr(t){return t.replace(/left|right|bottom|top/g,e=>pp[e])}function xp(t){return{top:0,right:0,bottom:0,left:0,...t}}function Pc(t){return typeof t!="number"?xp(t):{top:t,right:t,bottom:t,left:t}}function Or(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function ea(t,e,n){let{reference:r,floating:i}=t;const o=Ot(e),s=Zo(e),a=Ko(s),l=xt(e),c=o==="y",u=r.x+r.width/2-i.width/2,f=r.y+r.height/2-i.height/2,d=r[a]/2-i[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:f};break;case"left":h={x:r.x-i.width,y:f};break;default:h={x:r.x,y:r.y}}switch(pn(e)){case"start":h[s]-=d*(n&&c?-1:1);break;case"end":h[s]+=d*(n&&c?-1:1);break}return h}const _p=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:f}=ea(c,r,l),d=r,h={},g=0;for(let p=0;p<a.length;p++){const{name:m,fn:y}=a[p],{x:b,y:_,data:w,reset:C}=await y({x:u,y:f,initialPlacement:r,placement:d,strategy:i,middlewareData:h,rects:c,platform:s,elements:{reference:t,floating:e}});u=b??u,f=_??f,h={...h,[m]:{...h[m],...w}},C&&g<=50&&(g++,typeof C=="object"&&(C.placement&&(d=C.placement),C.rects&&(c=C.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):C.rects),{x:u,y:f}=ea(c,d,l)),p=-1)}return{x:u,y:f,placement:d,strategy:i,middlewareData:h}};async function Mn(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:d=!1,padding:h=0}=bt(e,t),g=Pc(h),m=a[d?f==="floating"?"reference":"floating":f],y=Or(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(m)))==null||n?m:m.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=f==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),w=await(o.isElement==null?void 0:o.isElement(_))?await(o.getScale==null?void 0:o.getScale(_))||{x:1,y:1}:{x:1,y:1},C=Or(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:_,strategy:l}):b);return{top:(y.top-C.top+g.top)/w.y,bottom:(C.bottom-y.bottom+g.bottom)/w.y,left:(y.left-C.left+g.left)/w.x,right:(C.right-y.right+g.right)/w.x}}const wp=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=bt(t,e)||{};if(c==null)return{};const f=Pc(u),d={x:n,y:r},h=Zo(i),g=Ko(h),p=await s.getDimensions(c),m=h==="y",y=m?"top":"left",b=m?"bottom":"right",_=m?"clientHeight":"clientWidth",w=o.reference[g]+o.reference[h]-d[h]-o.floating[g],C=d[h]-o.reference[h],O=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let T=O?O[_]:0;(!T||!await(s.isElement==null?void 0:s.isElement(O)))&&(T=a.floating[_]||o.floating[g]);const I=w/2-C/2,k=T/2-p[g]/2-1,M=st(f[y],k),j=st(f[b],k),S=M,L=T-p[g]-j,x=T/2-p[g]/2+I,z=Qi(S,x,L),q=!l.arrow&&pn(i)!=null&&x!==z&&o.reference[g]/2-(x<S?M:j)-p[g]/2<0,W=q?x<S?x-S:x-L:0;return{[h]:d[h]+W,data:{[h]:z,centerOffset:x-z-W,...q&&{alignmentOffset:W}},reset:q}}}),Sp=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:p=!0,...m}=bt(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const y=xt(i),b=Ot(a),_=xt(a)===a,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=d||(_||!p?[Tr(a)]:yp(a)),O=g!=="none";!d&&O&&C.push(...bp(a,p,g,w));const T=[a,...C],I=await Mn(e,m),k=[];let M=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&k.push(I[y]),f){const x=mp(i,s,w);k.push(I[x[0]],I[x[1]])}if(M=[...M,{placement:i,overflows:k}],!k.every(x=>x<=0)){var j,S;const x=(((j=o.flip)==null?void 0:j.index)||0)+1,z=T[x];if(z)return{data:{index:x,overflows:M},reset:{placement:z}};let q=(S=M.filter(W=>W.overflows[0]<=0).sort((W,X)=>W.overflows[1]-X.overflows[1])[0])==null?void 0:S.placement;if(!q)switch(h){case"bestFit":{var L;const W=(L=M.filter(X=>{if(O){const V=Ot(X.placement);return V===b||V==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(V=>V>0).reduce((V,te)=>V+te,0)]).sort((X,V)=>X[1]-V[1])[0])==null?void 0:L[0];W&&(q=W);break}case"initialPlacement":q=a;break}if(i!==q)return{reset:{placement:q}}}return{}}}};function ta(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function na(t){return hp.some(e=>t[e]>=0)}const Cp=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=bt(t,e);switch(r){case"referenceHidden":{const o=await Mn(e,{...i,elementContext:"reference"}),s=ta(o,n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:na(s)}}}case"escaped":{const o=await Mn(e,{...i,altBoundary:!0}),s=ta(o,n.floating);return{data:{escapedOffsets:s,escaped:na(s)}}}default:return{}}}}};async function Ep(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=xt(n),a=pn(n),l=Ot(n)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,f=bt(e,t);let{mainAxis:d,crossAxis:h,alignmentAxis:g}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return a&&typeof g=="number"&&(h=a==="end"?g*-1:g),l?{x:h*u,y:d*c}:{x:d*c,y:h*u}}const Pp=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:o,placement:s,middlewareData:a}=e,l=await Ep(e,t);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},Ap=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:m=>{let{x:y,y:b}=m;return{x:y,y:b}}},...l}=bt(t,e),c={x:n,y:r},u=await Mn(e,l),f=Ot(xt(i)),d=Go(f);let h=c[d],g=c[f];if(o){const m=d==="y"?"top":"left",y=d==="y"?"bottom":"right",b=h+u[m],_=h-u[y];h=Qi(b,h,_)}if(s){const m=f==="y"?"top":"left",y=f==="y"?"bottom":"right",b=g+u[m],_=g-u[y];g=Qi(b,g,_)}const p=a.fn({...e,[d]:h,[f]:g});return{...p,data:{x:p.x-n,y:p.y-r}}}}},Tp=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:o,middlewareData:s}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=bt(t,e),u={x:n,y:r},f=Ot(i),d=Go(f);let h=u[d],g=u[f];const p=bt(a,e),m=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const _=d==="y"?"height":"width",w=o.reference[d]-o.floating[_]+m.mainAxis,C=o.reference[d]+o.reference[_]-m.mainAxis;h<w?h=w:h>C&&(h=C)}if(c){var y,b;const _=d==="y"?"width":"height",w=["top","left"].includes(xt(i)),C=o.reference[f]-o.floating[_]+(w&&((y=s.offset)==null?void 0:y[f])||0)+(w?0:m.crossAxis),O=o.reference[f]+o.reference[_]+(w?0:((b=s.offset)==null?void 0:b[f])||0)-(w?m.crossAxis:0);g<C?g=C:g>O&&(g=O)}return{[d]:h,[f]:g}}}},Op=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:r,platform:i,elements:o}=e,{apply:s=()=>{},...a}=bt(t,e),l=await Mn(e,a),c=xt(n),u=pn(n),f=Ot(n)==="y",{width:d,height:h}=r.floating;let g,p;c==="top"||c==="bottom"?(g=c,p=u===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(p=c,g=u==="end"?"top":"bottom");const m=h-l.top-l.bottom,y=d-l.left-l.right,b=st(h-l[g],m),_=st(d-l[p],y),w=!e.middlewareData.shift;let C=b,O=_;if(f?O=u||w?st(_,y):y:C=u||w?st(b,m):m,w&&!u){const I=He(l.left,0),k=He(l.right,0),M=He(l.top,0),j=He(l.bottom,0);f?O=d-2*(I!==0||k!==0?I+k:He(l.left,l.right)):C=h-2*(M!==0||j!==0?M+j:He(l.top,l.bottom))}await s({...e,availableWidth:O,availableHeight:C});const T=await i.getDimensions(o.floating);return d!==T.width||h!==T.height?{reset:{rects:!0}}:{}}}};function gn(t){return Ac(t)?(t.nodeName||"").toLowerCase():"#document"}function Ke(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function wt(t){var e;return(e=(Ac(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Ac(t){return t instanceof Node||t instanceof Ke(t).Node}function et(t){return t instanceof Element||t instanceof Ke(t).Element}function lt(t){return t instanceof HTMLElement||t instanceof Ke(t).HTMLElement}function ra(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ke(t).ShadowRoot}function Hn(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=tt(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function kp(t){return["table","td","th"].includes(gn(t))}function pi(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Yo(t){const e=qo(),n=et(t)?tt(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Rp(t){let e=kt(t);for(;lt(e)&&!ln(e);){if(Yo(e))return e;if(pi(e))return null;e=kt(e)}return null}function qo(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ln(t){return["html","body","#document"].includes(gn(t))}function tt(t){return Ke(t).getComputedStyle(t)}function gi(t){return et(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function kt(t){if(gn(t)==="html")return t;const e=t.assignedSlot||t.parentNode||ra(t)&&t.host||wt(t);return ra(e)?e.host:e}function Tc(t){const e=kt(t);return ln(e)?t.ownerDocument?t.ownerDocument.body:t.body:lt(e)&&Hn(e)?e:Tc(e)}function Dn(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=Tc(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),s=Ke(i);if(o){const a=to(s);return e.concat(s,s.visualViewport||[],Hn(i)?i:[],a&&n?Dn(a):[])}return e.concat(i,Dn(i,[],n))}function to(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Oc(t){const e=tt(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=lt(t),o=i?t.offsetWidth:n,s=i?t.offsetHeight:r,a=Ar(n)!==o||Ar(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function Xo(t){return et(t)?t:t.contextElement}function sn(t){const e=Xo(t);if(!lt(e))return Tt(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=Oc(e);let s=(o?Ar(n.width):n.width)/r,a=(o?Ar(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const Ip=Tt(0);function kc(t){const e=Ke(t);return!qo()||!e.visualViewport?Ip:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Lp(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ke(t)?!1:e}function Wt(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=Xo(t);let s=Tt(1);e&&(r?et(r)&&(s=sn(r)):s=sn(t));const a=Lp(o,n,r)?kc(o):Tt(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,f=i.height/s.y;if(o){const d=Ke(o),h=r&&et(r)?Ke(r):r;let g=d,p=to(g);for(;p&&r&&h!==g;){const m=sn(p),y=p.getBoundingClientRect(),b=tt(p),_=y.left+(p.clientLeft+parseFloat(b.paddingLeft))*m.x,w=y.top+(p.clientTop+parseFloat(b.paddingTop))*m.y;l*=m.x,c*=m.y,u*=m.x,f*=m.y,l+=_,c+=w,g=Ke(p),p=to(g)}}return Or({width:u,height:f,x:l,y:c})}function Mp(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const o=i==="fixed",s=wt(r),a=e?pi(e.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=Tt(1);const u=Tt(0),f=lt(r);if((f||!f&&!o)&&((gn(r)!=="body"||Hn(s))&&(l=gi(r)),lt(r))){const d=Wt(r);c=sn(r),u.x=d.x+r.clientLeft,u.y=d.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x,y:n.y*c.y-l.scrollTop*c.y+u.y}}function Dp(t){return Array.from(t.getClientRects())}function Rc(t){return Wt(wt(t)).left+gi(t).scrollLeft}function zp(t){const e=wt(t),n=gi(t),r=t.ownerDocument.body,i=He(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=He(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-n.scrollLeft+Rc(t);const a=-n.scrollTop;return tt(r).direction==="rtl"&&(s+=He(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function Np(t,e){const n=Ke(t),r=wt(t),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=qo();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function $p(t,e){const n=Wt(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=lt(t)?sn(t):Tt(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function ia(t,e,n){let r;if(e==="viewport")r=Np(t,n);else if(e==="document")r=zp(wt(t));else if(et(e))r=$p(e,n);else{const i=kc(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return Or(r)}function Ic(t,e){const n=kt(t);return n===e||!et(n)||ln(n)?!1:tt(n).position==="fixed"||Ic(n,e)}function Fp(t,e){const n=e.get(t);if(n)return n;let r=Dn(t,[],!1).filter(a=>et(a)&&gn(a)!=="body"),i=null;const o=tt(t).position==="fixed";let s=o?kt(t):t;for(;et(s)&&!ln(s);){const a=tt(s),l=Yo(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Hn(s)&&!l&&Ic(t,s))?r=r.filter(u=>u!==s):i=a,s=kt(s)}return e.set(t,r),r}function Bp(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?pi(e)?[]:Fp(e,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{const f=ia(e,u,i);return c.top=He(f.top,c.top),c.right=st(f.right,c.right),c.bottom=st(f.bottom,c.bottom),c.left=He(f.left,c.left),c},ia(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function jp(t){const{width:e,height:n}=Oc(t);return{width:e,height:n}}function Up(t,e,n){const r=lt(e),i=wt(e),o=n==="fixed",s=Wt(t,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=Tt(0);if(r||!r&&!o)if((gn(e)!=="body"||Hn(i))&&(a=gi(e)),r){const f=Wt(e,!0,o,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&(l.x=Rc(i));const c=s.left+a.scrollLeft-l.x,u=s.top+a.scrollTop-l.y;return{x:c,y:u,width:s.width,height:s.height}}function Ti(t){return tt(t).position==="static"}function oa(t,e){return!lt(t)||tt(t).position==="fixed"?null:e?e(t):t.offsetParent}function Lc(t,e){const n=Ke(t);if(pi(t))return n;if(!lt(t)){let i=kt(t);for(;i&&!ln(i);){if(et(i)&&!Ti(i))return i;i=kt(i)}return n}let r=oa(t,e);for(;r&&kp(r)&&Ti(r);)r=oa(r,e);return r&&ln(r)&&Ti(r)&&!Yo(r)?n:r||Rp(t)||n}const Wp=async function(t){const e=this.getOffsetParent||Lc,n=this.getDimensions,r=await n(t.floating);return{reference:Up(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Vp(t){return tt(t).direction==="rtl"}const Hp={convertOffsetParentRelativeRectToViewportRelativeRect:Mp,getDocumentElement:wt,getClippingRect:Bp,getOffsetParent:Lc,getElementRects:Wp,getClientRects:Dp,getDimensions:jp,getScale:sn,isElement:et,isRTL:Vp};function Gp(t,e){let n=null,r;const i=wt(t);function o(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const{left:c,top:u,width:f,height:d}=t.getBoundingClientRect();if(a||e(),!f||!d)return;const h=er(u),g=er(i.clientWidth-(c+f)),p=er(i.clientHeight-(u+d)),m=er(c),b={rootMargin:-h+"px "+-g+"px "+-p+"px "+-m+"px",threshold:He(0,st(1,l))||1};let _=!0;function w(C){const O=C[0].intersectionRatio;if(O!==l){if(!_)return s();O?s(!1,O):r=setTimeout(()=>{s(!1,1e-7)},1e3)}_=!1}try{n=new IntersectionObserver(w,{...b,root:i.ownerDocument})}catch{n=new IntersectionObserver(w,b)}n.observe(t)}return s(!0),o}function Kp(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=Xo(t),u=i||o?[...c?Dn(c):[],...Dn(e)]:[];u.forEach(y=>{i&&y.addEventListener("scroll",n,{passive:!0}),o&&y.addEventListener("resize",n)});const f=c&&a?Gp(c,n):null;let d=-1,h=null;s&&(h=new ResizeObserver(y=>{let[b]=y;b&&b.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var _;(_=h)==null||_.observe(e)})),n()}),c&&!l&&h.observe(c),h.observe(e));let g,p=l?Wt(t):null;l&&m();function m(){const y=Wt(t);p&&(y.x!==p.x||y.y!==p.y||y.width!==p.width||y.height!==p.height)&&n(),p=y,g=requestAnimationFrame(m)}return n(),()=>{var y;u.forEach(b=>{i&&b.removeEventListener("scroll",n),o&&b.removeEventListener("resize",n)}),f==null||f(),(y=h)==null||y.disconnect(),h=null,l&&cancelAnimationFrame(g)}}const Zp=Pp,Yp=Ap,qp=Sp,Xp=Op,Jp=Cp,sa=wp,Qp=Tp,eg=(t,e,n)=>{const r=new Map,i={platform:Hp,...n},o={...i.platform,_c:r};return _p(t,e,{...i,platform:o})};var br=typeof document<"u"?E.useLayoutEffect:E.useEffect;function kr(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!kr(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&t.$$typeof)&&!kr(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}function Mc(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function aa(t,e){const n=Mc(t);return Math.round(e*n)/n}function Oi(t){const e=E.useRef(t);return br(()=>{e.current=t}),e}function tg(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,f]=E.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[d,h]=E.useState(r);kr(d,r)||h(r);const[g,p]=E.useState(null),[m,y]=E.useState(null),b=E.useCallback(X=>{X!==O.current&&(O.current=X,p(X))},[]),_=E.useCallback(X=>{X!==T.current&&(T.current=X,y(X))},[]),w=o||g,C=s||m,O=E.useRef(null),T=E.useRef(null),I=E.useRef(u),k=l!=null,M=Oi(l),j=Oi(i),S=Oi(c),L=E.useCallback(()=>{if(!O.current||!T.current)return;const X={placement:e,strategy:n,middleware:d};j.current&&(X.platform=j.current),eg(O.current,T.current,X).then(V=>{const te={...V,isPositioned:S.current!==!1};x.current&&!kr(I.current,te)&&(I.current=te,ai.flushSync(()=>{f(te)}))})},[d,e,n,j,S]);br(()=>{c===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,f(X=>({...X,isPositioned:!1})))},[c]);const x=E.useRef(!1);br(()=>(x.current=!0,()=>{x.current=!1}),[]),br(()=>{if(w&&(O.current=w),C&&(T.current=C),w&&C){if(M.current)return M.current(w,C,L);L()}},[w,C,L,M,k]);const z=E.useMemo(()=>({reference:O,floating:T,setReference:b,setFloating:_}),[b,_]),q=E.useMemo(()=>({reference:w,floating:C}),[w,C]),W=E.useMemo(()=>{const X={position:n,left:0,top:0};if(!q.floating)return X;const V=aa(q.floating,u.x),te=aa(q.floating,u.y);return a?{...X,transform:"translate("+V+"px, "+te+"px)",...Mc(q.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:V,top:te}},[n,a,q.floating,u.x,u.y]);return E.useMemo(()=>({...u,update:L,refs:z,elements:q,floatingStyles:W}),[u,L,z,q,W])}const ng=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?sa({element:r.current,padding:i}).fn(n):{}:r?sa({element:r,padding:i}).fn(n):{}}}},rg=(t,e)=>({...Zp(t),options:[t,e]}),ig=(t,e)=>({...Yp(t),options:[t,e]}),og=(t,e)=>({...Qp(t),options:[t,e]}),sg=(t,e)=>({...qp(t),options:[t,e]}),ag=(t,e)=>({...Xp(t),options:[t,e]}),lg=(t,e)=>({...Jp(t),options:[t,e]}),cg=(t,e)=>({...ng(t),options:[t,e]});var ug="Arrow",Dc=E.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...o}=t;return de.jsx(Mt.svg,{...o,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:de.jsx("polygon",{points:"0,0 30,0 15,10"})})});Dc.displayName=ug;var fg=Dc;function dg(t){const[e,n]=E.useState(void 0);return Ut(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=t.offsetWidth,a=t.offsetHeight;n({width:s,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var Jo="Popper",[zc,Nc]=wc(Jo),[hg,$c]=zc(Jo),Fc=t=>{const{__scopePopper:e,children:n}=t,[r,i]=E.useState(null);return de.jsx(hg,{scope:e,anchor:r,onAnchorChange:i,children:n})};Fc.displayName=Jo;var Bc="PopperAnchor",jc=E.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,o=$c(Bc,n),s=E.useRef(null),a=Kt(e,s);return E.useEffect(()=>{o.onAnchorChange((r==null?void 0:r.current)||s.current)}),r?null:de.jsx(Mt.div,{...i,ref:a})});jc.displayName=Bc;var Qo="PopperContent",[pg,gg]=zc(Qo),Uc=E.forwardRef((t,e)=>{var _e,ce,he,we,ve,Re;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:o="center",alignOffset:s=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:d=!1,updatePositionStrategy:h="optimized",onPlaced:g,...p}=t,m=$c(Qo,n),[y,b]=E.useState(null),_=Kt(e,Se=>b(Se)),[w,C]=E.useState(null),O=dg(w),T=(O==null?void 0:O.width)??0,I=(O==null?void 0:O.height)??0,k=r+(o!=="center"?"-"+o:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},j=Array.isArray(c)?c:[c],S=j.length>0,L={padding:M,boundary:j.filter(yg),altBoundary:S},{refs:x,floatingStyles:z,placement:q,isPositioned:W,middlewareData:X}=tg({strategy:"fixed",placement:k,whileElementsMounted:(...Se)=>Kp(...Se,{animationFrame:h==="always"}),elements:{reference:m.anchor},middleware:[rg({mainAxis:i+I,alignmentAxis:s}),l&&ig({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?og():void 0,...L}),l&&sg({...L}),ag({...L,apply:({elements:Se,rects:v,availableWidth:H,availableHeight:U})=>{const{width:A,height:P}=v.reference,D=Se.floating.style;D.setProperty("--radix-popper-available-width",`${H}px`),D.setProperty("--radix-popper-available-height",`${U}px`),D.setProperty("--radix-popper-anchor-width",`${A}px`),D.setProperty("--radix-popper-anchor-height",`${P}px`)}}),w&&cg({element:w,padding:a}),vg({arrowWidth:T,arrowHeight:I}),d&&lg({strategy:"referenceHidden",...L})]}),[V,te]=Hc(q),N=hn(g);Ut(()=>{W&&(N==null||N())},[W,N]);const $=(_e=X.arrow)==null?void 0:_e.x,ee=(ce=X.arrow)==null?void 0:ce.y,Q=((he=X.arrow)==null?void 0:he.centerOffset)!==0,[J,ge]=E.useState();return Ut(()=>{y&&ge(window.getComputedStyle(y).zIndex)},[y]),de.jsx("div",{ref:x.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:W?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:J,"--radix-popper-transform-origin":[(we=X.transformOrigin)==null?void 0:we.x,(ve=X.transformOrigin)==null?void 0:ve.y].join(" "),...((Re=X.hide)==null?void 0:Re.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:de.jsx(pg,{scope:n,placedSide:V,onArrowChange:C,arrowX:$,arrowY:ee,shouldHideArrow:Q,children:de.jsx(Mt.div,{"data-side":V,"data-align":te,...p,ref:_,style:{...p.style,animation:W?void 0:"none"}})})})});Uc.displayName=Qo;var Wc="PopperArrow",mg={top:"bottom",right:"left",bottom:"top",left:"right"},Vc=E.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,o=gg(Wc,r),s=mg[o.placedSide];return de.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:de.jsx(fg,{...i,ref:n,style:{...i.style,display:"block"}})})});Vc.displayName=Wc;function yg(t){return t!==null}var vg=t=>({name:"transformOrigin",options:t,fn(e){var m,y,b;const{placement:n,rects:r,middlewareData:i}=e,s=((m=i.arrow)==null?void 0:m.centerOffset)!==0,a=s?0:t.arrowWidth,l=s?0:t.arrowHeight,[c,u]=Hc(n),f={start:"0%",center:"50%",end:"100%"}[u],d=(((y=i.arrow)==null?void 0:y.x)??0)+a/2,h=(((b=i.arrow)==null?void 0:b.y)??0)+l/2;let g="",p="";return c==="bottom"?(g=s?f:`${d}px`,p=`${-l}px`):c==="top"?(g=s?f:`${d}px`,p=`${r.floating.height+l}px`):c==="right"?(g=`${-l}px`,p=s?f:`${h}px`):c==="left"&&(g=`${r.floating.width+l}px`,p=s?f:`${h}px`),{data:{x:g,y:p}}}});function Hc(t){const[e,n="center"]=t.split("-");return[e,n]}var bg=Fc,xg=jc,_g=Uc,wg=Vc;function Sg(t,e){return E.useReducer((n,r)=>e[n][r]??n,t)}var Gc=t=>{const{present:e,children:n}=t,r=Cg(e),i=typeof n=="function"?n({present:r.isPresent}):E.Children.only(n),o=Kt(r.ref,Eg(i));return typeof n=="function"||r.isPresent?E.cloneElement(i,{ref:o}):null};Gc.displayName="Presence";function Cg(t){const[e,n]=E.useState(),r=E.useRef({}),i=E.useRef(t),o=E.useRef("none"),s=t?"mounted":"unmounted",[a,l]=Sg(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const c=tr(r.current);o.current=a==="mounted"?c:"none"},[a]),Ut(()=>{const c=r.current,u=i.current;if(u!==t){const d=o.current,h=tr(c);t?l("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&d!==h?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),Ut(()=>{if(e){const c=f=>{const h=tr(r.current).includes(f.animationName);f.target===e&&h&&ai.flushSync(()=>l("ANIMATION_END"))},u=f=>{f.target===e&&(o.current=tr(r.current))};return e.addEventListener("animationstart",u),e.addEventListener("animationcancel",c),e.addEventListener("animationend",c),()=>{e.removeEventListener("animationstart",u),e.removeEventListener("animationcancel",c),e.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:E.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function tr(t){return(t==null?void 0:t.animationName)||"none"}function Eg(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Pg({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=Ag({defaultProp:e,onChange:n}),o=t!==void 0,s=o?t:r,a=hn(n),l=E.useCallback(c=>{if(o){const f=typeof c=="function"?c(t):c;f!==t&&a(f)}else i(c)},[o,t,i,a]);return[s,l]}function Ag({defaultProp:t,onChange:e}){const n=E.useState(t),[r]=n,i=E.useRef(r),o=hn(e);return E.useEffect(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),n}var Tg="VisuallyHidden",Kc=E.forwardRef((t,e)=>de.jsx(Mt.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));Kc.displayName=Tg;var Og=Kc,[mi,MS]=wc("Tooltip",[Nc]),yi=Nc(),kg="TooltipProvider",no="tooltip.open",[DS,es]=mi(kg),vi="Tooltip",[Rg,bi]=mi(vi),Zc=t=>{const{__scopeTooltip:e,children:n,open:r,defaultOpen:i=!1,onOpenChange:o,disableHoverableContent:s,delayDuration:a}=t,l=es(vi,t.__scopeTooltip),c=yi(e),[u,f]=E.useState(null),d=dp(),h=E.useRef(0),g=s??l.disableHoverableContent,p=a??l.delayDuration,m=E.useRef(!1),[y=!1,b]=Pg({prop:r,defaultProp:i,onChange:T=>{T?(l.onOpen(),document.dispatchEvent(new CustomEvent(no))):l.onClose(),o==null||o(T)}}),_=E.useMemo(()=>y?m.current?"delayed-open":"instant-open":"closed",[y]),w=E.useCallback(()=>{window.clearTimeout(h.current),m.current=!1,b(!0)},[b]),C=E.useCallback(()=>{window.clearTimeout(h.current),b(!1)},[b]),O=E.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>{m.current=!0,b(!0)},p)},[p,b]);return E.useEffect(()=>()=>window.clearTimeout(h.current),[]),de.jsx(bg,{...c,children:de.jsx(Rg,{scope:e,contentId:d,open:y,stateAttribute:_,trigger:u,onTriggerChange:f,onTriggerEnter:E.useCallback(()=>{l.isOpenDelayed?O():w()},[l.isOpenDelayed,O,w]),onTriggerLeave:E.useCallback(()=>{g?C():window.clearTimeout(h.current)},[C,g]),onOpen:w,onClose:C,disableHoverableContent:g,children:n})})};Zc.displayName=vi;var ro="TooltipTrigger",Yc=E.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=bi(ro,n),o=es(ro,n),s=yi(n),a=E.useRef(null),l=Kt(e,a,i.onTriggerChange),c=E.useRef(!1),u=E.useRef(!1),f=E.useCallback(()=>c.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),de.jsx(xg,{asChild:!0,...s,children:de.jsx(Mt.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:l,onPointerMove:ht(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:ht(t.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:ht(t.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:ht(t.onFocus,()=>{c.current||i.onOpen()}),onBlur:ht(t.onBlur,i.onClose),onClick:ht(t.onClick,i.onClose)})})});Yc.displayName=ro;var Ig="TooltipPortal",[zS,Lg]=mi(Ig,{forceMount:void 0}),cn="TooltipContent",qc=E.forwardRef((t,e)=>{const n=Lg(cn,t.__scopeTooltip),{forceMount:r=n.forceMount,side:i="top",...o}=t,s=bi(cn,t.__scopeTooltip);return de.jsx(Gc,{present:r||s.open,children:s.disableHoverableContent?de.jsx(Xc,{side:i,...o,ref:e}):de.jsx(Mg,{side:i,...o,ref:e})})}),Mg=E.forwardRef((t,e)=>{const n=bi(cn,t.__scopeTooltip),r=es(cn,t.__scopeTooltip),i=E.useRef(null),o=Kt(e,i),[s,a]=E.useState(null),{trigger:l,onClose:c}=n,u=i.current,{onPointerInTransitChange:f}=r,d=E.useCallback(()=>{a(null),f(!1)},[f]),h=E.useCallback((g,p)=>{const m=g.currentTarget,y={x:g.clientX,y:g.clientY},b=Ng(y,m.getBoundingClientRect()),_=$g(y,b),w=Fg(p.getBoundingClientRect()),C=jg([..._,...w]);a(C),f(!0)},[f]);return E.useEffect(()=>()=>d(),[d]),E.useEffect(()=>{if(l&&u){const g=m=>h(m,u),p=m=>h(m,l);return l.addEventListener("pointerleave",g),u.addEventListener("pointerleave",p),()=>{l.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",p)}}},[l,u,h,d]),E.useEffect(()=>{if(s){const g=p=>{const m=p.target,y={x:p.clientX,y:p.clientY},b=(l==null?void 0:l.contains(m))||(u==null?void 0:u.contains(m)),_=!Bg(y,s);b?d():_&&(d(),c())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[l,u,s,c,d]),de.jsx(Xc,{...t,ref:o})}),[Dg,zg]=mi(vi,{isInside:!1}),Xc=E.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":i,onEscapeKeyDown:o,onPointerDownOutside:s,...a}=t,l=bi(cn,n),c=yi(n),{onClose:u}=l;return E.useEffect(()=>(document.addEventListener(no,u),()=>document.removeEventListener(no,u)),[u]),E.useEffect(()=>{if(l.trigger){const f=d=>{const h=d.target;h!=null&&h.contains(l.trigger)&&u()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[l.trigger,u]),de.jsx(Cc,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:f=>f.preventDefault(),onDismiss:u,children:de.jsxs(_g,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[de.jsx(lc,{children:r}),de.jsx(Dg,{scope:n,isInside:!0,children:de.jsx(Og,{id:l.contentId,role:"tooltip",children:i||r})})]})})});qc.displayName=cn;var Jc="TooltipArrow",Qc=E.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=yi(n);return zg(Jc,n).isInside?null:de.jsx(wg,{...i,...r,ref:e})});Qc.displayName=Jc;function Ng(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),i=Math.abs(e.right-t.x),o=Math.abs(e.left-t.x);switch(Math.min(n,r,i,o)){case o:return"left";case i:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function $g(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function Fg(t){const{top:e,right:n,bottom:r,left:i}=t;return[{x:i,y:e},{x:n,y:e},{x:n,y:r},{x:i,y:r}]}function Bg(t,e){const{x:n,y:r}=t;let i=!1;for(let o=0,s=e.length-1;o<e.length;s=o++){const a=e[o].x,l=e[o].y,c=e[s].x,u=e[s].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function jg(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),Ug(e)}function Ug(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const i=t[r];for(;e.length>=2;){const o=e[e.length-1],s=e[e.length-2];if((o.x-s.x)*(i.y-s.y)>=(o.y-s.y)*(i.x-s.x))e.pop();else break}e.push(i)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const i=t[r];for(;n.length>=2;){const o=n[n.length-1],s=n[n.length-2];if((o.x-s.x)*(i.y-s.y)>=(o.y-s.y)*(i.x-s.x))n.pop();else break}n.push(i)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var Wg=Zc,Vg=Yc,Hg=qc,Gg=Qc;function Kg(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function ye(t,e){if(t==null)return{};var n=Kg(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}let Ee;(function(t){t[t.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",t[t.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",t[t.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",t[t.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",t[t.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",t[t.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",t[t.THEME_ERROR=6]="THEME_ERROR",t[t.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",t[t.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",t[t.EMPTY_KEY=9]="EMPTY_KEY"})(Ee||(Ee={}));const Zg={[Ee.UNSUPPORTED_INPUT]:(t,e)=>[`An input with type \`${t}\` input was found at path \`${e}\` but it's not supported yet.`],[Ee.NO_COMPONENT_FOR_TYPE]:(t,e)=>[`Type \`${t}\` found at path \`${e}\` can't be displayed in panel because no component supports it yet.`],[Ee.UNKNOWN_INPUT]:(t,e)=>[`input at path \`${t}\` is not recognized.`,e],[Ee.DUPLICATE_KEYS]:(t,e,n)=>[`Key \`${t}\` of path \`${e}\` already exists at path \`${n}\`. Even nested keys need to be unique. Rename one of the keys.`],[Ee.ALREADY_REGISTERED_TYPE]:t=>[`Type ${t} has already been registered. You can't register a component with the same type.`],[Ee.CLIPBOARD_ERROR]:t=>["Error copying the value",t],[Ee.THEME_ERROR]:(t,e)=>[`Error accessing the theme \`${t}.${e}\` value.`],[Ee.PATH_DOESNT_EXIST]:t=>[`Error getting the value at path \`${t}\`. There is probably an error in your \`render\` function.`],[Ee.PATH_DOESNT_EXIST]:t=>[`Error accessing the value at path \`${t}\``],[Ee.INPUT_TYPE_OVERRIDE]:(t,e,n)=>[`Input at path \`${t}\` already exists with type: \`${e}\`. Its type cannot be overridden with type \`${n}\`.`],[Ee.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function eu(t,e,...n){const[r,...i]=Zg[e](...n);console[t]("LEVA: "+r,...i)}const pt=eu.bind(null,"warn"),Yg=eu.bind(null,"log"),qg=["value"],Xg=["schema"],Jg=["value"],tu=[],Vt={};function la(t){let{value:e}=t,n=ye(t,qg);for(let r of tu){const i=r(e,n);if(i)return i}}function St(t,e){let{schema:n}=e,r=ye(e,Xg);if(t in Vt){pt(Ee.ALREADY_REGISTERED_TYPE,t);return}tu.push((i,o)=>n(i,o)&&t),Vt[t]=r}function ki(t,e,n,r){const{normalize:i}=Vt[t];if(i)return i(e,n,r);if(typeof e!="object"||!("value"in e))return{value:e};const{value:o}=e,s=ye(e,Jg);return{value:o,settings:s}}function Qg(t,e,n,r,i,o){const{sanitize:s}=Vt[t];return s?s(e,n,r,i,o):e}function ca(t,e,n){const{format:r}=Vt[t];return r?r(e,n):e}function em(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ua(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function le(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ua(Object(n),!0).forEach(function(r){em(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const Rt=(t,e,n)=>t>n?n:t<e?e:t,tm=t=>{if(t===""||typeof t=="number")return t;try{const e=Pt(t);if(!isNaN(e))return e}catch{}return parseFloat(t)},nm=Math.log(10);function fa(t){let e=Math.abs(+String(t).replace(".",""));if(e===0)return .01;for(;e!==0&&e%10===0;)e/=10;const n=Math.floor(Math.log(e)/nm)+1,r=Math.floor(Math.log10(Math.abs(t))),i=Math.pow(10,r-n);return Math.max(i,.001)}const Rr=(t,e,n)=>n===e?0:(Rt(t,e,n)-e)/(n-e),Ir=(t,e,n)=>t*(n-e)+e,rm=()=>"_"+Math.random().toString(36).substr(2,9),da=/\(([0-9+\-*/^ .]+)\)/,ha=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,pa=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,ga=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,ma=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,ya=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function Pt(t){if(isNaN(Number(t)))if(da.test(t)){const e=t.replace(da,(n,r)=>String(Pt(r)));return Pt(e)}else if(ha.test(t)){const e=t.replace(ha,(n,r,i)=>String(Math.pow(Number(r),Number(i))));return Pt(e)}else if(pa.test(t)){const e=t.replace(pa,(n,r,i)=>String(Number(r)*Number(i)));return Pt(e)}else if(ga.test(t)){const e=t.replace(ga,(n,r,i)=>{if(i!=0)return String(Number(r)/Number(i));throw new Error("Division by zero")});return Pt(e)}else if(ma.test(t)){const e=t.replace(ma,(n,r,i)=>String(Number(r)+Number(i)));return Pt(e)}else if(ya.test(t)){const e=t.replace(ya,(n,r,i)=>String(Number(r)-Number(i)));return Pt(e)}else return Number(t);return Number(t)}function im(t,e){return e.reduce((n,r)=>(t&&t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}function om(t,e){const n=le({},t);return e.forEach(r=>r in t&&delete n[r]),n}function sm(t,e){return t.reduce((n,r,i)=>Object.assign(n,{[e[i]]:r}),{})}function nu(t){return Object.prototype.toString.call(t)==="[object Object]"}const am=t=>nu(t)&&Object.keys(t).length===0;let Qe;(function(t){t.BUTTON="BUTTON",t.BUTTON_GROUP="BUTTON_GROUP",t.MONITOR="MONITOR",t.FOLDER="FOLDER"})(Qe||(Qe={}));let nt;(function(t){t.SELECT="SELECT",t.IMAGE="IMAGE",t.NUMBER="NUMBER",t.COLOR="COLOR",t.STRING="STRING",t.BOOLEAN="BOOLEAN",t.INTERVAL="INTERVAL",t.VECTOR3D="VECTOR3D",t.VECTOR2D="VECTOR2D"})(nt||(nt={}));const lm=["type","__customInput"],cm=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],um=["type"];function ru(t,e,n={},r){var i,o;if(typeof t!="object"||Array.isArray(t))return{type:r,input:t,options:le({key:e,label:e,optional:!1,disabled:!1,order:0},n)};if("__customInput"in t){const{type:C,__customInput:O}=t,T=ye(t,lm);return ru(O,e,T,C)}const{render:s,label:a,optional:l,order:c=0,disabled:u,hint:f,onChange:d,onEditStart:h,onEditEnd:g,transient:p}=t,m=ye(t,cm),y=le({render:s,key:e,label:a??e,hint:f,transient:p??!!d,onEditStart:h,onEditEnd:g,disabled:u,optional:l,order:c},n);let{type:b}=m,_=ye(m,um);if(b=r??b,b in Qe)return{type:b,input:_,options:y};let w;return r&&nu(_)&&"value"in _?w=_.value:w=am(_)?void 0:_,{type:b,input:w,options:le(le({},y),{},{onChange:d,optional:(i=y.optional)!==null&&i!==void 0?i:!1,disabled:(o=y.disabled)!==null&&o!==void 0?o:!1})}}function fm(t,e,n,r){const i=ru(t,e),{type:o,input:s,options:a}=i;if(o)return o in Qe?i:{type:o,input:ki(o,s,n,r),options:a};let l=la(s);return l?{type:l,input:ki(l,s,n,r),options:a}:(l=la({value:s}),l?{type:l,input:ki(l,{value:s},n,r),options:a}:!1)}function va(t,e,n,r,i){const{value:o,type:s,settings:a}=t;t.value=iu({type:s,value:o,settings:a},e,n,r),t.fromPanel=i}const dm=function(e,n,r){this.type="LEVA_ERROR",this.message="LEVA: "+e,this.previousValue=n,this.error=r};function iu({type:t,value:e,settings:n},r,i,o){const s=t!=="SELECT"&&typeof r=="function"?r(e):r;let a;try{a=Qg(t,s,n,e,i,o)}catch(l){throw new dm(`The value \`${r}\` did not result in a correct value.`,e,l)}return In(a,e)?e:a}const ou=(t,e,n=!1)=>{let r=0;return function(){const i=arguments,o=n&&!r,s=()=>t.apply(this,i);window.clearTimeout(r),r=window.setTimeout(s,e),o&&s()}},su=t=>t.shiftKey?5:t.altKey?1/5:1;function hm(t,e){const n=console.error;console.error=()=>{},Xl.render(t,e),console.error=n}const pm=["value"],gm=["min","max"],mm=t=>{if(typeof t=="number")return!0;if(typeof t=="string"){const e=parseFloat(t);return isNaN(e)?!1:t.substring((""+e).length).trim().length<4}return!1},au=(t,{min:e=-1/0,max:n=1/0,suffix:r})=>{const i=parseFloat(t);if(t===""||isNaN(i))throw Error("Invalid number");const o=Rt(i,e,n);return r?o+r:o},ym=(t,{pad:e=0,suffix:n})=>{const r=parseFloat(t).toFixed(e);return n?r+n:r},lu=t=>{let{value:e}=t,n=ye(t,pm);const{min:r=-1/0,max:i=1/0}=n,o=ye(n,gm);let s=parseFloat(e);const a=typeof e=="string"?e.substring((""+s).length):void 0;s=Rt(s,r,i);let l=n.step;l||(Number.isFinite(r)?Number.isFinite(i)?l=+(Math.abs(i-r)/100).toPrecision(1):l=+(Math.abs(s-r)/100).toPrecision(1):Number.isFinite(i)&&(l=+(Math.abs(i-s)/100).toPrecision(1)));const c=l?fa(l)*10:fa(s);l=l||c/10;const u=Math.round(Rt(Math.log10(1/c),0,2));return{value:a?s+a:s,settings:le({initialValue:s,step:l,pad:u,min:r,max:i,suffix:a},o)}},cu=(t,{step:e,initialValue:n})=>{const r=Math.round((t-n)/e);return n+r*e};var uu=Object.freeze({__proto__:null,schema:mm,sanitize:au,format:ym,normalize:lu,sanitizeStep:cu});function Te(){return Te=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Te.apply(this,arguments)}const fu=E.createContext({});function Me(){return E.useContext(fu)}const ts=E.createContext(null),du=E.createContext(null),hu=E.createContext(null);function Gn(){return E.useContext(du)}function vm(){return E.useContext(hu)}const pu=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function nr(t,e){const[n,r]=t.split(" "),i={};return n!=="none"&&(i.boxShadow=`${e.inset?"inset ":""}0 0 0 $borderWidths${[e.key]} $colors${n!=="default"&&n||e.borderColor}`),r&&(i.backgroundColor=r),i}const _n={$inputStyle:()=>t=>nr(t,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>t=>nr(t,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>t=>nr(t,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>t=>nr(t,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:ae,css:NS,createTheme:bm,globalCss:xm,keyframes:$S}=ah({prefix:"leva",theme:pu(),utils:le(le({},_n),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:t=>({"&:focus":_n.$focusStyle()(t)}),$focusWithin:t=>({"&:focus-within":_n.$focusStyle()(t)}),$hover:t=>({"&:hover":_n.$hoverStyle()(t)}),$active:t=>({"&:active":_n.$activeStyle()(t)})})}),_m=xm({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function wm(t){const e=pu();if(!t)return{theme:e,className:""};Object.keys(t).forEach(r=>{Object.assign(e[r],t[r])});const n=bm(e);return{theme:e,className:n.className}}function yt(t,e){const{theme:n}=E.useContext(ts);if(!(t in n)||!(e in n[t]))return pt(Ee.THEME_ERROR,t,e),"";let r=e;for(;;){let i=n[t][r];if(typeof i=="string"&&i.charAt(0)==="$")r=i.substr(1);else return i}}const gu=ae("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),mu=ae("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${gu}`]:{paddingLeft:0}}),Sm=ae(mu,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),Cm=ae("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),Em=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],Pm=["onUpdate"];function ns(t){let{innerLabel:e,value:n,onUpdate:r,onChange:i,onKeyDown:o,type:s,id:a,inputType:l="text",rows:c=0}=t,u=ye(t,Em);const{id:f,emitOnEditStart:d,emitOnEditEnd:h,disabled:g}=Me(),p=a||f,m=E.useRef(null),y=c>0,b=y?"textarea":"input",_=E.useCallback(O=>T=>{const I=T.currentTarget.value;O(I)},[]);R.useEffect(()=>{const O=m.current,T=_(I=>{r(I),h()});return O==null||O.addEventListener("blur",T),()=>O==null?void 0:O.removeEventListener("blur",T)},[_,r,h]);const w=E.useCallback(O=>{O.key==="Enter"&&_(r)(O)},[_,r]),C=Object.assign({as:b},y?{rows:c}:{},u);return R.createElement(Cm,{textArea:y},e&&typeof e=="string"?R.createElement(mu,null,e):e,R.createElement(gu,Te({levaType:s,ref:m,id:p,type:l,autoComplete:"off",spellCheck:"false",value:n,onChange:_(i),onFocus:()=>d(),onKeyPress:w,onKeyDown:o,disabled:g},C)))}function Am(t){let{onUpdate:e}=t,n=ye(t,Pm);const r=E.useCallback(o=>e(tm(o)),[e]),i=E.useCallback(o=>{const s=o.key==="ArrowUp"?1:o.key==="ArrowDown"?-1:0;if(s){o.preventDefault();const a=o.altKey?.1:o.shiftKey?10:1;e(l=>parseFloat(l)+s*a)}},[e]);return R.createElement(ns,Te({},n,{onUpdate:r,onKeyDown:i,type:"number"}))}const Lr=ae("div",{}),io=ae("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),Tm=ae("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${io}::after`]:{opacity:.6},[`${Lr}:hover > & + ${io}::after`]:{opacity:.6},[`${Lr}:hover > & > svg`]:{opacity:1}}),yu=ae("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${Lr}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),vu=ae("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${yu} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),bu=ae(vu,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),Om=ae("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),km=ae("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),oo=ae("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),Rm=ae("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${oo}`]:{pointerEvents:"auto"}}}}}),xu=ae("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),Im=ae("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),Lm=ae(Gg,{fill:"$toolTipBackground"});function rs({children:t}){const{className:e}=E.useContext(ts);return R.createElement(Od,{className:e},t)}const Mm=["align"];function Dm(){const{id:t,disable:e,disabled:n}=Me();return R.createElement(R.Fragment,null,R.createElement(km,{id:t+"__disable",type:"checkbox",checked:!n,onChange:()=>e(!n)}),R.createElement("label",{htmlFor:t+"__disable"}))}function zm(t){const{id:e,optional:n,hint:r}=Me(),i=t.htmlFor||(e?{htmlFor:e}:null),o=!r&&typeof t.children=="string"?{title:t.children}:null;return R.createElement(R.Fragment,null,n&&R.createElement(Dm,null),r!==void 0?R.createElement(Wg,null,R.createElement(Vg,{asChild:!0},R.createElement(oo,Te({},i,t))),R.createElement(Hg,{side:"top",sideOffset:2},R.createElement(Im,null,r,R.createElement(Lm,null)))):R.createElement(oo,Te({},i,o,t)))}function rt(t){let{align:e}=t,n=ye(t,Mm);const{value:r,label:i,key:o,disabled:s}=Me(),{hideCopyButton:a}=vm(),l=!a&&o!==void 0,[c,u]=E.useState(!1),f=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[o]:r??""})),u(!0)}catch{pt(Ee.CLIPBOARD_ERROR,{[o]:r})}};return R.createElement(Om,{align:e,onPointerLeave:()=>u(!1)},R.createElement(zm,n),l&&!s&&R.createElement("div",{title:`Click to copy ${typeof i=="string"?i:o} value`},c?R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},R.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),R.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):R.createElement("svg",{onClick:f,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},R.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),R.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const Nm=["toggled"],$m=ae("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function is(t){let{toggled:e}=t,n=ye(t,Nm);return R.createElement($m,Te({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${e?0:-90}deg)`}},n),R.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const Fm=["input"];function qe(t){let{input:e}=t,n=ye(t,Fm);return e?R.createElement(bu,n):R.createElement(vu,n)}function _u({value:t,type:e,settings:n,setValue:r}){const[i,o]=E.useState(ca(e,t,n)),s=E.useRef(t),a=E.useRef(n);a.current=n;const l=E.useCallback(u=>o(ca(e,u,a.current)),[e]),c=E.useCallback(u=>{try{r(u)}catch(f){const{type:d,previousValue:h}=f;if(d!=="LEVA_ERROR")throw f;l(h)}},[l,r]);return E.useEffect(()=>{In(t,s.current)||l(t),s.current=t},[t,l]),{displayValue:i,onChange:o,onUpdate:c}}function Kn(t,e){const{emitOnEditStart:n,emitOnEditEnd:r}=Me();return ep(i=>{i.first&&(document.body.classList.add("leva__panel__dragged"),n==null||n());const o=t(i);return i.last&&(document.body.classList.remove("leva__panel__dragged"),r==null||r()),o},e)}function Bm(t){const e=E.useRef(null),n=E.useRef(null),r=E.useRef(!1);return E.useEffect(()=>{const i=ou(()=>{e.current.width=e.current.offsetWidth*window.devicePixelRatio,e.current.height=e.current.offsetHeight*window.devicePixelRatio,t(e.current,n.current)},250);return window.addEventListener("resize",i),r.current||(i(),r.current=!0),()=>window.removeEventListener("resize",i)},[t]),E.useEffect(()=>{n.current=e.current.getContext("2d")},[]),[e,n]}function wu(){const t=E.useRef(null),e=E.useRef({x:0,y:0}),n=E.useCallback(r=>{Object.assign(e.current,r),t.current&&(t.current.style.transform=`translate3d(${e.current.x}px, ${e.current.y}px, 0)`)},[]);return[t,n]}const jm=["__refCount"],Ri=(t,e)=>{if(!t[e])return null;const n=t[e];return ye(n,jm)};function Um(t){const e=Gn(),[n,r]=E.useState(Ri(e.getData(),t)),i=E.useCallback(c=>e.setValueAtPath(t,c,!0),[t,e]),o=E.useCallback(c=>e.setSettingsAtPath(t,c),[t,e]),s=E.useCallback(c=>e.disableInputAtPath(t,c),[t,e]),a=E.useCallback(()=>e.emitOnEditStart(t),[t,e]),l=E.useCallback(()=>e.emitOnEditEnd(t),[t,e]);return E.useEffect(()=>{r(Ri(e.getData(),t));const c=e.useStore.subscribe(u=>Ri(u.data,t),r,{equalityFn:fi});return()=>c()},[e,t]),[n,{set:i,setSettings:o,disable:s,storeId:e.storeId,emitOnEditStart:a,emitOnEditEnd:l}]}const Wm=ae("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),Su=ae("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),so=ae("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),Cu=ae("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),Eu=ae("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function Vm({value:t,min:e,max:n,onDrag:r,step:i,initialValue:o}){const s=E.useRef(null),a=E.useRef(null),l=E.useRef(0),c=yt("sizes","scrubberWidth"),u=Kn(({event:d,first:h,xy:[g],movement:[p],memo:m})=>{if(h){const{width:b,left:_}=s.current.getBoundingClientRect();l.current=b-parseFloat(c),m=(d==null?void 0:d.target)===a.current?t:Ir((g-_)/b,e,n)}const y=m+Ir(p/l.current,0,n-e);return r(cu(y,{step:i,initialValue:o})),m}),f=Rr(t,e,n);return R.createElement(Cu,Te({ref:s},u()),R.createElement(Su,null,R.createElement(Eu,{style:{left:0,right:`${(1-f)*100}%`}})),R.createElement(so,{ref:a,style:{left:`calc(${f} * (100% - ${c}))`}}))}const Hm=R.memo(({label:t,onUpdate:e,step:n,innerLabelTrim:r})=>{const[i,o]=E.useState(!1),s=Kn(({active:a,delta:[l],event:c,memo:u=0})=>(o(a),u+=l/2,Math.abs(u)>=1&&(e(f=>parseFloat(f)+Math.floor(u)*n*su(c)),u=0),u));return R.createElement(Sm,Te({dragging:i,title:t.length>1?t:""},s()),t.slice(0,r))});function Pu({label:t,id:e,displayValue:n,onUpdate:r,onChange:i,settings:o,innerLabelTrim:s=1}){const a=s>0&&R.createElement(Hm,{label:t,step:o.step,onUpdate:r,innerLabelTrim:s});return R.createElement(Am,{id:e,value:String(n),onUpdate:r,onChange:i,innerLabel:a})}function Gm(){const t=Me(),{label:e,value:n,onUpdate:r,settings:i,id:o}=t,{min:s,max:a}=i,l=a!==1/0&&s!==-1/0;return R.createElement(qe,{input:!0},R.createElement(rt,null,e),R.createElement(Wm,{hasRange:l},l&&R.createElement(Vm,Te({value:parseFloat(n),onDrag:r},i)),R.createElement(Pu,Te({},t,{id:o,label:"value",innerLabelTrim:l?0:1}))))}const{sanitizeStep:Km}=uu,Zm=ye(uu,["sanitizeStep"]);var Ym=le({component:Gm},Zm);const qm=(t,e)=>We().schema({options:We().passesAnyOf(We().object(),We().array())}).test(e),Xm=(t,{values:e})=>{if(e.indexOf(t)<0)throw Error("Selected value doesn't match Select options");return t},Jm=(t,{values:e})=>e.indexOf(t),Qm=t=>{let{value:e,options:n}=t,r,i;return Array.isArray(n)?(i=n,r=n.map(o=>String(o))):(i=Object.values(n),r=Object.keys(n)),"value"in t?i.includes(e)||(r.unshift(String(e)),i.unshift(e)):e=i[0],Object.values(n).includes(e)||(n[String(e)]=e),{value:e,settings:{keys:r,values:i}}};var e0=Object.freeze({__proto__:null,schema:qm,sanitize:Xm,format:Jm,normalize:Qm});const t0=ae("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),ao=ae("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),n0=ae("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${ao}:focus + &`]:{$focusStyle:""},[`${ao}:hover + &`]:{$hoverStyle:""}});function r0({displayValue:t,value:e,onUpdate:n,id:r,settings:i,disabled:o}){const{keys:s,values:a}=i,l=E.useRef();return e===a[t]&&(l.current=s[t]),R.createElement(t0,null,R.createElement(ao,{id:r,value:t,onChange:c=>n(a[Number(c.currentTarget.value)]),disabled:o},s.map((c,u)=>R.createElement("option",{key:c,value:u},c))),R.createElement(n0,null,l.current),R.createElement(is,{toggled:!0}))}function i0(){const{label:t,value:e,displayValue:n,onUpdate:r,id:i,disabled:o,settings:s}=Me();return R.createElement(qe,{input:!0},R.createElement(rt,null,t),R.createElement(r0,{id:i,value:e,displayValue:n,onUpdate:r,settings:s,disabled:o}))}var o0=le({component:i0},e0);const s0=t=>We().string().test(t),a0=t=>{if(typeof t!="string")throw Error("Invalid string");return t},l0=({value:t,editable:e=!0,rows:n=!1})=>({value:t,settings:{editable:e,rows:typeof n=="number"?n:n?5:0}});var c0=Object.freeze({__proto__:null,schema:s0,sanitize:a0,normalize:l0});const u0=["displayValue","onUpdate","onChange","editable"],f0=ae("div",{whiteSpace:"pre-wrap"});function d0(t){let{displayValue:e,onUpdate:n,onChange:r,editable:i=!0}=t,o=ye(t,u0);return i?R.createElement(ns,Te({value:e,onUpdate:n,onChange:r},o)):R.createElement(f0,null,e)}function h0(){const{label:t,settings:e,displayValue:n,onUpdate:r,onChange:i}=Me();return R.createElement(qe,{input:!0},R.createElement(rt,null,t),R.createElement(d0,Te({displayValue:n,onUpdate:r,onChange:i},e)))}var p0=le({component:h0},c0);const g0=t=>We().boolean().test(t),m0=t=>{if(typeof t!="boolean")throw Error("Invalid boolean");return t};var y0=Object.freeze({__proto__:null,schema:g0,sanitize:m0});const v0=ae("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function b0({value:t,onUpdate:e,id:n,disabled:r}){return R.createElement(v0,null,R.createElement("input",{id:n,type:"checkbox",checked:t,onChange:i=>e(i.currentTarget.checked),disabled:r}),R.createElement("label",{htmlFor:n},R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function x0(){const{label:t,value:e,onUpdate:n,disabled:r,id:i}=Me();return R.createElement(qe,{input:!0},R.createElement(rt,null,t),R.createElement(b0,{value:e,onUpdate:n,id:i,disabled:r}))}var _0=le({component:x0},y0);const w0=["locked"];function S0({value:t,id:e,valueKey:n,settings:r,onUpdate:i,innerLabelTrim:o}){const s=E.useRef(t[n]);s.current=t[n];const a=E.useCallback(c=>i({[n]:iu({type:"NUMBER",value:s.current,settings:r},c)}),[i,r,n]),l=_u({type:"NUMBER",value:t[n],settings:r,setValue:a});return R.createElement(Pu,{id:e,label:n,value:t[n],displayValue:l.displayValue,onUpdate:l.onUpdate,onChange:l.onChange,settings:r,innerLabelTrim:o})}const C0=ae("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function E0(t){let{locked:e}=t,n=ye(t,w0);return R.createElement("svg",Te({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),e?R.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):R.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function os({value:t,onUpdate:e,settings:n,innerLabelTrim:r}){const{id:i,setSettings:o}=Me(),{lock:s,locked:a}=n;return R.createElement(C0,{withLock:s},s&&R.createElement(E0,{locked:a,onClick:()=>o({locked:!a})}),Object.keys(t).map((l,c)=>R.createElement(S0,{id:c===0?i:`${i}.${l}`,key:l,valueKey:l,value:t,settings:n[l],onUpdate:e,innerLabelTrim:r})))}const Au=(t,e)=>{const n={};let r=0,i=1/0;Object.entries(t).forEach(([o,s])=>{n[o]=lu(le({value:s},e[o])).settings,r=Math.max(r,n[o].step),i=Math.min(i,n[o].pad)});for(let o in n){const{step:s,min:a,max:l}=e[o]||{};!isFinite(s)&&(!isFinite(a)||!isFinite(l))&&(n[o].step=r,n[o].pad=i)}return n},P0=["lock"],A0=["value"];function T0(t){const e=We().array().length(t).every.number(),n=r=>{if(!r||typeof r!="object")return!1;const i=Object.values(r);return i.length===t&&i.every(o=>isFinite(o))};return r=>e.test(r)||n(r)}function O0(t){return Array.isArray(t)?"array":"object"}function Tn(t,e,n){return O0(t)===e?t:e==="array"?Object.values(t):sm(t,n)}const k0=(t,e,n)=>{const r=Tn(t,"object",e.keys);for(let s in r)r[s]=au(r[s],e[s]);const i=Object.keys(r);let o={};if(i.length===e.keys.length)o=r;else{const s=Tn(n,"object",e.keys);if(i.length===1&&e.locked){const a=i[0],l=r[a],c=s[a],u=c!==0?l/c:1;for(let f in s)f===a?o[a]=l:o[f]=s[f]*u}else o=le(le({},s),r)}return Tn(o,e.format,e.keys)},R0=(t,e)=>Tn(t,"object",e.keys),I0=t=>!!t&&("step"in t||"min"in t||"max"in t);function L0(t,e,n=[]){const{lock:r=!1}=e,i=ye(e,P0),o=Array.isArray(t)?"array":"object",s=o==="object"?Object.keys(t):n,a=Tn(t,"object",s),l=I0(i)?s.reduce((u,f)=>Object.assign(u,{[f]:i}),{}):i,c=Au(a,l);return{value:o==="array"?t:a,settings:le(le({},c),{},{format:o,keys:s,lock:r,locked:!1})}}function Tu(t){return{schema:T0(t.length),normalize:e=>{let{value:n}=e,r=ye(e,A0);return L0(n,r,t)},format:(e,n)=>R0(e,n),sanitize:(e,n,r)=>k0(e,n,r)}}var M0={grad:.9,turn:360,rad:360/(2*Math.PI)},ft=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},ke=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=Math.pow(10,e)),Math.round(n*t)/n+0},Ye=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),t>n?n:t>e?t:e},Ou=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},ba=function(t){return{r:Ye(t.r,0,255),g:Ye(t.g,0,255),b:Ye(t.b,0,255),a:Ye(t.a)}},Ii=function(t){return{r:ke(t.r),g:ke(t.g),b:ke(t.b),a:ke(t.a,3)}},D0=/^#([0-9a-f]{3,8})$/i,rr=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},ku=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,o=Math.max(e,n,r),s=o-Math.min(e,n,r),a=s?o===e?(n-r)/s:o===n?2+(r-e)/s:4+(e-n)/s:0;return{h:60*(a<0?a+6:a),s:o?s/o*100:0,v:o/255*100,a:i}},Ru=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var o=Math.floor(e),s=r*(1-n),a=r*(1-(e-o)*n),l=r*(1-(1-e+o)*n),c=o%6;return{r:255*[r,a,s,s,l,r][c],g:255*[l,r,r,a,s,s][c],b:255*[s,s,l,r,r,a][c],a:i}},xa=function(t){return{h:Ou(t.h),s:Ye(t.s,0,100),l:Ye(t.l,0,100),a:Ye(t.a)}},_a=function(t){return{h:ke(t.h),s:ke(t.s),l:ke(t.l),a:ke(t.a,3)}},wa=function(t){return Ru((n=(e=t).s,{h:e.h,s:(n*=((r=e.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:e.a}));var e,n,r},On=function(t){return{h:(e=ku(t)).h,s:(i=(200-(n=e.s))*(r=e.v)/100)>0&&i<200?n*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,n,r,i},z0=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,N0=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,$0=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,F0=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lo={string:[[function(t){var e=D0.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?ke(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?ke(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=$0.exec(t)||F0.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:ba({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=z0.exec(t)||N0.exec(t);if(!e)return null;var n,r,i=xa({h:(n=e[1],r=e[2],r===void 0&&(r="deg"),Number(n)*(M0[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return wa(i)},"hsl"]],object:[[function(t){var e=t.r,n=t.g,r=t.b,i=t.a,o=i===void 0?1:i;return ft(e)&&ft(n)&&ft(r)?ba({r:Number(e),g:Number(n),b:Number(r),a:Number(o)}):null},"rgb"],[function(t){var e=t.h,n=t.s,r=t.l,i=t.a,o=i===void 0?1:i;if(!ft(e)||!ft(n)||!ft(r))return null;var s=xa({h:Number(e),s:Number(n),l:Number(r),a:Number(o)});return wa(s)},"hsl"],[function(t){var e=t.h,n=t.s,r=t.v,i=t.a,o=i===void 0?1:i;if(!ft(e)||!ft(n)||!ft(r))return null;var s=function(a){return{h:Ou(a.h),s:Ye(a.s,0,100),v:Ye(a.v,0,100),a:Ye(a.a)}}({h:Number(e),s:Number(n),v:Number(r),a:Number(o)});return Ru(s)},"hsv"]]},Sa=function(t,e){for(var n=0;n<e.length;n++){var r=e[n][0](t);if(r)return[r,e[n][1]]}return[null,void 0]},Iu=function(t){return typeof t=="string"?Sa(t.trim(),lo.string):typeof t=="object"&&t!==null?Sa(t,lo.object):[null,void 0]},B0=function(t){return Iu(t)[1]},Li=function(t,e){var n=On(t);return{h:n.h,s:Ye(n.s+100*e,0,100),l:n.l,a:n.a}},Mi=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Ca=function(t,e){var n=On(t);return{h:n.h,s:n.s,l:Ye(n.l+100*e,0,100),a:n.a}},co=function(){function t(e){this.parsed=Iu(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return ke(Mi(this.rgba),2)},t.prototype.isDark=function(){return Mi(this.rgba)<.5},t.prototype.isLight=function(){return Mi(this.rgba)>=.5},t.prototype.toHex=function(){return e=Ii(this.rgba),n=e.r,r=e.g,i=e.b,s=(o=e.a)<1?rr(ke(255*o)):"","#"+rr(n)+rr(r)+rr(i)+s;var e,n,r,i,o,s},t.prototype.toRgb=function(){return Ii(this.rgba)},t.prototype.toRgbString=function(){return e=Ii(this.rgba),n=e.r,r=e.g,i=e.b,(o=e.a)<1?"rgba("+n+", "+r+", "+i+", "+o+")":"rgb("+n+", "+r+", "+i+")";var e,n,r,i,o},t.prototype.toHsl=function(){return _a(On(this.rgba))},t.prototype.toHslString=function(){return e=_a(On(this.rgba)),n=e.h,r=e.s,i=e.l,(o=e.a)<1?"hsla("+n+", "+r+"%, "+i+"%, "+o+")":"hsl("+n+", "+r+"%, "+i+"%)";var e,n,r,i,o},t.prototype.toHsv=function(){return e=ku(this.rgba),{h:ke(e.h),s:ke(e.s),v:ke(e.v),a:ke(e.a,3)};var e},t.prototype.invert=function(){return ze({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),ze(Li(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),ze(Li(this.rgba,-e))},t.prototype.grayscale=function(){return ze(Li(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),ze(Ca(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),ze(Ca(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?ze({r:(n=this.rgba).r,g:n.g,b:n.b,a:e}):ke(this.rgba.a,3);var n},t.prototype.hue=function(e){var n=On(this.rgba);return typeof e=="number"?ze({h:e,s:n.s,l:n.l,a:n.a}):ke(n.h)},t.prototype.isEqual=function(e){return this.toHex()===ze(e).toHex()},t}(),ze=function(t){return t instanceof co?t:new co(t)},Ea=[],j0=function(t){t.forEach(function(e){Ea.indexOf(e)<0&&(e(co,lo),Ea.push(e))})};function U0(t,e){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in n)r[n[i]]=i;var o={};t.prototype.toName=function(s){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,c=r[this.toHex()];if(c)return c;if(s!=null&&s.closest){var u=this.toRgb(),f=1/0,d="black";if(!o.length)for(var h in n)o[h]=new t(n[h]).toRgb();for(var g in n){var p=(a=u,l=o[g],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));p<f&&(f=p,d=g)}return d}},e.string.push([function(s){var a=s.toLowerCase(),l=a==="transparent"?"#0000":n[a];return l?new t(l).toRgb():null},"name"])}function mn(){return(mn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function ss(t,e){if(t==null)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)e.indexOf(n=o[r])>=0||(i[n]=t[n]);return i}function uo(t){var e=E.useRef(t),n=E.useRef(function(r){e.current&&e.current(r)});return e.current=t,n.current}var un=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=1),t>n?n:t<e?e:t},kn=function(t){return"touches"in t},fo=function(t){return t&&t.ownerDocument.defaultView||self},Pa=function(t,e,n){var r=t.getBoundingClientRect(),i=kn(e)?function(o,s){for(var a=0;a<o.length;a++)if(o[a].identifier===s)return o[a];return o[0]}(e.touches,n):e;return{left:un((i.pageX-(r.left+fo(t).pageXOffset))/r.width),top:un((i.pageY-(r.top+fo(t).pageYOffset))/r.height)}},Aa=function(t){!kn(t)&&t.preventDefault()},as=R.memo(function(t){var e=t.onMove,n=t.onKey,r=ss(t,["onMove","onKey"]),i=E.useRef(null),o=uo(e),s=uo(n),a=E.useRef(null),l=E.useRef(!1),c=E.useMemo(function(){var h=function(m){Aa(m),(kn(m)?m.touches.length>0:m.buttons>0)&&i.current?o(Pa(i.current,m,a.current)):p(!1)},g=function(){return p(!1)};function p(m){var y=l.current,b=fo(i.current),_=m?b.addEventListener:b.removeEventListener;_(y?"touchmove":"mousemove",h),_(y?"touchend":"mouseup",g)}return[function(m){var y=m.nativeEvent,b=i.current;if(b&&(Aa(y),!function(w,C){return C&&!kn(w)}(y,l.current)&&b)){if(kn(y)){l.current=!0;var _=y.changedTouches||[];_.length&&(a.current=_[0].identifier)}b.focus(),o(Pa(b,y,a.current)),p(!0)}},function(m){var y=m.which||m.keyCode;y<37||y>40||(m.preventDefault(),s({left:y===39?.05:y===37?-.05:0,top:y===40?.05:y===38?-.05:0}))},p]},[s,o]),u=c[0],f=c[1],d=c[2];return E.useEffect(function(){return d},[d]),R.createElement("div",mn({},r,{onTouchStart:u,onMouseDown:u,className:"react-colorful__interactive",ref:i,onKeyDown:f,tabIndex:0,role:"slider"}))}),Zn=function(t){return t.filter(Boolean).join(" ")},ls=function(t){var e=t.color,n=t.left,r=t.top,i=r===void 0?.5:r,o=Zn(["react-colorful__pointer",t.className]);return R.createElement("div",{className:o,style:{top:100*i+"%",left:100*n+"%"}},R.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},Fe=function(t,e,n){return e===void 0&&(e=0),n===void 0&&(n=Math.pow(10,e)),Math.round(n*t)/n},Lu=function(t){var e=t.s,n=t.v,r=t.a,i=(200-e)*n/100;return{h:Fe(t.h),s:Fe(i>0&&i<200?e*n/100/(i<=100?i:200-i)*100:0),l:Fe(i/2),a:Fe(r,2)}},ho=function(t){var e=Lu(t);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},Di=function(t){var e=Lu(t);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},Mu=function(t){var e=t.h,n=t.s,r=t.v,i=t.a;e=e/360*6,n/=100,r/=100;var o=Math.floor(e),s=r*(1-n),a=r*(1-(e-o)*n),l=r*(1-(1-e+o)*n),c=o%6;return{r:Fe(255*[r,a,s,s,l,r][c]),g:Fe(255*[l,r,r,a,s,s][c]),b:Fe(255*[s,s,l,r,r,a][c]),a:Fe(i,2)}},Du=function(t){var e=t.r,n=t.g,r=t.b,i=t.a,o=Math.max(e,n,r),s=o-Math.min(e,n,r),a=s?o===e?(n-r)/s:o===n?2+(r-e)/s:4+(e-n)/s:0;return{h:Fe(60*(a<0?a+6:a)),s:Fe(o?s/o*100:0),v:Fe(o/255*100),a:i}},zu=R.memo(function(t){var e=t.hue,n=t.onChange,r=Zn(["react-colorful__hue",t.className]);return R.createElement("div",{className:r},R.createElement(as,{onMove:function(i){n({h:360*i.left})},onKey:function(i){n({h:un(e+360*i.left,0,360)})},"aria-label":"Hue","aria-valuenow":Fe(e),"aria-valuemax":"360","aria-valuemin":"0"},R.createElement(ls,{className:"react-colorful__hue-pointer",left:e/360,color:ho({h:e,s:100,v:100,a:1})})))}),Nu=R.memo(function(t){var e=t.hsva,n=t.onChange,r={backgroundColor:ho({h:e.h,s:100,v:100,a:1})};return R.createElement("div",{className:"react-colorful__saturation",style:r},R.createElement(as,{onMove:function(i){n({s:100*i.left,v:100-100*i.top})},onKey:function(i){n({s:un(e.s+100*i.left,0,100),v:un(e.v-100*i.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Fe(e.s)+"%, Brightness "+Fe(e.v)+"%"},R.createElement(ls,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:ho(e)})))}),cs=function(t,e){if(t===e)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0};function $u(t,e,n){var r=uo(n),i=E.useState(function(){return t.toHsva(e)}),o=i[0],s=i[1],a=E.useRef({color:e,hsva:o});E.useEffect(function(){if(!t.equal(e,a.current.color)){var c=t.toHsva(e);a.current={hsva:c,color:e},s(c)}},[e,t]),E.useEffect(function(){var c;cs(o,a.current.hsva)||t.equal(c=t.fromHsva(o),a.current.color)||(a.current={hsva:o,color:c},r(c))},[o,t,r]);var l=E.useCallback(function(c){s(function(u){return Object.assign({},u,c)})},[]);return[o,l]}var W0=typeof window<"u"?E.useLayoutEffect:E.useEffect,V0=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},Ta=new Map,Fu=function(t){W0(function(){var e=t.current?t.current.ownerDocument:document;if(e!==void 0&&!Ta.has(e)){var n=e.createElement("style");n.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Ta.set(e,n);var r=V0();r&&n.setAttribute("nonce",r),e.head.appendChild(n)}},[])},H0=function(t){var e=t.className,n=t.colorModel,r=t.color,i=r===void 0?n.defaultColor:r,o=t.onChange,s=ss(t,["className","colorModel","color","onChange"]),a=E.useRef(null);Fu(a);var l=$u(n,i,o),c=l[0],u=l[1],f=Zn(["react-colorful",e]);return R.createElement("div",mn({},s,{ref:a,className:f}),R.createElement(Nu,{hsva:c,onChange:u}),R.createElement(zu,{hue:c.h,onChange:u,className:"react-colorful__last-control"}))},G0=function(t){var e=t.className,n=t.hsva,r=t.onChange,i={backgroundImage:"linear-gradient(90deg, "+Di(Object.assign({},n,{a:0}))+", "+Di(Object.assign({},n,{a:1}))+")"},o=Zn(["react-colorful__alpha",e]),s=Fe(100*n.a);return R.createElement("div",{className:o},R.createElement("div",{className:"react-colorful__alpha-gradient",style:i}),R.createElement(as,{onMove:function(a){r({a:a.left})},onKey:function(a){r({a:un(n.a+a.left)})},"aria-label":"Alpha","aria-valuetext":s+"%","aria-valuenow":s,"aria-valuemin":"0","aria-valuemax":"100"},R.createElement(ls,{className:"react-colorful__alpha-pointer",left:n.a,color:Di(n)})))},K0=function(t){var e=t.className,n=t.colorModel,r=t.color,i=r===void 0?n.defaultColor:r,o=t.onChange,s=ss(t,["className","colorModel","color","onChange"]),a=E.useRef(null);Fu(a);var l=$u(n,i,o),c=l[0],u=l[1],f=Zn(["react-colorful",e]);return R.createElement("div",mn({},s,{ref:a,className:f}),R.createElement(Nu,{hsva:c,onChange:u}),R.createElement(zu,{hue:c.h,onChange:u}),R.createElement(G0,{hsva:c,onChange:u,className:"react-colorful__last-control"}))},Z0={defaultColor:{r:0,g:0,b:0,a:1},toHsva:Du,fromHsva:Mu,equal:cs},Y0=function(t){return R.createElement(K0,mn({},t,{colorModel:Z0}))},q0={defaultColor:{r:0,g:0,b:0},toHsva:function(t){return Du({r:t.r,g:t.g,b:t.b,a:1})},fromHsva:function(t){return{r:(e=Mu(t)).r,g:e.g,b:e.b};var e},equal:cs},X0=function(t){return R.createElement(H0,mn({},t,{colorModel:q0}))},Bu={exports:{}},J0="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Q0=J0,ey=Q0;function ju(){}function Uu(){}Uu.resetWarningCache=ju;var ty=function(){function t(r,i,o,s,a,l){if(l!==ey){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Uu,resetWarningCache:ju};return n.PropTypes=n,n};Bu.exports=ty();var ny=Bu.exports;const xe=li(ny);function yn(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(f){s(f)}}function l(u){try{c(r.throw(u))}catch(f){s(f)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function vn(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function ry(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function iy(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ry(arguments[e]));return t}var oy=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Yn(t,e){var n=sy(t);if(typeof n.path!="string"){var r=t.webkitRelativePath;Object.defineProperty(n,"path",{value:typeof e=="string"?e:typeof r=="string"&&r.length>0?r:t.name,writable:!1,configurable:!1,enumerable:!0})}return n}function sy(t){var e=t.name,n=e&&e.lastIndexOf(".")!==-1;if(n&&!t.type){var r=e.split(".").pop().toLowerCase(),i=oy.get(r);i&&Object.defineProperty(t,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return t}var ay=[".DS_Store","Thumbs.db"];function ly(t){return yn(this,void 0,void 0,function(){return vn(this,function(e){return Mr(t)&&cy(t)?[2,hy(t.dataTransfer,t.type)]:uy(t)?[2,fy(t)]:Array.isArray(t)&&t.every(function(n){return"getFile"in n&&typeof n.getFile=="function"})?[2,dy(t)]:[2,[]]})})}function cy(t){return Mr(t.dataTransfer)}function uy(t){return Mr(t)&&Mr(t.target)}function Mr(t){return typeof t=="object"&&t!==null}function fy(t){return po(t.target.files).map(function(e){return Yn(e)})}function dy(t){return yn(this,void 0,void 0,function(){var e;return vn(this,function(n){switch(n.label){case 0:return[4,Promise.all(t.map(function(r){return r.getFile()}))];case 1:return e=n.sent(),[2,e.map(function(r){return Yn(r)})]}})})}function hy(t,e){return yn(this,void 0,void 0,function(){var n,r;return vn(this,function(i){switch(i.label){case 0:return t===null?[2,[]]:t.items?(n=po(t.items).filter(function(o){return o.kind==="file"}),e!=="drop"?[2,n]:[4,Promise.all(n.map(py))]):[3,2];case 1:return r=i.sent(),[2,Oa(Wu(r))];case 2:return[2,Oa(po(t.files).map(function(o){return Yn(o)}))]}})})}function Oa(t){return t.filter(function(e){return ay.indexOf(e.name)===-1})}function po(t){if(t===null)return[];for(var e=[],n=0;n<t.length;n++){var r=t[n];e.push(r)}return e}function py(t){if(typeof t.webkitGetAsEntry!="function")return ka(t);var e=t.webkitGetAsEntry();return e&&e.isDirectory?Vu(e):ka(t)}function Wu(t){return t.reduce(function(e,n){return iy(e,Array.isArray(n)?Wu(n):[n])},[])}function ka(t){var e=t.getAsFile();if(!e)return Promise.reject(t+" is not a File");var n=Yn(e);return Promise.resolve(n)}function gy(t){return yn(this,void 0,void 0,function(){return vn(this,function(e){return[2,t.isDirectory?Vu(t):my(t)]})})}function Vu(t){var e=t.createReader();return new Promise(function(n,r){var i=[];function o(){var s=this;e.readEntries(function(a){return yn(s,void 0,void 0,function(){var l,c,u;return vn(this,function(f){switch(f.label){case 0:if(a.length)return[3,5];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return l=f.sent(),n(l),[3,4];case 3:return c=f.sent(),r(c),[3,4];case 4:return[3,6];case 5:u=Promise.all(a.map(gy)),i.push(u),o(),f.label=6;case 6:return[2]}})})},function(a){r(a)})}o()})}function my(t){return yn(this,void 0,void 0,function(){return vn(this,function(e){return[2,new Promise(function(n,r){t.file(function(i){var o=Yn(i,t.fullPath);n(o)},function(i){r(i)})})]})})}var yy=function(t,e){if(t&&e){var n=Array.isArray(e)?e:e.split(","),r=t.name||"",i=(t.type||"").toLowerCase(),o=i.replace(/\/.*$/,"");return n.some(function(s){var a=s.trim().toLowerCase();return a.charAt(0)==="."?r.toLowerCase().endsWith(a):a.endsWith("/*")?o===a.replace(/\/.*$/,""):i===a})}return!0};function Ra(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ia(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ra(Object(n),!0).forEach(function(r){Hu(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Hu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function La(t,e){return _y(t)||xy(t,e)||by(t,e)||vy()}function vy(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function by(t,e){if(t){if(typeof t=="string")return Ma(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ma(t,e)}}function Ma(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function xy(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],i=!0,o=!1,s,a;try{for(n=n.call(t);!(i=(s=n.next()).done)&&(r.push(s.value),!(e&&r.length===e));i=!0);}catch(l){o=!0,a=l}finally{try{!i&&n.return!=null&&n.return()}finally{if(o)throw a}}return r}}function _y(t){if(Array.isArray(t))return t}var wy="file-invalid-type",Sy="file-too-large",Cy="file-too-small",Ey="too-many-files",Py=function(e){e=Array.isArray(e)&&e.length===1?e[0]:e;var n=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:wy,message:"File type must be ".concat(n)}},Da=function(e){return{code:Sy,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},za=function(e){return{code:Cy,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},Ay={code:Ey,message:"Too many files"};function Gu(t,e){var n=t.type==="application/x-moz-file"||yy(t,e);return[n,n?null:Py(e)]}function Ku(t,e,n){if(wn(t.size))if(wn(e)&&wn(n)){if(t.size>n)return[!1,Da(n)];if(t.size<e)return[!1,za(e)]}else{if(wn(e)&&t.size<e)return[!1,za(e)];if(wn(n)&&t.size>n)return[!1,Da(n)]}return[!0,null]}function wn(t){return t!=null}function Ty(t){var e=t.files,n=t.accept,r=t.minSize,i=t.maxSize,o=t.multiple,s=t.maxFiles;return!o&&e.length>1||o&&s>=1&&e.length>s?!1:e.every(function(a){var l=Gu(a,n),c=La(l,1),u=c[0],f=Ku(a,r,i),d=La(f,1),h=d[0];return u&&h})}function Dr(t){return typeof t.isPropagationStopped=="function"?t.isPropagationStopped():typeof t.cancelBubble<"u"?t.cancelBubble:!1}function ir(t){return t.dataTransfer?Array.prototype.some.call(t.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!t.target&&!!t.target.files}function Na(t){t.preventDefault()}function Oy(t){return t.indexOf("MSIE")!==-1||t.indexOf("Trident/")!==-1}function ky(t){return t.indexOf("Edge/")!==-1}function Ry(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return Oy(t)||ky(t)}function it(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];return e.some(function(a){return!Dr(r)&&a&&a.apply(void 0,[r].concat(o)),Dr(r)})}}function Iy(){return"showOpenFilePicker"in window}function Ly(t){return t=typeof t=="string"?t.split(","):t,[{description:"everything",accept:Array.isArray(t)?t.filter(function(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}).reduce(function(e,n){return Ia(Ia({},e),{},Hu({},n,[]))},{}):{}}]}function My(t){return t instanceof DOMException&&(t.name==="AbortError"||t.code===t.ABORT_ERR)}function Dy(t){return t instanceof DOMException&&(t.name==="SecurityError"||t.code===t.SECURITY_ERR)}var zy=["children"],Ny=["open"],$y=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],Fy=["refKey","onChange","onClick"];function By(t){return Wy(t)||Uy(t)||Zu(t)||jy()}function jy(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uy(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wy(t){if(Array.isArray(t))return go(t)}function zi(t,e){return Gy(t)||Hy(t,e)||Zu(t,e)||Vy()}function Vy(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zu(t,e){if(t){if(typeof t=="string")return go(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return go(t,e)}}function go(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Hy(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],i=!0,o=!1,s,a;try{for(n=n.call(t);!(i=(s=n.next()).done)&&(r.push(s.value),!(e&&r.length===e));i=!0);}catch(l){o=!0,a=l}finally{try{!i&&n.return!=null&&n.return()}finally{if(o)throw a}}return r}}function Gy(t){if(Array.isArray(t))return t}function $a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ce(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$a(Object(n),!0).forEach(function(r){mo(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$a(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function mo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zr(t,e){if(t==null)return{};var n=Ky(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Ky(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}var us=E.forwardRef(function(t,e){var n=t.children,r=zr(t,zy),i=qu(r),o=i.open,s=zr(i,Ny);return E.useImperativeHandle(e,function(){return{open:o}},[o]),R.createElement(E.Fragment,null,n(Ce(Ce({},s),{},{open:o})))});us.displayName="Dropzone";var Yu={disabled:!1,getFilesFromEvent:ly,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};us.defaultProps=Yu;us.propTypes={children:xe.func,accept:xe.oneOfType([xe.string,xe.arrayOf(xe.string)]),multiple:xe.bool,preventDropOnDocument:xe.bool,noClick:xe.bool,noKeyboard:xe.bool,noDrag:xe.bool,noDragEventsBubbling:xe.bool,minSize:xe.number,maxSize:xe.number,maxFiles:xe.number,disabled:xe.bool,getFilesFromEvent:xe.func,onFileDialogCancel:xe.func,onFileDialogOpen:xe.func,useFsAccessApi:xe.bool,onDragEnter:xe.func,onDragLeave:xe.func,onDragOver:xe.func,onDrop:xe.func,onDropAccepted:xe.func,onDropRejected:xe.func,validator:xe.func};var yo={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function qu(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=Ce(Ce({},Yu),t),n=e.accept,r=e.disabled,i=e.getFilesFromEvent,o=e.maxSize,s=e.minSize,a=e.multiple,l=e.maxFiles,c=e.onDragEnter,u=e.onDragLeave,f=e.onDragOver,d=e.onDrop,h=e.onDropAccepted,g=e.onDropRejected,p=e.onFileDialogCancel,m=e.onFileDialogOpen,y=e.useFsAccessApi,b=e.preventDropOnDocument,_=e.noClick,w=e.noKeyboard,C=e.noDrag,O=e.noDragEventsBubbling,T=e.validator,I=E.useMemo(function(){return typeof m=="function"?m:Fa},[m]),k=E.useMemo(function(){return typeof p=="function"?p:Fa},[p]),M=E.useRef(null),j=E.useRef(null),S=E.useReducer(Zy,yo),L=zi(S,2),x=L[0],z=L[1],q=x.isFocused,W=x.isFileDialogActive,X=x.draggedFiles,V=E.useRef(typeof window<"u"&&window.isSecureContext&&y&&Iy()),te=function(){!V.current&&W&&setTimeout(function(){if(j.current){var G=j.current.files;G.length||(z({type:"closeDialog"}),k())}},300)};E.useEffect(function(){return window.addEventListener("focus",te,!1),function(){window.removeEventListener("focus",te,!1)}},[j,W,k,V]);var N=E.useRef([]),$=function(G){M.current&&M.current.contains(G.target)||(G.preventDefault(),N.current=[])};E.useEffect(function(){return b&&(document.addEventListener("dragover",Na,!1),document.addEventListener("drop",$,!1)),function(){b&&(document.removeEventListener("dragover",Na),document.removeEventListener("drop",$))}},[M,b]);var ee=E.useCallback(function(F){F.preventDefault(),F.persist(),U(F),N.current=[].concat(By(N.current),[F.target]),ir(F)&&Promise.resolve(i(F)).then(function(G){Dr(F)&&!O||(z({draggedFiles:G,isDragActive:!0,type:"setDraggedFiles"}),c&&c(F))})},[i,c,O]),Q=E.useCallback(function(F){F.preventDefault(),F.persist(),U(F);var G=ir(F);if(G&&F.dataTransfer)try{F.dataTransfer.dropEffect="copy"}catch{}return G&&f&&f(F),!1},[f,O]),J=E.useCallback(function(F){F.preventDefault(),F.persist(),U(F);var G=N.current.filter(function(ne){return M.current&&M.current.contains(ne)}),Y=G.indexOf(F.target);Y!==-1&&G.splice(Y,1),N.current=G,!(G.length>0)&&(z({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),ir(F)&&u&&u(F))},[M,u,O]),ge=E.useCallback(function(F,G){var Y=[],ne=[];F.forEach(function(fe){var ue=Gu(fe,n),Oe=zi(ue,2),ct=Oe[0],je=Oe[1],ut=Ku(fe,s,o),be=zi(ut,2),Ct=be[0],Dt=be[1],Ve=T?T(fe):null;if(ct&&Ct&&!Ve)Y.push(fe);else{var Zt=[je,Dt];Ve&&(Zt=Zt.concat(Ve)),ne.push({file:fe,errors:Zt.filter(function(Ci){return Ci})})}}),(!a&&Y.length>1||a&&l>=1&&Y.length>l)&&(Y.forEach(function(fe){ne.push({file:fe,errors:[Ay]})}),Y.splice(0)),z({acceptedFiles:Y,fileRejections:ne,type:"setFiles"}),d&&d(Y,ne,G),ne.length>0&&g&&g(ne,G),Y.length>0&&h&&h(Y,G)},[z,a,n,s,o,l,d,h,g,T]),_e=E.useCallback(function(F){F.preventDefault(),F.persist(),U(F),N.current=[],ir(F)&&Promise.resolve(i(F)).then(function(G){Dr(F)&&!O||ge(G,F)}),z({type:"reset"})},[i,ge,O]),ce=E.useCallback(function(){if(V.current){z({type:"openDialog"}),I();var F={multiple:a,types:Ly(n)};window.showOpenFilePicker(F).then(function(G){return i(G)}).then(function(G){ge(G,null),z({type:"closeDialog"})}).catch(function(G){My(G)?(k(G),z({type:"closeDialog"})):Dy(G)&&(V.current=!1,j.current&&(j.current.value=null,j.current.click()))});return}j.current&&(z({type:"openDialog"}),I(),j.current.value=null,j.current.click())},[z,I,k,y,ge,n,a]),he=E.useCallback(function(F){!M.current||!M.current.isEqualNode(F.target)||(F.key===" "||F.key==="Enter"||F.keyCode===32||F.keyCode===13)&&(F.preventDefault(),ce())},[M,ce]),we=E.useCallback(function(){z({type:"focus"})},[]),ve=E.useCallback(function(){z({type:"blur"})},[]),Re=E.useCallback(function(){_||(Ry()?setTimeout(ce,0):ce())},[_,ce]),Se=function(G){return r?null:G},v=function(G){return w?null:Se(G)},H=function(G){return C?null:Se(G)},U=function(G){O&&G.stopPropagation()},A=E.useMemo(function(){return function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},G=F.refKey,Y=G===void 0?"ref":G,ne=F.role,fe=F.onKeyDown,ue=F.onFocus,Oe=F.onBlur,ct=F.onClick,je=F.onDragEnter,ut=F.onDragOver,be=F.onDragLeave,Ct=F.onDrop,Dt=zr(F,$y);return Ce(Ce(mo({onKeyDown:v(it(fe,he)),onFocus:v(it(ue,we)),onBlur:v(it(Oe,ve)),onClick:Se(it(ct,Re)),onDragEnter:H(it(je,ee)),onDragOver:H(it(ut,Q)),onDragLeave:H(it(be,J)),onDrop:H(it(Ct,_e)),role:typeof ne=="string"&&ne!==""?ne:"button"},Y,M),!r&&!w?{tabIndex:0}:{}),Dt)}},[M,he,we,ve,Re,ee,Q,J,_e,w,C,r]),P=E.useCallback(function(F){F.stopPropagation()},[]),D=E.useMemo(function(){return function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},G=F.refKey,Y=G===void 0?"ref":G,ne=F.onChange,fe=F.onClick,ue=zr(F,Fy),Oe=mo({accept:n,multiple:a,type:"file",style:{display:"none"},onChange:Se(it(ne,_e)),onClick:Se(it(fe,P)),tabIndex:-1},Y,j);return Ce(Ce({},Oe),ue)}},[j,n,a,_e,r]),K=X.length,Z=K>0&&Ty({files:X,accept:n,minSize:s,maxSize:o,multiple:a,maxFiles:l}),B=K>0&&!Z;return Ce(Ce({},x),{},{isDragAccept:Z,isDragReject:B,isFocused:q&&!r,getRootProps:A,getInputProps:D,rootRef:M,inputRef:j,open:Se(ce)})}function Zy(t,e){switch(e.type){case"focus":return Ce(Ce({},t),{},{isFocused:!0});case"blur":return Ce(Ce({},t),{},{isFocused:!1});case"openDialog":return Ce(Ce({},yo),{},{isFileDialogActive:!0});case"closeDialog":return Ce(Ce({},t),{},{isFileDialogActive:!1});case"setDraggedFiles":var n=e.isDragActive,r=e.draggedFiles;return Ce(Ce({},t),{},{draggedFiles:r,isDragActive:n});case"setFiles":return Ce(Ce({},t),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections});case"reset":return Ce({},yo);default:return t}}function Fa(){}function Yy(t){let e;const n=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(f!==e){const d=e;e=u?f:Object.assign({},e,f),n.forEach(h=>h(e,d))}},i=()=>e,o=(c,u=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=u(e);function h(){const g=u(e);if(!f(d,g)){const p=d;c(d=g,p)}}return n.add(h),()=>n.delete(h)},l={setState:r,getState:i,subscribe:(c,u,f)=>u||f?o(c,u,f):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(r,i,l),l}const qy=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Ba=qy?E.useEffect:E.useLayoutEffect;function Xy(t){const e=typeof t=="function"?Yy(t):t,n=(r=e.getState,i=Object.is)=>{const[,o]=E.useReducer(m=>m+1,0),s=e.getState(),a=E.useRef(s),l=E.useRef(r),c=E.useRef(i),u=E.useRef(!1),f=E.useRef();f.current===void 0&&(f.current=r(s));let d,h=!1;(a.current!==s||l.current!==r||c.current!==i||u.current)&&(d=r(s),h=!i(f.current,d)),Ba(()=>{h&&(f.current=d),a.current=s,l.current=r,c.current=i,u.current=!1});const g=E.useRef(s);Ba(()=>{const m=()=>{try{const b=e.getState(),_=l.current(b);c.current(f.current,_)||(a.current=b,f.current=_,o())}catch{u.current=!0,o()}},y=e.subscribe(m);return e.getState()!==g.current&&m(),y},[]);const p=h?d:f.current;return E.useDebugValue(p),p};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}const Jy=t=>(e,n,r)=>{const i=r.subscribe;return r.subscribe=(s,a,l)=>{let c=s;if(a){const u=(l==null?void 0:l.equalityFn)||Object.is;let f=s(r.getState());c=d=>{const h=s(d);if(!u(f,h)){const g=f;a(f=h,g)}},l!=null&&l.fireImmediately&&a(f,f)}return i(c)},t(e,n,r)};/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var Qy=function(e){return e!=null&&typeof e=="object"&&Array.isArray(e)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var ev=Qy;function ja(t){return ev(t)===!0&&Object.prototype.toString.call(t)==="[object Object]"}var Xu=function(e){var n,r;return!(ja(e)===!1||(n=e.constructor,typeof n!="function")||(r=n.prototype,ja(r)===!1)||r.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var tv=Xu,fs=function(e){return tv(e)||typeof e=="function"||Array.isArray(e)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var nv=function(e,n,r){for(var i in e)if(n.call(r,e[i],i,e)===!1)break},rv=fs,iv=nv;function Ju(t,e){for(var n=arguments.length,r=0;++r<n;){var i=arguments[r];vo(i)&&iv(i,ov,t)}return t}function ov(t,e){if(sv(e)){var n=this[e];vo(t)&&vo(n)?Ju(n,t):this[e]=t}}function vo(t){return rv(t)&&!Array.isArray(t)}function sv(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}var av=Ju;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var lv=function(t,e,n,r,i){if(!cv(t)||!e)return t;if(e=or(e),n&&(e+="."+or(n)),r&&(e+="."+or(r)),i&&(e+="."+or(i)),e in t)return t[e];for(var o=e.split("."),s=o.length,a=-1;t&&++a<s;){for(var l=o[a];l[l.length-1]==="\\";)l=l.slice(0,-1)+"."+o[++a];t=t[l]}return t};function cv(t){return t!==null&&(typeof t=="object"||typeof t=="function")}function or(t){return t?Array.isArray(t)?t.join("."):t:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var uv=function(t,e){if(t===null||typeof t>"u")throw new TypeError("expected first argument to be an object.");if(typeof e>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return t;for(var n=Object.prototype.propertyIsEnumerable,r=Object(t),i=arguments.length,o=0;++o<i;)for(var s=Object(arguments[o]),a=Object.getOwnPropertySymbols(s),l=0;l<a.length;l++){var c=a[l];n.call(s,c)&&(r[c]=s[c])}return r},fv=fs,dv=uv,hv=Object.assign||function(t){if(t===null||typeof t>"u")throw new TypeError("Cannot convert undefined or null to object");Ua(t)||(t={});for(var e=1;e<arguments.length;e++){var n=arguments[e];gv(n)&&(n=mv(n)),Ua(n)&&(pv(t,n),dv(t,n))}return t};function pv(t,e){for(var n in e)yv(e,n)&&(t[n]=e[n])}function gv(t){return t&&typeof t=="string"}function mv(t){var e={};for(var n in t)e[n]=t[n];return e}function Ua(t){return t&&typeof t=="object"||fv(t)}function yv(t,e){return Object.prototype.hasOwnProperty.call(t,e)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var vv=hv,bv=function(t,e,n){if(typeof t!="string")throw new TypeError("expected a string");typeof e=="function"&&(n=e,e=null),typeof e=="string"&&(e={sep:e});var r=vv({sep:"."},e),i=r.quotes||['"',"'","`"],o;r.brackets===!0?o={"<":">","(":")","[":"]","{":"}"}:r.brackets&&(o=r.brackets);var s=[],a=[],l=[""],c=r.sep,u=t.length,f=-1,d;function h(){if(o&&a.length)return o[a[a.length-1]]}for(;++f<u;){var g=t[f],p=t[f+1],m={val:g,idx:f,arr:l,str:t};if(s.push(m),g==="\\"){m.val=_v(r,t,f)===!0?g+p:p,m.escaped=!0,typeof n=="function"&&n(m),l[l.length-1]+=m.val,f++;continue}if(o&&o[g]){a.push(g);var y=h(),b=f+1;if(t.indexOf(y,b+1)!==-1)for(;a.length&&b<u;){var _=t[++b];if(_==="\\"){_++;continue}if(i.indexOf(_)!==-1){b=bo(t,_,b+1);continue}if(y=h(),a.length&&t.indexOf(y,b+1)===-1)break;if(o[_]){a.push(_);continue}y===_&&a.pop()}if(d=b,d===-1){l[l.length-1]+=g;continue}g=t.slice(f,d+1),m.val=g,m.idx=f=d}if(i.indexOf(g)!==-1){if(d=bo(t,g,f+1),d===-1){l[l.length-1]+=g;continue}xv(g,r)===!0?g=t.slice(f,d+1):g=t.slice(f+1,d),m.val=g,m.idx=f=d}if(typeof n=="function"&&(n(m,s),g=m.val,f=m.idx),m.val===c&&m.split!==!1){l.push("");continue}l[l.length-1]+=m.val}return l};function bo(t,e,n,r){var i=t.indexOf(e,n);return t.charAt(i-1)==="\\"?bo(t,e,i+1):i}function xv(t,e){return e.keepDoubleQuotes===!0&&t==='"'||e.keepSingleQuotes===!0&&t==="'"?!0:e.keepQuotes}function _v(t,e,n){return typeof t.keepEscaping=="function"?t.keepEscaping(e,n):t.keepEscaping===!0||e[n+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var wv=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")},Wa=wv,Sv=function(e){Wa(e)||(e={});for(var n=arguments.length,r=1;r<n;r++){var i=arguments[r];Wa(i)&&Cv(e,i)}return e};function Cv(t,e){for(var n in e)Ev(e,n)&&(t[n]=e[n])}function Ev(t,e){return Object.prototype.hasOwnProperty.call(t,e)}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var Pv=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")};/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var Av=bv,Tv=Sv,Va=Xu,Ha=Pv,Ov=function(t,e,n){if(!Ha(t)||(Array.isArray(e)&&(e=[].concat.apply([],e).join(".")),typeof e!="string"))return t;for(var r=Av(e,{sep:".",brackets:!0}).filter(kv),i=r.length,o=-1,s=t;++o<i;){var a=r[o];if(o!==i-1){Ha(s[a])||(s[a]={}),s=s[a];continue}Va(s[a])&&Va(n)?s[a]=Tv({},s[a],n):s[a]=n}return t};function kv(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}var Ni=fs,Ga=av,Rv=lv,Ka=Ov,Iv=function(e,n,r){if(!Ni(e))throw new TypeError("expected an object");if(typeof n!="string"||r==null)return Ga.apply(null,arguments);if(typeof r=="string")return Ka(e,n,r),e;var i=Rv(e,n);return Ni(r)&&Ni(i)&&(r=Ga({},i,r)),Ka(e,n,r),e};const Lv=li(Iv),ds=(...t)=>t.filter(Boolean).join(".");function Mv(t){const e=t.split(".");return[e.pop(),e.join(".")||void 0]}function Dv(t,e){return Object.entries(im(t,e)).reduce((n,[,{value:r,disabled:i,key:o}])=>(n[o]=i?void 0:r,n),{})}function zv(t,e){const n=E.useRef();return In(t,n.current)||(n.current=t),n.current}function Qu(t,e){return E.useMemo(t,zv(e))}function Nv(t){const e=E.useRef(null),n=E.useRef(null),r=E.useRef(!0);return E.useLayoutEffect(()=>{t||(e.current.style.height="0px",e.current.style.overflow="hidden")},[]),E.useEffect(()=>{if(r.current){r.current=!1;return}let i;const o=e.current,s=()=>{t&&(o.style.removeProperty("height"),o.style.removeProperty("overflow"),n.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};o.addEventListener("transitionend",s,{once:!0});const{height:a}=n.current.getBoundingClientRect();return o.style.height=a+"px",t||(o.style.overflow="hidden",i=window.setTimeout(()=>o.style.height="0px",50)),()=>{o.removeEventListener("transitionend",s),clearTimeout(i)}},[t]),{wrapperRef:e,contentRef:n}}const $v=t=>{const[e,n]=E.useState(t.getVisiblePaths());return E.useEffect(()=>{n(t.getVisiblePaths());const r=t.useStore.subscribe(t.getVisiblePaths,n,{equalityFn:fi});return()=>r()},[t]),e};function Fv(t,e,n){return t.useStore(i=>{const o=le(le({},n),i.data);return Dv(o,e)},fi)}function ef(t=3){const e=E.useRef(null),n=E.useRef(null),[r,i]=E.useState(!1),o=E.useCallback(()=>i(!0),[]),s=E.useCallback(()=>i(!1),[]);return E.useLayoutEffect(()=>{if(r){const{bottom:a,top:l,left:c}=e.current.getBoundingClientRect(),{height:u}=n.current.getBoundingClientRect(),f=a+u>window.innerHeight-40?"up":"down";n.current.style.position="fixed",n.current.style.zIndex="10000",n.current.style.left=c+"px",f==="down"?n.current.style.top=a+t+"px":n.current.style.bottom=window.innerHeight-l+t+"px"}},[t,r]),{popinRef:e,wrapperRef:n,shown:r,show:o,hide:s}}j0([U0]);const Bv={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};We.extend({color:()=>t=>ze(t).isValid()});const jv=t=>We().color().test(t);function tf(t,{format:e,hasAlpha:n,isString:r}){const i=Bv[e]+(r&&e!=="hex"?"String":""),o=t[i]();return typeof o=="object"&&!n?om(o,["a"]):o}const nf=(t,e)=>{const n=ze(t);if(!n.isValid())throw Error("Invalid color");return tf(n,e)},Uv=(t,e)=>tf(ze(t),le(le({},e),{},{isString:!0,format:"hex"})),Wv=({value:t})=>{const e=B0(t),n=e==="name"?"hex":e,r=typeof t=="object"?"a"in t:e==="hex"&&t.length===8||/^(rgba)|(hsla)|(hsva)/.test(t),i={format:n,hasAlpha:r,isString:typeof t=="string"};return{value:nf(t,i),settings:i}};var Vv=Object.freeze({__proto__:null,schema:jv,sanitize:nf,format:Uv,normalize:Wv});const Hv=ae("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),Gv=ae("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),Kv=ae("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function Za(t,e){return e!=="rgb"?ze(t).toRgb():t}function Zv({value:t,displayValue:e,settings:n,onUpdate:r}){const{emitOnEditStart:i,emitOnEditEnd:o}=Me(),{format:s,hasAlpha:a}=n,{popinRef:l,wrapperRef:c,shown:u,show:f,hide:d}=ef(),h=E.useRef(0),[g,p]=E.useState(()=>Za(t,s)),m=a?Y0:X0,y=()=>{p(Za(t,s)),f(),i()},b=()=>{d(),o(),window.clearTimeout(h.current)},_=()=>{h.current=window.setTimeout(b,500)};return E.useEffect(()=>()=>window.clearTimeout(h.current),[]),R.createElement(R.Fragment,null,R.createElement(Hv,{ref:l,active:u,onClick:()=>y(),style:{color:e}}),u&&R.createElement(rs,null,R.createElement(xu,{onPointerUp:b}),R.createElement(Kv,{ref:c,onMouseEnter:()=>window.clearTimeout(h.current),onMouseLeave:w=>w.buttons===0&&_()},R.createElement(m,{color:g,onChange:r}))))}function Yv(){const{value:t,displayValue:e,label:n,onChange:r,onUpdate:i,settings:o}=Me();return R.createElement(qe,{input:!0},R.createElement(rt,null,n),R.createElement(Gv,null,R.createElement(Zv,{value:t,displayValue:e,onChange:r,onUpdate:i,settings:o}),R.createElement(ns,{value:e,onChange:r,onUpdate:i})))}var qv=le({component:Yv},Vv);function Xv(){const{label:t,displayValue:e,onUpdate:n,settings:r}=Me();return R.createElement(qe,{input:!0},R.createElement(rt,null,t),R.createElement(os,{value:e,settings:r,onUpdate:n}))}var Jv=le({component:Xv},Tu(["x","y","z"]));const Qv=ae("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),eb=ae("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function tb({value:t,settings:e,onUpdate:n}){const r=E.useRef(),i=E.useRef(0),o=E.useRef(0),s=E.useRef(1),[a,l]=E.useState(!1),[c,u]=E.useState(!1),[f,d]=wu(),h=E.useRef(null),g=E.useRef(null);E.useLayoutEffect(()=>{if(a){const{top:S,left:L,width:x,height:z}=h.current.getBoundingClientRect();g.current.style.left=L+x/2+"px",g.current.style.top=S+z/2+"px"}},[a]);const{keys:[p,m],joystick:y}=e,b=y==="invertY"?1:-1,{[p]:{step:_},[m]:{step:w}}=e,C=yt("sizes","joystickWidth"),O=yt("sizes","joystickHeight"),T=parseFloat(C)*.8/2,I=parseFloat(O)*.8/2,k=E.useCallback(()=>{r.current||(u(!0),i.current&&d({x:i.current*T}),o.current&&d({y:o.current*-I}),r.current=window.setInterval(()=>{n(S=>{const L=_*i.current*s.current,x=b*w*o.current*s.current;return Array.isArray(S)?{[p]:S[0]+L,[m]:S[1]+x}:{[p]:S[p]+L,[m]:S[m]+x}})},16))},[T,I,n,d,_,w,p,m,b]),M=E.useCallback(()=>{window.clearTimeout(r.current),r.current=void 0,u(!1)},[]);E.useEffect(()=>{function S(L){s.current=su(L)}return window.addEventListener("keydown",S),window.addEventListener("keyup",S),()=>{window.clearTimeout(r.current),window.removeEventListener("keydown",S),window.removeEventListener("keyup",S)}},[]);const j=Kn(({first:S,active:L,delta:[x,z],movement:[q,W]})=>{S&&l(!0);const X=Rt(q,-T,T),V=Rt(W,-I,I);i.current=Math.abs(q)>Math.abs(X)?Math.sign(q-X):0,o.current=Math.abs(W)>Math.abs(V)?Math.sign(V-W):0;let te=t[p],N=t[m];L?(i.current||(te+=x*_*s.current,d({x:X})),o.current||(N-=b*z*w*s.current,d({y:V})),i.current||o.current?k():M(),n({[p]:te,[m]:N})):(l(!1),i.current=0,o.current=0,d({x:0,y:0}),M())});return R.createElement(Qv,Te({ref:h},j()),a&&R.createElement(rs,null,R.createElement(eb,{ref:g,isOutOfBounds:c},R.createElement("div",null),R.createElement("span",{ref:f}))))}const nb=ae("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function rb(){const{label:t,displayValue:e,onUpdate:n,settings:r}=Me();return R.createElement(qe,{input:!0},R.createElement(rt,null,t),R.createElement(nb,{withJoystick:!!r.joystick},r.joystick&&R.createElement(tb,{value:e,settings:r,onUpdate:n}),R.createElement(os,{value:e,settings:r,onUpdate:n})))}const ib=["joystick"],rf=Tu(["x","y"]),ob=t=>{let{joystick:e=!0}=t,n=ye(t,ib);const{value:r,settings:i}=rf.normalize(n);return{value:r,settings:le(le({},i),{},{joystick:e})}};var sb=le(le({component:rb},rf),{},{normalize:ob});const ab=t=>{if(t!==void 0){if(t instanceof File)try{return URL.createObjectURL(t)}catch{return}if(typeof t=="string"&&t.indexOf("blob:")===0)return t;throw Error("Invalid image format [undefined | blob |File].")}},lb=(t,e)=>typeof e=="object"&&"image"in e,cb=({image:t})=>({value:t});var ub=Object.freeze({__proto__:null,sanitize:ab,schema:lb,normalize:cb});const fb=ae("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),db=ae("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),hb=ae("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),pb=ae("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),gb=ae("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),mb=ae("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function yb(){const{label:t,value:e,onUpdate:n,disabled:r}=Me(),{popinRef:i,wrapperRef:o,shown:s,show:a,hide:l}=ef(),c=E.useCallback(g=>{g.length&&n(g[0])},[n]),u=E.useCallback(g=>{g.stopPropagation(),n(void 0)},[n]),{getRootProps:f,getInputProps:d,isDragAccept:h}=qu({maxFiles:1,accept:"image/*",onDrop:c,disabled:r});return R.createElement(qe,{input:!0},R.createElement(rt,null,t),R.createElement(fb,null,R.createElement(hb,{ref:i,hasImage:!!e,onPointerDown:()=>!!e&&a(),onPointerUp:l,style:{backgroundImage:e?`url(${e})`:"none"}}),s&&!!e&&R.createElement(rs,null,R.createElement(xu,{onPointerUp:l,style:{cursor:"pointer"}}),R.createElement(pb,{ref:o,style:{backgroundImage:`url(${e})`}})),R.createElement(db,f({isDragAccept:h}),R.createElement("input",d()),R.createElement(gb,null,h?"drop image":"click or drop")),R.createElement(mb,{onClick:u,disabled:!e})))}var vb=le({component:yb},ub);const Ya=We().number(),bb=(t,e)=>We().array().length(2).every.number().test(t)&&We().schema({min:Ya,max:Ya}).test(e),Nr=t=>({min:t[0],max:t[1]}),of=(t,{bounds:[e,n]},r)=>{const i=Array.isArray(t)?Nr(t):t,o={min:r[0],max:r[1]},{min:s,max:a}=le(le({},o),i);return[Rt(Number(s),e,Math.max(e,a)),Rt(Number(a),Math.min(n,s),n)]},xb=({value:t,min:e,max:n})=>{const r={min:e,max:n},i=Au(Nr(t),{min:r,max:r}),o=[e,n],s=le(le({},i),{},{bounds:o});return{value:of(Nr(t),s,t),settings:s}};var _b=Object.freeze({__proto__:null,schema:bb,format:Nr,sanitize:of,normalize:xb});const wb=["value","bounds","onDrag"],Sb=["bounds"],Cb=ae("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function Eb(t){let{value:e,bounds:[n,r],onDrag:i}=t,o=ye(t,wb);const s=E.useRef(null),a=E.useRef(null),l=E.useRef(null),c=E.useRef(0),u=yt("sizes","scrubberWidth"),f=Kn(({event:g,first:p,xy:[m],movement:[y],memo:b={}})=>{if(p){const{width:w,left:C}=s.current.getBoundingClientRect();c.current=w-parseFloat(u);const O=(g==null?void 0:g.target)===a.current||(g==null?void 0:g.target)===l.current;b.pos=Ir((m-C)/w,n,r);const T=Math.abs(b.pos-e.min)-Math.abs(b.pos-e.max);b.key=T<0||T===0&&b.pos<=e.min?"min":"max",O&&(b.pos=e[b.key])}const _=b.pos+Ir(y/c.current,0,r-n);return i({[b.key]:Km(_,o[b.key])}),b}),d=`calc(${Rr(e.min,n,r)} * (100% - ${u} - 8px) + 4px)`,h=`calc(${1-Rr(e.max,n,r)} * (100% - ${u} - 8px) + 4px)`;return R.createElement(Cu,Te({ref:s},f()),R.createElement(Su,null,R.createElement(Eu,{style:{left:d,right:h}})),R.createElement(so,{position:"left",ref:a,style:{left:d}}),R.createElement(so,{position:"right",ref:l,style:{right:h}}))}function Pb(){const{label:t,displayValue:e,onUpdate:n,settings:r}=Me(),i=ye(r,Sb);return R.createElement(R.Fragment,null,R.createElement(qe,{input:!0},R.createElement(rt,null,t),R.createElement(Cb,null,R.createElement(Eb,Te({value:e},r,{onDrag:n})),R.createElement(os,{value:e,settings:i,onUpdate:n,innerLabelTrim:0}))))}var Ab=le({component:Pb},_b);const Tb=()=>{const t=new Map;return{on:(e,n)=>{let r=t.get(e);r===void 0&&(r=new Set,t.set(e,r)),r.add(n)},off:(e,n)=>{const r=t.get(e);r!==void 0&&(r.delete(n),r.size===0&&t.delete(e))},emit:(e,...n)=>{const r=t.get(e);if(r!==void 0)for(const i of r)i(...n)}}},Ob=["type","value"],kb=["onChange","transient","onEditStart","onEditEnd"],Rb=function(){const e=Xy(Jy(()=>({data:{}}))),n=Tb();this.storeId=rm(),this.useStore=e;const r={},i=new Set;this.getVisiblePaths=()=>{const s=this.getData(),a=Object.keys(s),l=[];Object.entries(r).forEach(([u,f])=>{f.render&&a.some(d=>d.indexOf(u)===0)&&!f.render(this.get)&&l.push(u+".")});const c=[];return i.forEach(u=>{u in s&&s[u].__refCount>0&&l.every(f=>u.indexOf(f)===-1)&&(!s[u].render||s[u].render(this.get))&&c.push(u)}),c},this.setOrderedPaths=s=>{s.forEach(a=>i.add(a))},this.orderPaths=s=>(this.setOrderedPaths(s),s),this.disposePaths=s=>{e.setState(a=>{const l=a.data;return s.forEach(c=>{if(c in l){const u=l[c];u.__refCount--,u.__refCount===0&&u.type in Qe&&delete l[c]}}),{data:l}})},this.dispose=()=>{e.setState(()=>({data:{}}))},this.getFolderSettings=s=>r[s]||{},this.getData=()=>e.getState().data,this.addData=(s,a)=>{e.setState(l=>{const c=l.data;return Object.entries(s).forEach(([u,f])=>{let d=c[u];if(d){const{type:h,value:g}=f,p=ye(f,Ob);h!==d.type?pt(Ee.INPUT_TYPE_OVERRIDE,h):((d.__refCount===0||a)&&Object.assign(d,p),d.__refCount++)}else c[u]=le(le({},f),{},{__refCount:1})}),{data:c}})},this.setValueAtPath=(s,a,l)=>{e.setState(c=>{const u=c.data;return va(u[s],a,s,this,l),{data:u}})},this.setSettingsAtPath=(s,a)=>{e.setState(l=>{const c=l.data;return c[s].settings=le(le({},c[s].settings),a),{data:c}})},this.disableInputAtPath=(s,a)=>{e.setState(l=>{const c=l.data;return c[s].disabled=a,{data:c}})},this.set=(s,a)=>{e.setState(l=>{const c=l.data;return Object.entries(s).forEach(([u,f])=>{try{va(c[u],f,void 0,void 0,a)}catch{}}),{data:c}})},this.getInput=s=>{try{return this.getData()[s]}catch{pt(Ee.PATH_DOESNT_EXIST,s)}},this.get=s=>{var a;return(a=this.getInput(s))===null||a===void 0?void 0:a.value},this.emitOnEditStart=s=>{n.emit(`onEditStart:${s}`,this.get(s),s,le(le({},this.getInput(s)),{},{get:this.get}))},this.emitOnEditEnd=s=>{n.emit(`onEditEnd:${s}`,this.get(s),s,le(le({},this.getInput(s)),{},{get:this.get}))},this.subscribeToEditStart=(s,a)=>{const l=`onEditStart:${s}`;return n.on(l,a),()=>n.off(l,a)},this.subscribeToEditEnd=(s,a)=>{const l=`onEditEnd:${s}`;return n.on(l,a),()=>n.off(l,a)};const o=(s,a,l)=>{const c={};return Object.entries(s).forEach(([u,f])=>{if(u==="")return pt(Ee.EMPTY_KEY);let d=ds(a,u);if(f.type===Qe.FOLDER){const h=o(f.schema,d,l);Object.assign(c,h),d in r||(r[d]=f.settings)}else if(u in l)pt(Ee.DUPLICATE_KEYS,u,d,l[u].path);else{const h=fm(f,u,d,c);if(h){const{type:g,options:p,input:m}=h,{onChange:y,transient:b,onEditStart:_,onEditEnd:w}=p,C=ye(p,kb);c[d]=le(le(le({type:g},C),m),{},{fromPanel:!0}),l[u]={path:d,onChange:y,transient:b,onEditStart:_,onEditEnd:w}}else pt(Ee.UNKNOWN_INPUT,d,f)}}),c};this.getDataFromSchema=s=>{const a={};return[o(s,"",a),a]}},sf=new Rb,Ib={collapsed:!1};function Lb(t,e){return{type:Qe.FOLDER,schema:t,settings:le(le({},Ib),e)}}const qa=t=>"__levaInput"in t,Mb=(t,e)=>{const n={},r=e?e.toLowerCase():null;return t.forEach(i=>{const[o,s]=Mv(i);(!r||o.toLowerCase().indexOf(r)>-1)&&Lv(n,s,{[o]:{__levaInput:!0,path:i}})}),n},Db=["type","label","path","valueKey","value","settings","setValue","disabled"];function zb(t){let{type:e,label:n,path:r,valueKey:i,value:o,settings:s,setValue:a,disabled:l}=t,c=ye(t,Db);const{displayValue:u,onChange:f,onUpdate:d}=_u({type:e,value:o,settings:s,setValue:a}),h=Vt[e].component;return h?R.createElement(fu.Provider,{value:le({key:i,path:r,id:""+r,label:n,displayValue:u,value:o,onChange:f,onUpdate:d,settings:s,setValue:a,disabled:l},c)},R.createElement(Rm,{disabled:l},R.createElement(h,null))):(pt(Ee.NO_COMPONENT_FOR_TYPE,e,r),null)}const Nb=ae("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function $b({onClick:t,settings:e,label:n}){const r=Gn();return R.createElement(qe,null,R.createElement(Nb,{disabled:e.disabled,onClick:()=>t(r.get)},n))}const Fb=ae("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),Bb=ae("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),jb=({label:t,opts:e})=>{let n=typeof t=="string"&&t.trim()===""?null:t,r=e;return typeof e.opts=="object"&&(r.label!==void 0&&(n=e.label),r=e.opts),{label:n,opts:r}};function Ub(t){const{label:e,opts:n}=jb(t),r=Gn();return R.createElement(qe,{input:!!e},e&&R.createElement(rt,null,e),R.createElement(Fb,null,Object.entries(n).map(([i,o])=>R.createElement(Bb,{key:i,onClick:()=>o(r.get)},i))))}const Wb=ae("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),af=100;function Vb(t,e){t.push(e),t.length>af&&t.shift()}const Hb=E.forwardRef(function({initialValue:t},e){const n=yt("colors","highlight3"),r=yt("colors","elevation2"),i=yt("colors","highlight1"),[o,s]=E.useMemo(()=>[ze(i).alpha(.4).toRgbString(),ze(i).alpha(.1).toRgbString()],[i]),a=E.useRef([t]),l=E.useRef(t),c=E.useRef(t),u=E.useRef(),f=E.useCallback((g,p)=>{if(!g)return;const{width:m,height:y}=g,b=new Path2D,_=m/af,w=y*.05;for(let T=0;T<a.current.length;T++){const I=Rr(a.current[T],l.current,c.current),k=_*T,M=y-I*(y-w*2)-w;b.lineTo(k,M)}p.clearRect(0,0,m,y);const C=new Path2D(b);C.lineTo(_*(a.current.length+1),y),C.lineTo(0,y),C.lineTo(0,0);const O=p.createLinearGradient(0,0,0,y);O.addColorStop(0,o),O.addColorStop(1,s),p.fillStyle=O,p.fill(C),p.strokeStyle=r,p.lineJoin="round",p.lineWidth=14,p.stroke(b),p.strokeStyle=n,p.lineWidth=2,p.stroke(b)},[n,r,o,s]),[d,h]=Bm(f);return E.useImperativeHandle(e,()=>({frame:g=>{(l.current===void 0||g<l.current)&&(l.current=g),(c.current===void 0||g>c.current)&&(c.current=g),Vb(a.current,g),u.current=requestAnimationFrame(()=>f(d.current,h.current))}}),[d,h,f]),E.useEffect(()=>()=>cancelAnimationFrame(u.current),[]),R.createElement(Wb,{ref:d})}),Xa=t=>Number.isFinite(t)?t.toPrecision(2):t.toString(),Gb=E.forwardRef(function({initialValue:t},e){const[n,r]=E.useState(Xa(t));return E.useImperativeHandle(e,()=>({frame:i=>r(Xa(i))}),[]),R.createElement("div",null,n)});function Ja(t){return typeof t=="function"?t():t.current}function Kb({label:t,objectOrFn:e,settings:n}){const r=E.useRef(),i=E.useRef(Ja(e));return E.useEffect(()=>{const o=window.setInterval(()=>{var s;document.hidden||(s=r.current)===null||s===void 0||s.frame(Ja(e))},n.interval);return()=>window.clearInterval(o)},[e,n.interval]),R.createElement(qe,{input:!0},R.createElement(rt,{align:"top"},t),n.graph?R.createElement(Hb,{ref:r,initialValue:i.current}):R.createElement(Gb,{ref:r,initialValue:i.current}))}const Zb=["type","label","key"],Yb={[Qe.BUTTON]:$b,[Qe.BUTTON_GROUP]:Ub,[Qe.MONITOR]:Kb},qb=R.memo(({path:t})=>{const[e,{set:n,setSettings:r,disable:i,storeId:o,emitOnEditStart:s,emitOnEditEnd:a}]=Um(t);if(!e)return null;const{type:l,label:c,key:u}=e,f=ye(e,Zb);if(l in Qe){const d=Yb[l];return R.createElement(d,Te({label:c,path:t},f))}return l in Vt?R.createElement(zb,Te({key:o+t,type:l,label:c,storeId:o,path:t,valueKey:u,setValue:n,setSettings:r,disable:i,emitOnEditStart:s,emitOnEditEnd:a},f)):(Yg(Ee.UNSUPPORTED_INPUT,l,t),null)});function Xb({toggle:t,toggled:e,name:n}){return R.createElement(Tm,{onClick:()=>t()},R.createElement(is,{toggled:e}),R.createElement("div",null,n))}const Jb=({name:t,path:e,tree:n})=>{const r=Gn(),i=ds(e,t),{collapsed:o,color:s}=r.getFolderSettings(i),[a,l]=E.useState(!o),c=E.useRef(null),u=yt("colors","folderWidgetColor"),f=yt("colors","folderTextColor");return E.useLayoutEffect(()=>{c.current.style.setProperty("--leva-colors-folderWidgetColor",s||u),c.current.style.setProperty("--leva-colors-folderTextColor",s||f)},[s,u,f]),R.createElement(Lr,{ref:c},R.createElement(Xb,{name:t,toggled:a,toggle:()=>l(d=>!d)}),R.createElement(lf,{parent:i,tree:n,toggled:a}))},lf=R.memo(({isRoot:t=!1,fill:e=!1,flat:n=!1,parent:r,tree:i,toggled:o})=>{const{wrapperRef:s,contentRef:a}=Nv(o),l=Gn(),c=([f,d])=>{var h;return(qa(d)?(h=l.getInput(d.path))===null||h===void 0?void 0:h.order:l.getFolderSettings(ds(r,f)).order)||0},u=Object.entries(i).sort((f,d)=>c(f)-c(d));return R.createElement(io,{ref:s,isRoot:t,fill:e,flat:n},R.createElement(yu,{ref:a,isRoot:t,toggled:o},u.map(([f,d])=>qa(d)?R.createElement(qb,{key:d.path,valueKey:d.valueKey,path:d.path}):R.createElement(Jb,{key:f,name:f,path:r,tree:d}))))}),Qb=ae("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${bu}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),cf=40,$r=ae("i",{$flexCenter:"",width:cf,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),e1=ae("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),t1=ae("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${$r}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),n1=ae("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),r1=ae("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:cf}}}}),i1=R.forwardRef(({setFilter:t,toggle:e},n)=>{const[r,i]=E.useState(""),o=E.useMemo(()=>ou(t,250),[t]),s=()=>{t(""),i("")},a=l=>{const c=l.currentTarget.value;e(!0),i(c)};return E.useEffect(()=>{o(r)},[r,o]),R.createElement(R.Fragment,null,R.createElement(n1,{ref:n,value:r,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:l=>l.stopPropagation(),onChange:a}),R.createElement($r,{onClick:()=>s(),style:{visibility:r?"visible":"hidden"}},R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},R.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function o1({setFilter:t,onDrag:e,onDragStart:n,onDragEnd:r,toggle:i,toggled:o,title:s,drag:a,filterEnabled:l,from:c}){const[u,f]=E.useState(!1),d=E.useRef(null);E.useEffect(()=>{var g,p;u?(g=d.current)===null||g===void 0||g.focus():(p=d.current)===null||p===void 0||p.blur()},[u]);const h=Kn(({offset:[g,p],first:m,last:y})=>{e({x:g,y:p}),m&&n({x:g,y:p}),y&&r({x:g,y:p})},{filterTaps:!0,from:({offset:[g,p]})=>[(c==null?void 0:c.x)||g,(c==null?void 0:c.y)||p]});return E.useEffect(()=>{const g=p=>{p.key==="L"&&p.shiftKey&&p.metaKey&&f(m=>!m)};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[]),R.createElement(R.Fragment,null,R.createElement(e1,{mode:a?"drag":void 0},R.createElement($r,{active:!o,onClick:()=>i()},R.createElement(is,{toggled:o,width:12,height:8})),R.createElement(r1,Te({},a?h():{},{drag:a,filterEnabled:l}),s===void 0&&a?R.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},R.createElement("circle",{cx:"2",cy:"2",r:"2"}),R.createElement("circle",{cx:"14",cy:"2",r:"2"}),R.createElement("circle",{cx:"26",cy:"2",r:"2"}),R.createElement("circle",{cx:"2",cy:"12",r:"2"}),R.createElement("circle",{cx:"14",cy:"12",r:"2"}),R.createElement("circle",{cx:"26",cy:"12",r:"2"})):s),l&&R.createElement($r,{active:u,onClick:()=>f(g=>!g)},R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},R.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),R.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),R.createElement(t1,{toggled:u},R.createElement(i1,{ref:d,setFilter:t,toggle:i})))}const s1=["store","hidden","theme","collapsed"];function a1(t){let{store:e,hidden:n=!1,theme:r,collapsed:i=!1}=t,o=ye(t,s1);const s=Qu(()=>wm(r),[r]),[a,l]=E.useState(!i),c=typeof i=="object"?!i.collapsed:a,u=E.useMemo(()=>typeof i=="object"?f=>{typeof f=="function"?i.onChange(!f(!i.collapsed)):i.onChange(!f)}:l,[i]);return!e||n?null:R.createElement(ts.Provider,{value:s},R.createElement(l1,Te({store:e},o,{toggled:c,setToggle:u,rootClass:s.className})))}const l1=R.memo(({store:t,rootClass:e,fill:n=!1,flat:r=!1,neverHide:i=!1,oneLineLabels:o=!1,titleBar:s={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:a=!1,toggled:l,setToggle:c})=>{var u,f;const d=$v(t),[h,g]=E.useState(""),p=E.useMemo(()=>Mb(d,h),[d,h]),[m,y]=wu(),b=i||d.length>0,_=typeof s=="object"&&s.title||void 0,w=typeof s=="object"&&(u=s.drag)!==null&&u!==void 0?u:!0,C=typeof s=="object"&&(f=s.filter)!==null&&f!==void 0?f:!0,O=typeof s=="object"&&s.position||void 0,T=typeof s=="object"&&s.onDrag||void 0,I=typeof s=="object"&&s.onDragStart||void 0,k=typeof s=="object"&&s.onDragEnd||void 0;return R.useEffect(()=>{y({x:O==null?void 0:O.x,y:O==null?void 0:O.y})},[O,y]),_m(),R.createElement(hu.Provider,{value:{hideCopyButton:a}},R.createElement(Qb,{ref:m,className:e,fill:n,flat:r,oneLineLabels:o,hideTitleBar:!s,style:{display:b?"block":"none"}},s&&R.createElement(o1,{onDrag:M=>{y(M),T==null||T(M)},onDragStart:M=>I==null?void 0:I(M),onDragEnd:M=>k==null?void 0:k(M),setFilter:g,toggle:M=>c(j=>M??!j),toggled:l,title:_,drag:w,filterEnabled:C,from:O}),b&&R.createElement(du.Provider,{value:t},R.createElement(lf,{isRoot:!0,fill:n,flat:r,tree:p,toggled:l}))))}),c1=["isRoot"];let Fr=!1,zt=null;function u1(t){let{isRoot:e=!1}=t,n=ye(t,c1);return E.useEffect(()=>(Fr=!0,!e&&zt&&(zt.remove(),zt=null),()=>{e||(Fr=!1)}),[e]),R.createElement(a1,Te({store:sf},n))}function f1(t){E.useEffect(()=>{t&&!Fr&&(zt||(zt=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(zt),hm(R.createElement(u1,{isRoot:!0}),zt))),Fr=!0)},[t])}function d1(t,e,n,r,i){let o,s,a,l,c;return s=t,o=e,Array.isArray(n)&&(c=n),{schema:o,folderName:s,folderSettings:a,hookSettings:l,deps:c||[]}}function h1(t,e,n,r,i){const{folderName:o,schema:s,folderSettings:a,hookSettings:l,deps:c}=d1(t,e,n),u=typeof s=="function",f=E.useRef(!1),d=E.useRef(!0),h=Qu(()=>{f.current=!0;const j=typeof s=="function"?s():s;return o?{[o]:Lb(j,a)}:j},c),g=!(l!=null&&l.store);f1(g);const[p]=E.useState(()=>(l==null?void 0:l.store)||sf),[m,y]=E.useMemo(()=>p.getDataFromSchema(h),[p,h]),[b,_,w,C,O]=E.useMemo(()=>{const j=[],S=[],L={},x={},z={};return Object.values(y).forEach(({path:q,onChange:W,onEditStart:X,onEditEnd:V,transient:te})=>{j.push(q),W?(L[q]=W,te||S.push(q)):S.push(q),X&&(x[q]=X),V&&(z[q]=V)}),[j,S,L,x,z]},[y]),T=E.useMemo(()=>p.orderPaths(b),[b,p]),I=Fv(p,_,m),k=E.useCallback(j=>{const S=Object.entries(j).reduce((L,[x,z])=>Object.assign(L,{[y[x].path]:z}),{});p.set(S,!1)},[p,y]),M=E.useCallback(j=>p.get(y[j].path),[p,y]);return E.useEffect(()=>{const j=!d.current&&f.current;return p.addData(m,j),d.current=!1,f.current=!1,()=>p.disposePaths(T)},[p,T,m]),E.useEffect(()=>{const j=[];return Object.entries(w).forEach(([S,L])=>{L(p.get(S),S,le({initial:!0,get:p.get},p.getInput(S)));const x=p.useStore.subscribe(z=>{const q=z.data[S];return[q.disabled?void 0:q.value,q]},([z,q])=>L(z,S,le({initial:!1,get:p.get},q)),{equalityFn:fi});j.push(x)}),()=>j.forEach(S=>S())},[p,w]),E.useEffect(()=>{const j=[];return Object.entries(C).forEach(([S,L])=>j.push(p.subscribeToEditStart(S,L))),Object.entries(O).forEach(([S,L])=>j.push(p.subscribeToEditEnd(S,L))),()=>j.forEach(S=>S())},[C,O,p]),u?[I,k,M]:I}St(nt.SELECT,o0);St(nt.IMAGE,vb);St(nt.NUMBER,Ym);St(nt.COLOR,qv);St(nt.STRING,p0);St(nt.BOOLEAN,_0);St(nt.INTERVAL,Ab);St(nt.VECTOR3D,Jv);St(nt.VECTOR2D,sb);const p1=new Uint32Array([0,2,1,0,3,2]),g1=new Float32Array([0,1,0,0,1,0,1,1]);function m1(t,e){if(!e)return y1(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,s=(i-1)*(o-1)*6,a=new Uint32Array(s),l=new Float32Array(i*o*2),c=new Float64Array(i*o*3);let u=0,f=0;for(let d=0;d<i;d++){const h=d/(i-1);for(let g=0;g<o;g++){const p=g/(o-1),m=v1(t,h,p);c[u*3+0]=m[0],c[u*3+1]=m[1],c[u*3+2]=m[2]||0,l[u*2+0]=h,l[u*2+1]=1-p,d>0&&g>0&&(a[f++]=u-o,a[f++]=u-o-1,a[f++]=u-1,a[f++]=u-o,a[f++]=u-1,a[f++]=u),u++}}return{vertexCount:s,positions:c,indices:a,texCoords:l}}function y1(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:p1,texCoords:g1}}function v1(t,e,n){return Ei(Ei(t[0],t[1],n),Ei(t[3],t[2],n),e)}const b1=`#version 300 es
#define SHADER_NAME bitmap-layer-vertex-shader

in vec2 texCoords;
in vec3 positions;
in vec3 positions64Low;

out vec2 vTexCoord;
out vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,x1=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,_1=`#version 300 es
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

in vec2 vTexCoord;
in vec2 vTexPos;

out vec4 fragColor;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

${x1}

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture(bitmapTexture, uv);

  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(fragColor, geometry);

  if (bool(picking.isActive) && !bool(picking.isAttribute)) {
    // Since instance information is not used, we can use picking color for pixel index
    fragColor.rgb = packUVsIntoRGB(uv);
  }
}
`,w1={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:gt.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}},Zr=class Zr extends It{getShaders(){return super.getShaders({vs:b1,fs:_1,modules:[Lt,Gt]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){var o;const i=this.getAttributeManager();if(r.extensionsChanged&&((o=this.state.model)==null||o.destroy(),this.state.model=this._getModel(),i.invalidateAll()),e.bounds!==n.bounds){const s=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const l in a)s&&s[l]!==a[l]&&i.invalidate(l);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:o}=n;r.index=0;const s=S1(r.color);return r.bitmap={size:{width:i,height:o},uv:s,pixel:[Math.floor(s[0]*i),Math.floor(s[1]*o)]},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return Qa(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),m1(n,this.context.viewport.resolution)}_getModel(){return new Je(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1})}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:o,bounds:s,disablePicking:a}=this.state,{image:l,desaturate:c,transparentColor:u,tintColor:f}=this.props;r.picking.isActive&&a||l&&i&&(i.setUniforms(n),i.setBindings({bitmapTexture:l}),i.setUniforms({desaturate:c,transparentColor:u.map(d=>d/255),tintColor:f.slice(0,3).map(d=>d/255),coordinateConversion:o,bounds:s}),i.draw(this.context.renderPass))}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=gt;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:o}=this.props;if(!Qa(o))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const s=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&s===n)return{coordinateConversion:-1,bounds:o};if(i===n&&s===e){const a=Cr([o[0],o[1]]),l=Cr([o[2],o[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],l[0],l[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}};Zr.layerName="BitmapLayer",Zr.defaultProps=w1;let xo=Zr;function S1(t){const[e,n,r]=t,i=(r&240)/256,o=(r&15)/16;return[(e+o)/256,(n+i)/256]}function Qa(t){return Number.isFinite(t[0])}const C1=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`,E1=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * opacity * vColor.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,P1=1024,A1=4,el=()=>{},tl={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},T1={x:0,y:0,width:0,height:0};function O1(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function k1(t,e,n,r){const i=Math.min(n/e.width,r/e.height),o=Math.floor(e.width*i),s=Math.floor(e.height*i);return i===1?{data:e,width:o,height:s}:(t.canvas.height=s,t.canvas.width=o,t.clearRect(0,0,o,s),t.drawImage(e,0,0,e.width,e.height,0,0,o,s),{data:t.canvas,width:o,height:s})}function zn(t){return t&&(t.id||t.url)}function R1(t,e,n,r){const{width:i,height:o,device:s}=t,a=s.createTexture({format:"rgba8unorm",width:e,height:n,sampler:r}),l=s.createCommandEncoder();return l.copyTextureToTexture({source:t,destination:a,width:i,height:o}),l.finish(),t.destroy(),a}function nl(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:o}=e[r],s=zn(i);t[s]={...i,x:o,y:n}}}function I1({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let l=0;l<t.length;l++){const c=t[l],u=zn(c);if(!n[u]){const{height:f,width:d}=c;r+d+e>s&&(nl(n,a,i),r=0,i=o+i+e,o=0,a=[]),a.push({icon:c,xOffset:r}),r=r+d+e,o=Math.max(o,f)}}return a.length>0&&nl(n,a,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:s,canvasHeight:O1(o+i+e)}}function L1(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:o}=Wo(t);for(const s of i){o.index++;const a=e(s,o),l=zn(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[l]&&(!n[l]||a.url!==n[l].url)&&(r[l]={...a,source:s,sourceIndex:o.index})}return r}class M1{constructor(e,{onUpdate:n=el,onError:r=el}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._textureParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=A1,this._canvasWidth=P1,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)==null||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?zn(e):e;return this._mapping[n]||T1}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:o}){var s;e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r&&((s=this._texture)==null||s.delete(),this._texture=null,this._externalTexture=r),o&&(this._textureParameters=o)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(L1(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:o,yOffset:s,rowHeight:a,canvasHeight:l}=I1({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=o,this._yOffset=s,this._canvasHeight=l,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._textureParameters||tl})),this._texture.height!==this._canvasHeight&&(this._texture=R1(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||tl)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,Jl(r.url,this._loadOptions).then(i=>{const o=zn(r),s=this._mapping[o],{x:a,y:l,width:c,height:u}=s,{data:f,width:d,height:h}=k1(n,i,c,u);this._texture.setSubImageData({data:f,x:a+(c-d)/2,y:l+(u-h)/2,width:d,height:h}),s.width=d,s.height=h,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const uf=[0,0,0,255],D1={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:uf},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}},Yr=class Yr extends It{getShaders(){return super.getShaders({vs:C1,fs:E1,modules:[Lt,Gt]})}initializeState(){this.state={iconManager:new M1(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:uf},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){var h;super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,o=this.getAttributeManager(),{iconAtlas:s,iconMapping:a,data:l,getIcon:c,textureParameters:u}=n,{iconManager:f}=this.state;if(typeof s=="string")return;const d=s||this.internalState.isAsyncPropLoading("iconAtlas");f.setProps({loadOptions:n.loadOptions,autoPacking:!d,iconAtlas:s,iconMapping:d?a:null,textureParameters:u}),d?r.iconMapping!==n.iconMapping&&o.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&f.packIcons(l,c),i.extensionsChanged&&((h=this.state.model)==null||h.destroy(),this.state.model=this._getModel(),o.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:o,billboard:s,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();if(c){const u=this.state.model;u.setBindings({iconsTexture:c}),u.setUniforms(e),u.setUniforms({iconsTextureDim:[c.width,c.height],sizeUnits:Bt[o],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:s,alphaCutoff:a}),u.draw(this.context.renderPass)}}_getModel(){const e=[-1,-1,1,-1,-1,1,1,1];return new Je(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new jt({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var r;const n=(r=this.getCurrentLayer())==null?void 0:r.props.onIconError;n?n(e):Be.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:o=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-o]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:o}=this.state.iconManager.getIconMapping(e);return[n,r,i,o]}};Yr.defaultProps=D1,Yr.layerName="IconLayer";let Br=Yr;const z1=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
radiusMinPixels, radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
lineWidthMinPixels, lineWidthMaxPixels
);
outerRadiusPixels += stroked * lineWidthPixels / 2.0;
float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
if (billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,N1=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
uniform bool filled;
uniform float stroked;
uniform bool antialiasing;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (stroked > 0.5) {
float isLine = antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (filled) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (!filled) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,rl=[0,0,0,255],$1={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:rl},getLineColor:{type:"accessor",value:rl},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},qr=class qr extends It{getShaders(){return super.getShaders({vs:z1,fs:N1,modules:[Lt,Gt]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var n;super.updateState(e),e.changeFlags.extensionsChanged&&((n=this.state.model)==null||n.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,stroked:s,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:f,lineWidthMinPixels:d,lineWidthMaxPixels:h}=this.props,g=this.state.model;g.setUniforms(e),g.setUniforms({stroked:s?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:Bt[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,lineWidthUnits:Bt[u],lineWidthScale:f,lineWidthMinPixels:d,lineWidthMaxPixels:h}),g.draw(this.context.renderPass)}_getModel(){const e=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new Je(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new jt({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(e)}}}),isInstanced:!0})}};qr.defaultProps=$1,qr.layerName="ScatterplotLayer";let jr=qr;const hs={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function ps(t,e,n={}){return F1(t,n)!==e?(j1(t,n),!0):!1}function F1(t,e={}){return Math.sign(B1(t,e))}const il={x:0,y:1,z:2};function B1(t,e={}){const{start:n=0,end:r=t.length,plane:i="xy"}=e,o=e.size||2;let s=0;const a=il[i[0]],l=il[i[1]];for(let c=n,u=r-o;c<r;c+=o)s+=(t[c+a]-t[u+a])*(t[c+l]+t[u+l]),u=c;return s/2}function j1(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,s=Math.floor(o/2);for(let a=0;a<s;++a){const l=n+a*i,c=n+(o-1-a)*i;for(let u=0;u<i;++u){const f=t[l+u];t[l+u]=t[c+u],t[c+u]=f}}}function Xe(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function _o(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Nn(t,e,n,r,i=[]){const o=r+e*n;for(let s=0;s<n;s++)i[s]=t[o+s];return i}function wo(t,e,n,r,i=[]){let o,s;if(n&8)o=(r[3]-t[1])/(e[1]-t[1]),s=3;else if(n&4)o=(r[1]-t[1])/(e[1]-t[1]),s=1;else if(n&2)o=(r[2]-t[0])/(e[0]-t[0]),s=2;else if(n&1)o=(r[0]-t[0])/(e[0]-t[0]),s=0;else return null;for(let a=0;a<t.length;a++)i[a]=(s&1)===a?r[s]:o*(e[a]-t[a])+t[a];return i}function xr(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function ff(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e||{},l=(a-s)/n;let c=[];const u=[c],f=Nn(t,0,n,s);let d,h;const g=hf(f,i,o,[]),p=[];Xe(c,f);for(let m=1;m<l;m++){for(d=Nn(t,m,n,s,d),h=xr(d,g);h;){wo(f,d,h,g,p);const y=xr(p,g);y&&(wo(f,p,y,g,p),h=y),Xe(c,p),_o(f,p),W1(g,i,h),r&&c.length>n&&(c=[],u.push(c),Xe(c,f)),h=xr(d,g)}Xe(c,d),_o(f,d)}return r?u:u[0]}const ol=0,U1=1;function df(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},a=[],l=[{pos:t,types:s?new Array(t.length/r).fill(U1):null,holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:f,types:d,holes:h}=l.shift();V1(f,r,h[0]||f.length,c),u=hf(c[0],i,o,u);const g=xr(c[1],u);if(g){let p=sl(f,d,r,0,h[0]||f.length,u,g);const m={pos:p[0].pos,types:p[0].types,holes:[]},y={pos:p[1].pos,types:p[1].types,holes:[]};l.push(m,y);for(let b=0;b<h.length;b++)p=sl(f,d,r,h[b],h[b+1]||f.length,u,g),p[0]&&(m.holes.push(m.pos.length),m.pos=sr(m.pos,p[0].pos),s&&(m.types=sr(m.types,p[0].types))),p[1]&&(y.holes.push(y.pos.length),y.pos=sr(y.pos,p[1].pos),s&&(y.types=sr(y.types,p[1].types)))}else{const p={positions:f};s&&(p.edgeTypes=d),h.length&&(p.holeIndices=h),a.push(p)}}return a}function sl(t,e,n,r,i,o,s){const a=(i-r)/n,l=[],c=[],u=[],f=[],d=[];let h,g,p;const m=Nn(t,a-1,n,r);let y=Math.sign(s&8?m[1]-o[3]:m[0]-o[2]),b=e&&e[a-1],_=0,w=0;for(let C=0;C<a;C++)h=Nn(t,C,n,r,h),g=Math.sign(s&8?h[1]-o[3]:h[0]-o[2]),p=e&&e[r/n+C],g&&y&&y!==g&&(wo(m,h,s,o,d),Xe(l,d)&&u.push(b),Xe(c,d)&&f.push(b)),g<=0?(Xe(l,h)&&u.push(p),_-=g):u.length&&(u[u.length-1]=ol),g>=0?(Xe(c,h)&&f.push(p),w+=g):f.length&&(f[f.length-1]=ol),_o(m,h),y=g,b=p;return[_?{pos:l,types:e&&u}:null,w?{pos:c,types:e&&f}:null]}function hf(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function W1(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function V1(t,e,n,r){let i=1/0,o=-1/0,s=1/0,a=-1/0;for(let l=0;l<n;l+=e){const c=t[l],u=t[l+1];i=c<i?c:i,o=c>o?c:o,s=u<s?u:s,a=u>a?u:a}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=a,r}function sr(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}const H1=85.051129;function G1(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e||{},s=t.slice(r,i);pf(s,n,0,i-r);const a=ff(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const l of a)gf(l,n);return a}function K1(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n||{};e=e||[];const s=[],a=[];let l=0,c=0;for(let f=0;f<=e.length;f++){const d=e[f]||t.length,h=c,g=Z1(t,r,l,d);for(let p=g;p<d;p++)s[c++]=t[p];for(let p=l;p<g;p++)s[c++]=t[p];pf(s,r,h,c),Y1(s,r,h,c,n==null?void 0:n.maxLatitude),l=d,a[f]=c}a.pop();const u=df(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const f of u)gf(f.positions,r);return u}function Z1(t,e,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=e){const a=Math.abs(t[s]);a>i&&(i=a,o=s-1)}return o}function Y1(t,e,n,r,i=H1){const o=t[n],s=t[r-e];if(Math.abs(o-s)>180){const a=Nn(t,0,e,n);a[0]+=Math.round((s-o)/360)*360,Xe(t,a),a[1]=Math.sign(a[1])*i,Xe(t,a),a[0]=o,Xe(t,a)}}function pf(t,e,n,r){let i=t[0],o;for(let s=n;s<r;s+=e){o=t[s];const a=o-i;(a>180||a<-180)&&(o-=Math.round(a/360)*360),t[s]=i=o}}function gf(t,e){let n;const r=t.length/e;for(let o=0;o<r&&(n=t[o*e],(n+180)%360===0);o++);const i=-Math.round(n/360)*360;if(i!==0)for(let o=0;o<r;o++)t[o*e]+=i}class q1 extends jt{constructor(e){const{indices:n,attributes:r}=X1(e);super({...e,indices:n,attributes:r})}}function X1(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(Be.assert(i.length>=r),i=i.flatMap(h=>[h[0],h[1]]),ps(i,hs.COUNTER_CLOCKWISE));const o=n>0,s=r+1,a=o?s*3+1:r,l=Math.PI*2/r,c=new Uint16Array(o?r*3*2:0),u=new Float32Array(a*3),f=new Float32Array(a*3);let d=0;if(o){for(let h=0;h<s;h++){const g=h*l,p=h%r,m=Math.sin(g),y=Math.cos(g);for(let b=0;b<2;b++)u[d+0]=i?i[p*2]:y*e,u[d+1]=i?i[p*2+1]:m*e,u[d+2]=(1/2-b)*n,f[d+0]=i?i[p*2]:y,f[d+1]=i?i[p*2+1]:m,d+=3}u[d+0]=u[d-3],u[d+1]=u[d-2],u[d+2]=u[d-1],d+=3}for(let h=o?0:1;h<s;h++){const g=Math.floor(h/2)*Math.sign(.5-h%2),p=g*l,m=(g+r)%r,y=Math.sin(p),b=Math.cos(p);u[d+0]=i?i[m*2]:b*e,u[d+1]=i?i[m*2+1]:y*e,u[d+2]=n/2,f[d+2]=1,d+=3}if(o){let h=0;for(let g=0;g<r;g++)c[h++]=g*2+0,c[h++]=g*2+2,c[h++]=g*2+0,c[h++]=g*2+1,c[h++]=g*2+1,c[h++]=g*2+3}return{indices:c,attributes:{POSITION:{size:3,value:u},NORMAL:{size:3,value:f}}}}const J1=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
} else if (stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
if (isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = radius * coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
if (radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded && !isStroke) {
#ifdef FLAT_SHADING
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Q1=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (extruded && !isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Ur=[0,0,0,255],ex={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:Ur},getLineColor:{type:"accessor",value:Ur},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},Xr=class Xr extends It{getShaders(){const e={},{flatShading:n}=this.props;return n&&(e.FLAT_SHADING=1),super.getShaders({vs:J1,fs:Q1,defines:e,modules:[Lt,n?Jf:Ql,Gt]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:Ur},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:Ur},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){var a;super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,o=i.extensionsChanged||n.flatShading!==r.flatShading;o&&((a=this.state.models)==null||a.forEach(l=>l.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const s=this.getNumInstances();this.state.fillModel.setInstanceCount(s),this.state.wireframeModel.setInstanceCount(s),(o||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new q1({radius:1,height:r?2:0,vertices:n,nradial:e});let o=0;if(n)for(let s=0;s<e;s++){const a=n[s],l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);o+=l/e}else o=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*o}),i}_getModels(){const e=this.getShaders(),n=this.getAttributeManager().getBufferLayouts(),r=new Je(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:n,isInstanced:!0}),i=new Je(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:n,isInstanced:!0});return{fillModel:r,wireframeModel:i,models:[i,r]}}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const o=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:o.attributes.POSITION.value.length/3});const s=this.state.fillModel,a=this.state.wireframeModel;s.setGeometry(o),s.setTopology("triangle-strip"),s.setIndexBuffer(null),a.setGeometry(o),a.setTopology("line-list")}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:o,radiusUnits:s,elevationScale:a,extruded:l,filled:c,stroked:u,wireframe:f,offset:d,coverage:h,radius:g,angle:p}=this.props,m=this.state.fillModel,y=this.state.wireframeModel,{fillVertexCount:b,edgeDistance:_}=this.state,w={...e,radius:g,angle:p/180*Math.PI,offset:d,extruded:l,stroked:u,coverage:h,elevationScale:a,edgeDistance:_,radiusUnits:Bt[s],widthUnits:Bt[n],widthScale:r,widthMinPixels:i,widthMaxPixels:o};l&&f&&(y.setUniforms(w),y.setUniforms({isStroke:!0}),y.draw(this.context.renderPass)),m.setUniforms(w),c&&(m.setVertexCount(b),m.setUniforms({isStroke:!1}),m.draw(this.context.renderPass)),!l&&u&&(m.setVertexCount(b*2/3),m.setUniforms({isStroke:!0}),m.draw(this.context.renderPass))}};Xr.layerName="ColumnLayer",Xr.defaultProps=ex;let So=Xr;function tx(t,e,n,r){let i;if(Array.isArray(t[0])){const o=t.length*e;i=new Array(o);for(let s=0;s<t.length;s++)for(let a=0;a<e;a++)i[s*e+a]=t[s][a]||0}else i=t;return n?ff(i,{size:e,gridResolution:n}):r?G1(i,{size:e}):i}const nx=1,rx=2,$i=4;class ix extends ec{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?tx(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(al(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&al(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:o,geometrySize:s}=n;r.fill(0,o,o+s),i?(r[o]=$i,r[o+s-2]=$i):(r[o]+=nx,r[o+s-2]+=rx),r[o+s-1]=$i}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:o}=n,s=new Array(3);for(let a=i,l=0;l<o;a++,l++)this.getPointOnPath(e,l,s),r[a*3]=s[0],r[a*3+1]=s[1],r[a*3+2]=s[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const o=n*i;return r[0]=e[o],r[1]=e[o+1],r[2]=i===3&&e[o+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function al(t){return Array.isArray(t[0])}const ox=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = capType;
} else {
vJointType = jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0);
vec3 width;
if (billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,sx=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
uniform float miterLimit;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,mf=[0,0,0,255],ax={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:mf},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Fi={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},Jr=class Jr extends It{getShaders(){return super.getShaders({vs:ox,fs:sx,modules:[Lt,Gt]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:Fi,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Fi,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:Fi,defaultValue:mf},instancePickingColors:{size:4,type:"uint8",accessor:(r,{index:i,target:o})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,o)}}),this.setState({pathTesselator:new ix({fp64:this.use64bitPositions()})})}updateState(e){var s;super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,l=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:l.getPath,buffers:l,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}r.extensionsChanged&&((s=this.state.model)==null||s.destroy(),this.state.model=this._getModel(),i.invalidateAll())}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(o=>o.__source.index===r)),n}disablePickingIndex(e){const n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:o,widthUnits:s,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props,u=this.state.model;u.setUniforms(e),u.setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Bt[s],widthScale:a,miterLimit:o,widthMinPixels:l,widthMaxPixels:c}),u.draw(this.context.renderPass)}_getModel(){const e=[0,1,2,1,4,2,1,3,4,3,5,4],n=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Je(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new jt({topology:"triangle-list",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(n),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}};Jr.defaultProps=ax,Jr.layerName="PathLayer";let Co=Jr;var gs={exports:{}};gs.exports=xi;gs.exports.default=xi;function xi(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,o=yf(t,0,i,n,!0),s=[];if(!o||o.next===o.prev)return s;var a,l,c,u,f,d,h;if(r&&(o=dx(t,e,o,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(var g=n;g<i;g+=n)f=t[g],d=t[g+1],f<a&&(a=f),d<l&&(l=d),f>c&&(c=f),d>u&&(u=d);h=Math.max(c-a,u-l),h=h!==0?32767/h:0}return $n(o,s,n,a,l,h,0),s}function yf(t,e,n,r,i){var o,s;if(i===Ao(t,e,n,r)>0)for(o=e;o<n;o+=r)s=ll(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=ll(o,t[o],t[o+1],s);return s&&_i(s,s.next)&&(Bn(s),s=s.next),s}function Ht(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(_i(n,n.next)||Pe(n.prev,n,n.next)===0)){if(Bn(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function $n(t,e,n,r,i,o,s){if(t){!s&&o&&yx(t,r,i,o);for(var a=t,l,c;t.prev!==t.next;){if(l=t.prev,c=t.next,o?cx(t,r,i,o):lx(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),Bn(t),t=c.next,a=c.next;continue}if(t=c,t===a){s?s===1?(t=ux(Ht(t),e,n),$n(t,e,n,r,i,o,2)):s===2&&fx(t,e,n,r,i,o):$n(Ht(t),e,n,r,i,o,1);break}}}}function lx(t){var e=t.prev,n=t,r=t.next;if(Pe(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,s=r.x,a=e.y,l=n.y,c=r.y,u=i<o?i<s?i:s:o<s?o:s,f=a<l?a<c?a:c:l<c?l:c,d=i>o?i>s?i:s:o>s?o:s,h=a>l?a>c?a:c:l>c?l:c,g=r.next;g!==e;){if(g.x>=u&&g.x<=d&&g.y>=f&&g.y<=h&&tn(i,a,o,l,s,c,g.x,g.y)&&Pe(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function cx(t,e,n,r){var i=t.prev,o=t,s=t.next;if(Pe(i,o,s)>=0)return!1;for(var a=i.x,l=o.x,c=s.x,u=i.y,f=o.y,d=s.y,h=a<l?a<c?a:c:l<c?l:c,g=u<f?u<d?u:d:f<d?f:d,p=a>l?a>c?a:c:l>c?l:c,m=u>f?u>d?u:d:f>d?f:d,y=Eo(h,g,e,n,r),b=Eo(p,m,e,n,r),_=t.prevZ,w=t.nextZ;_&&_.z>=y&&w&&w.z<=b;){if(_.x>=h&&_.x<=p&&_.y>=g&&_.y<=m&&_!==i&&_!==s&&tn(a,u,l,f,c,d,_.x,_.y)&&Pe(_.prev,_,_.next)>=0||(_=_.prevZ,w.x>=h&&w.x<=p&&w.y>=g&&w.y<=m&&w!==i&&w!==s&&tn(a,u,l,f,c,d,w.x,w.y)&&Pe(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;_&&_.z>=y;){if(_.x>=h&&_.x<=p&&_.y>=g&&_.y<=m&&_!==i&&_!==s&&tn(a,u,l,f,c,d,_.x,_.y)&&Pe(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;w&&w.z<=b;){if(w.x>=h&&w.x<=p&&w.y>=g&&w.y<=m&&w!==i&&w!==s&&tn(a,u,l,f,c,d,w.x,w.y)&&Pe(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function ux(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!_i(i,o)&&vf(i,r,r.next,o)&&Fn(i,o)&&Fn(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),Bn(r),Bn(r.next),r=t=o),r=r.next}while(r!==t);return Ht(r)}function fx(t,e,n,r,i,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&xx(s,a)){var l=bf(s,a);s=Ht(s,s.next),l=Ht(l,l.next),$n(s,e,n,r,i,o,0),$n(l,e,n,r,i,o,0);return}a=a.next}s=s.next}while(s!==t)}function dx(t,e,n,r){var i=[],o,s,a,l,c;for(o=0,s=e.length;o<s;o++)a=e[o]*r,l=o<s-1?e[o+1]*r:t.length,c=yf(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(bx(c));for(i.sort(hx),o=0;o<i.length;o++)n=px(i[o],n);return n}function hx(t,e){return t.x-e.x}function px(t,e){var n=gx(t,e);if(!n)return e;var r=bf(n,t);return Ht(r,r.next),Ht(n,n.next)}function gx(t,e){var n=e,r=t.x,i=t.y,o=-1/0,s;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o&&(o=a,s=n.x<n.next.x?n:n.next,a===r))return s}n=n.next}while(n!==e);if(!s)return null;var l=s,c=s.x,u=s.y,f=1/0,d;n=s;do r>=n.x&&n.x>=c&&r!==n.x&&tn(i<u?r:o,i,c,u,i<u?o:r,i,n.x,n.y)&&(d=Math.abs(i-n.y)/(r-n.x),Fn(n,t)&&(d<f||d===f&&(n.x>s.x||n.x===s.x&&mx(s,n)))&&(s=n,f=d)),n=n.next;while(n!==l);return s}function mx(t,e){return Pe(t.prev,t,e.prev)<0&&Pe(e.next,t,t.next)<0}function yx(t,e,n,r){var i=t;do i.z===0&&(i.z=Eo(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,vx(i)}function vx(t){var e,n,r,i,o,s,a,l,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1);return t}function Eo(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function bx(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function tn(t,e,n,r,i,o,s,a){return(i-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(r-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(i-s)*(r-a)}function xx(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!_x(t,e)&&(Fn(t,e)&&Fn(e,t)&&wx(t,e)&&(Pe(t.prev,t,e.prev)||Pe(t,e.prev,e))||_i(t,e)&&Pe(t.prev,t,t.next)>0&&Pe(e.prev,e,e.next)>0)}function Pe(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _i(t,e){return t.x===e.x&&t.y===e.y}function vf(t,e,n,r){var i=lr(Pe(t,e,n)),o=lr(Pe(t,e,r)),s=lr(Pe(n,r,t)),a=lr(Pe(n,r,e));return!!(i!==o&&s!==a||i===0&&ar(t,n,e)||o===0&&ar(t,r,e)||s===0&&ar(n,t,r)||a===0&&ar(n,e,r))}function ar(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function lr(t){return t>0?1:t<0?-1:0}function _x(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&vf(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Fn(t,e){return Pe(t.prev,t,t.next)<0?Pe(t,e,t.next)>=0&&Pe(t,t.prev,e)>=0:Pe(t,e,t.prev)<0||Pe(t,t.next,e)<0}function wx(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function bf(t,e){var n=new Po(t.i,t.x,t.y),r=new Po(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function ll(t,e,n,r){var i=new Po(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Bn(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Po(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}xi.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(Ao(t,0,o,n));if(i)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;s-=Math.abs(Ao(t,c,u,n))}var f=0;for(a=0;a<r.length;a+=3){var d=r[a]*n,h=r[a+1]*n,g=r[a+2]*n;f+=Math.abs((t[d]-t[g])*(t[h+1]-t[d+1])-(t[d]-t[h])*(t[g+1]-t[d+1]))}return s===0&&f===0?0:Math.abs((f-s)/s)};function Ao(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}xi.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var Sx=gs.exports;const Cx=li(Sx),cr=hs.CLOCKWISE,cl=hs.COUNTER_CLOCKWISE,At={isClosed:!0};function Ex(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function An(t){return"positions"in t?t.positions:t}function _r(t){return"holeIndices"in t?t.holeIndices:null}function Px(t){return Array.isArray(t[0])}function Ax(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Tx(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Ox(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function ul(t,e,n,r,i){let o=e;const s=n.length;for(let a=0;a<s;a++)for(let l=0;l<r;l++)t[o++]=n[a][l]||0;if(!Tx(n))for(let a=0;a<r;a++)t[o++]=n[0][a]||0;return At.start=e,At.end=o,At.size=r,ps(t,i,At),o}function fl(t,e,n,r,i=0,o,s){o=o||n.length;const a=o-i;if(a<=0)return e;let l=e;for(let c=0;c<a;c++)t[l++]=n[i+c];if(!Ox(n,r,i,o))for(let c=0;c<r;c++)t[l++]=n[i+c];return At.start=e,At.end=l,At.size=r,ps(t,s,At),l}function kx(t,e){Ex(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:o}=t;if(o){let s=0;for(let a=0;a<=o.length;a++)s=fl(n,s,i,e,o[a-1],o[a],a===0?cr:cl),r.push(s);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!Px(t))return fl(n,0,t,e,0,n.length,cr),n;if(!Ax(t)){let i=0;for(const[o,s]of t.entries())i=ul(n,i,s,e,o===0?cr:cl),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return ul(n,0,t,e,cr),n}function Bi(t,e,n){const r=t.length/3;let i=0;for(let o=0;o<r;o++){const s=(o+1)%r;i+=t[o*3+e]*t[s*3+n],i-=t[s*3+e]*t[o*3+n]}return Math.abs(i/2)}function dl(t,e,n,r){const i=t.length/3;for(let o=0;o<i;o++){const s=o*3,a=t[s+0],l=t[s+1],c=t[s+2];t[s+e]=a,t[s+n]=l,t[s+r]=c}}function Rx(t,e,n,r){let i=_r(t);i&&(i=i.map(a=>a/e));let o=An(t);const s=r&&e===3;if(n){const a=o.length;o=o.slice();const l=[];for(let c=0;c<a;c+=e){l[0]=o[c],l[1]=o[c+1],s&&(l[2]=o[c+2]);const u=n(l);o[c]=u[0],o[c+1]=u[1],s&&(o[c+2]=u[2])}}if(s){const a=Bi(o,0,1),l=Bi(o,0,2),c=Bi(o,1,2);if(!a&&!l&&!c)return[];a>l&&a>c||(l>c?(n||(o=o.slice()),dl(o,0,2,1)):(n||(o=o.slice()),dl(o,2,0,1)))}return Cx(o,i,e)}class Ix extends ec{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=kx(e,this.positionSize);return this.opts.resolution?df(An(n),_r(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?K1(An(n),_r(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(hl(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return An(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&hl(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else{const r=e;this._updateIndices(r,n),this._updatePositions(r,n),this._updateVertexValid(r,n)}}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:o,indexStarts:s,typedArrayManager:a}=this;let l=o.indices;if(!l||!e)return;let c=i;const u=Rx(e,this.positionSize,this.opts.preproject,this.opts.full3d);l=a.allocate(l,i+u.length,{copy:!0});for(let f=0;f<u.length;f++)l[c++]=u[f]+r;s[n+1]=i+u.length,o.indices=l}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:o}=this;if(!i||!e)return;const s=An(e);for(let a=n,l=0;l<r;a++,l++){const c=s[l*o],u=s[l*o+1],f=o>2?s[l*o+2]:0;i[a*3]=c,i[a*3+1]=u,i[a*3+2]=f}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,o=this.attributes.vertexValid,s=e&&_r(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,n):o.fill(1,n,n+r),s)for(let a=0;a<s.length;a++)o[n+s[a]/i-1]=0;o[n+r-1]=0}}function hl(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const xf=`uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;
in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project_uCommonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (extruded) {
pos.z += props.elevations * elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * opacity);
} else {
vColor = vec4(colors.rgb, colors.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Lx=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${xf}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`,Mx=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${xf}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`,Dx=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Wr=[0,0,0,255],zx={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Wr},getLineColor:{type:"accessor",value:Wr},material:!0},ur={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},Qr=class Qr extends It{getShaders(e){return super.getShaders({vs:e==="top"?Lx:Mx,fs:Dx,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Lt,Ql,Gt]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:r}=this.props;e.isGeospatial&&n===gt.DEFAULT&&(n=gt.LNGLAT);let i;n===gt.LNGLAT&&(r?i=e.projectPosition.bind(e):i=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new Ix({preproject:i,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const o=this.getAttributeManager(),s=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:ur,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,stepMode:"dynamic",transition:ur,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:ur,accessor:"getFillColor",defaultValue:Wr},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:ur,accessor:"getLineColor",defaultValue:Wr},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(a,{index:l,target:c})=>this.encodePickingColor(a&&a.__source?a.__source.index:l,c)}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(o=>o.__source.index===r)),n}disablePickingIndex(e){const n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:o}=this.props,{topModel:s,sideModel:a,wireframeModel:l,polygonTesselator:c}=this.state,u={...e,extruded:!!n,elevationScale:o};l&&i&&(l.setInstanceCount(c.instanceCount-1),l.setUniforms(u),l.draw(this.context.renderPass)),a&&r&&(a.setInstanceCount(c.instanceCount-1),a.setUniforms(u),a.draw(this.context.renderPass)),s&&r&&(s.setVertexCount(c.vertexCount),s.setUniforms(u),s.draw(this.context.renderPass))}updateState(e){var a;super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,o=this.getAttributeManager();(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded)&&((a=this.state.models)==null||a.forEach(l=>l.destroy()),this.setState(this._getModels()),o.invalidateAll())}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:o}=this.state,s=e.data.attributes||{};o.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:s.getPolygon,buffers:s,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:n,extruded:r}=this.props;let i,o,s;if(n){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1;const l=this.getAttributeManager().getBufferLayouts({isInstanced:!1});i=new Je(this.context.device,{...a,id:`${e}-top`,topology:"triangle-list",uniforms:{isWireframe:!1},bufferLayout:l,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(r){const a=this.getAttributeManager().getBufferLayouts({isInstanced:!0});o=new Je(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:a,uniforms:{isWireframe:!1},geometry:new jt({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),s=new Je(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:a,uniforms:{isWireframe:!0},geometry:new jt({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[o,s,i].filter(Boolean),topModel:i,sideModel:o,wireframeModel:s}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}};Qr.defaultProps=zx,Qr.layerName="SolidPolygonLayer";let To=Qr;function Nx({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,s=t.length;let a=s,l=s;for(let d=0;d<s;d++){const h=e(t[d]);if(a>d&&h>=i&&(a=d),h>=o){l=d;break}}let c=a;const f=l-a!==r.length?t.slice(l):void 0;for(let d=0;d<r.length;d++)t[c++]=r[d];if(f){for(let d=0;d<f.length;d++)t[c++]=f[d];t.length=c}return{startRow:a,endRow:a+r.length}}function $x(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?Fx(t,r,n):null}function Fx(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function Bx(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const o=[];for(let s=0;s<i.length;s++)e(i[s],o),n[r][s*3+0]=o[0],n[r][s*3+1]=o[1],n[r][s*3+2]=o[2]}return n}const jx=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf) {
float distance = alpha;
alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);
if (outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
color = mix(outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,ji=192/256,pl=[],Ux={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},ei=class ei extends Br{getShaders(){return{...super.getShaders(),fs:jx}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(o=>o/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&Be.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:o}=this.state,s=i?Math.max(r,ji*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:ji,outlineBuffer:s,gamma:r,sdf:!!n,outlineColor:o},super.draw(e),n&&i){const{iconManager:a}=this.state,l=a.getTexture(),c=this.state.model;l&&(c.setUniforms({outlineBuffer:ji}),c.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):pl}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):pl}};ei.defaultProps=Ux,ei.layerName="MultiIconLayer";let Oo=ei;const Rn=1e20;class Wx{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:o="sans-serif",fontWeight:s="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const l=this.size=e+n*4,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font=`${a} ${s} ${e}px ${o}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:o,actualBoundingBoxRight:s}=this.ctx.measureText(e),a=Math.ceil(r),l=0,c=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-o))),u=Math.min(this.size-this.buffer,a+Math.ceil(i)),f=c+2*this.buffer,d=u+2*this.buffer,h=Math.max(f*d,0),g=new Uint8ClampedArray(h),p={data:g,width:f,height:d,glyphWidth:c,glyphHeight:u,glyphTop:a,glyphLeft:l,glyphAdvance:n};if(c===0||u===0)return p;const{ctx:m,buffer:y,gridInner:b,gridOuter:_}=this;m.clearRect(y,y,c,u),m.fillText(e,y,y+a);const w=m.getImageData(y,y,c,u);_.fill(Rn,0,h),b.fill(0,0,h);for(let C=0;C<u;C++)for(let O=0;O<c;O++){const T=w.data[4*(C*c+O)+3]/255;if(T===0)continue;const I=(C+y)*f+O+y;if(T===1)_[I]=0,b[I]=Rn;else{const k=.5-T;_[I]=k>0?k*k:0,b[I]=k<0?k*k:0}}gl(_,0,0,f,d,f,this.f,this.v,this.z),gl(b,y,y,c,u,f,this.f,this.v,this.z);for(let C=0;C<h;C++){const O=Math.sqrt(_[C])-Math.sqrt(b[C]);g[C]=Math.round(255-255*(O/this.radius+this.cutoff))}return p}}function gl(t,e,n,r,i,o,s,a,l){for(let c=e;c<e+r;c++)ml(t,n*o+c,o,i,s,a,l);for(let c=n;c<n+i;c++)ml(t,c*o+e,1,r,s,a,l)}function ml(t,e,n,r,i,o,s){o[0]=0,s[0]=-Rn,s[1]=Rn,i[0]=t[e];for(let a=1,l=0,c=0;a<r;a++){i[a]=t[e+a*n];const u=a*a;do{const f=o[l];c=(i[a]-i[f]+u-f*f)/(a-f)/2}while(c<=s[l]&&--l>-1);l++,o[l]=a,s[l]=c,s[l+1]=Rn}for(let a=0,l=0;a<r;a++){for(;s[l+1]<a;)l++;const c=o[l],u=a-c;t[e+a*n]=i[c]+u*u}}const Vx=32,Hx=[];function Gx(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Kx({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:a=0}){let l=0,c=s;const u=n+r*2;for(const f of t)if(!o[f]){const d=e(f);c+d+r*2>i&&(c=0,l++),o[f]={x:c+r,y:a+l*u+r,width:d,height:u,layoutWidth:d,layoutHeight:n},c+=d+r*2}return{mapping:o,xOffset:c,yOffset:a+l*u,canvasHeight:Gx(a+(l+1)*u)}}function _f(t,e,n,r){var o;let i=0;for(let s=e;s<n;s++){const a=t[s];i+=((o=r[a])==null?void 0:o.layoutWidth)||0}return i}function wf(t,e,n,r,i,o){let s=e,a=0;for(let l=e;l<n;l++){const c=_f(t,l,l+1,i);a+c>r&&(s<l&&o.push(l),s=l,a=0),a+=c}return a}function Zx(t,e,n,r,i,o){let s=e,a=e,l=e,c=0;for(let u=e;u<n;u++)if((t[u]===" "||t[u+1]===" "||u+1===n)&&(l=u+1),l>a){let f=_f(t,a,l,i);c+f>r&&(s<a&&(o.push(a),s=a,c=0),f>r&&(f=wf(t,a,l,r,i,o),s=o[o.length-1])),a=l,c+=f}return c}function Yx(t,e,n,r,i=0,o){o===void 0&&(o=t.length);const s=[];return e==="break-all"?wf(t,i,o,n,r,s):Zx(t,i,o,n,r,s),s}function qx(t,e,n,r,i,o){let s=0,a=0;for(let l=e;l<n;l++){const c=t[l],u=r[c];u?(a||(a=u.layoutHeight),i[l]=s+u.layoutWidth/2,s+=u.layoutWidth):(Be.warn(`Missing character: ${c} (${c.codePointAt(0)})`)(),i[l]=s,s+=Vx)}o[0]=s,o[1]=a}function Xx(t,e,n,r,i){var m;const o=Array.from(t),s=o.length,a=new Array(s),l=new Array(s),c=new Array(s),u=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,f=[0,0],d=[0,0];let h=0,g=0,p=0;for(let y=0;y<=s;y++){const b=o[y];if((b===`
`||y===s)&&(p=y),p>g){const _=u?Yx(o,n,r,i,g,p):Hx;for(let w=0;w<=_.length;w++){const C=w===0?g:_[w-1],O=w<_.length?_[w]:p;qx(o,C,O,i,a,d);for(let T=C;T<O;T++){const I=o[T],k=((m=i[I])==null?void 0:m.layoutOffsetY)||0;l[T]=h+d[1]/2+k,c[T]=d[0]}h=h+d[1]*e,f[0]=Math.max(f[0],d[0])}g=p}b===`
`&&(a[g]=0,l[g]=0,c[g]=0,g++)}return f[1]=h,{x:a,y:l,rowWidth:c,size:f}}function Jx({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,l=r?r/s:0,c=i[e]||Math.ceil((t.length-l)/a),u=o&&new Set,f=new Array(e);let d=t;if(a>1||l>0){const h=t.constructor;d=new h(c);for(let g=0;g<c;g++)d[g]=t[g*a+l]}for(let h=0;h<e;h++){const g=i[h],p=i[h+1]||c,m=d.subarray(g,p);f[h]=String.fromCodePoint.apply(null,m),u&&m.forEach(u.add,u)}if(u)for(const h of u)o.add(String.fromCodePoint(h));return{texts:f,characterCount:c}}class Sf{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function Qx(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const an={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:Qx(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},yl=1024,vl=.9,bl=1.2,Cf=3;let Vr=new Sf(Cf);function e_(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=Vr.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function t_(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function xl(t,e,n,r){t.font=`${r} ${n}px ${e}`,t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function n_(t){Be.assert(Number.isFinite(t)&&t>=Cf,"Invalid cache limit"),Vr=new Sf(t)}class r_{constructor(){this.props={...an}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*bl+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=e_(this._key,this.props.characterSet),r=Vr.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,Vr.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:o,buffer:s,sdf:a,radius:l,cutoff:c}=this.props;let u=n&&n.data;u||(u=document.createElement("canvas"),u.width=yl);const f=u.getContext("2d",{willReadFrequently:!0});xl(f,r,o,i);const{mapping:d,canvasHeight:h,xOffset:g,yOffset:p}=Kx({getFontWidth:m=>f.measureText(m).width,fontHeight:o*bl,buffer:s,characterSet:e,maxCanvasWidth:yl,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(u.height!==h){const m=f.getImageData(0,0,u.width,u.height);u.height=h,f.putImageData(m,0,0)}if(xl(f,r,o,i),a){const m=new Wx({fontSize:o,buffer:s,radius:l,cutoff:c,fontFamily:r,fontWeight:`${i}`});for(const y of e){const{data:b,width:_,height:w,glyphTop:C}=m.draw(y);d[y].width=_,d[y].layoutOffsetY=o*vl-C;const O=f.createImageData(_,w);t_(b,O),f.putImageData(O,d[y].x,d[y].y)}}else for(const m of e)f.fillText(m,d[m].x,d[m].y+s+o*vl);return{xOffset:g,yOffset:p,mapping:d,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:o,radius:s,cutoff:a}=this.props;return o?`${e} ${n} ${r} ${i} ${s} ${a}`:`${e} ${n} ${r} ${i}`}}const i_=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,o_=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
uniform bool stroked;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec2 pixelPosition = uv * dimensions;
if (stroked) {
float distToEdge = min(
min(pixelPosition.x, dimensions.x - pixelPosition.x),
min(pixelPosition.y, dimensions.y - pixelPosition.y)
);
float isBorder = smoothedge(distToEdge, vLineWidth);
fragColor = mix(vFillColor, vLineColor, isBorder);
} else {
fragColor = vFillColor;
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,s_={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},ti=class ti extends It{getShaders(){return super.getShaders({vs:i_,fs:o_,modules:[Lt,Gt]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var r;super.updateState(e);const{changeFlags:n}=e;n.extensionsChanged&&((r=this.state.model)==null||r.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:o,sizeMaxPixels:s,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]);const c=this.state.model;c.setUniforms(e),c.setUniforms({billboard:n,stroked:!!a,padding:l,sizeUnits:Bt[i],sizeScale:r,sizeMinPixels:o,sizeMaxPixels:s}),c.draw(this.context.renderPass)}_getModel(){const e=[0,0,1,0,1,1,0,1];return new Je(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new jt({topology:"triangle-fan-webgl",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}};ti.defaultProps=s_,ti.layerName="TextBackgroundLayer";let ko=ti;const _l={start:1,middle:0,end:-1},wl={top:1,center:0,bottom:-1},Ui=[0,0,0,255],a_=1,l_={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Ui},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:an.characterSet},fontFamily:an.fontFamily,fontWeight:an.fontWeight,lineHeight:a_,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Ui},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Ui},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},ni=class ni extends ci{constructor(){super(...arguments),this.getBoundingRect=(e,n)=>{let{size:[r,i]}=this.transformParagraph(e,n);const{fontSize:o}=this.state.fontAtlasManager.props;r/=o,i/=o;const{getTextAnchor:s,getAlignmentBaseline:a}=this.props,l=_l[typeof s=="function"?s(e,n):s],c=wl[typeof a=="function"?a(e,n):a];return[(l-1)*r/2,(c-1)*i/2,r,i]},this.getIconOffsets=(e,n)=>{const{getTextAnchor:r,getAlignmentBaseline:i}=this.props,{x:o,y:s,rowWidth:a,size:[l,c]}=this.transformParagraph(e,n),u=_l[typeof r=="function"?r(e,n):r],f=wl[typeof i=="function"?i(e,n):i],d=o.length,h=new Array(d*2);let g=0;for(let p=0;p<d;p++){const m=(1-u)*(l-a[p])/2;h[g++]=(u-1)*l/2+m+o[p],h[g++]=(f-1)*c/2+s[p]}return h}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new r_},this.props.maxWidth>0&&Be.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:o}=this.state,s={...e,characterSet:o,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(s),!0;for(const a in s)if(s[a]!==i.props[a])return i.setProps(s),!0;return!1}_updateText(){var l;const{data:e,characterSet:n}=this.props,r=(l=e.attributes)==null?void 0:l.getText;let{getText:i}=this.props,o=e.startIndices,s;const a=n==="auto"&&new Set;if(r&&o){const{texts:c,characterCount:u}=Jx({...ArrayBuffer.isView(r)?{value:r}:r,length:e.length,startIndices:o,characterSet:a});s=u,i=(f,{index:d})=>c[d]}else{const{iterable:c,objectInfo:u}=Wo(e);o=[0],s=0;for(const f of c){u.index++;const d=Array.from(i(f,u)||"");a&&d.forEach(a.add,a),s+=d.length,o.push(s)}}this.setState({getText:i,startIndices:o,numInstances:s,characterSet:a||n})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,o=this.state.getText,{wordBreak:s,lineHeight:a,maxWidth:l}=this.props,c=o(e,n)||"";return Xx(c,a,s,l*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,atlas:o,mapping:s},styleVersion:a}=this.state,{data:l,_dataDiff:c,getPosition:u,getColor:f,getSize:d,getAngle:h,getPixelOffset:g,getBackgroundColor:p,getBorderColor:m,getBorderWidth:y,backgroundPadding:b,background:_,billboard:w,fontSettings:C,outlineWidth:O,outlineColor:T,sizeScale:I,sizeUnits:k,sizeMinPixels:M,sizeMaxPixels:j,transitions:S,updateTriggers:L}=this.props,x=this.getSubLayerClass("characters",Oo),z=this.getSubLayerClass("background",ko);return[_&&new z({getFillColor:p,getLineColor:m,getLineWidth:y,padding:b,getPosition:u,getSize:d,getAngle:h,getPixelOffset:g,billboard:w,sizeScale:I,sizeUnits:k,sizeMinPixels:M,sizeMaxPixels:j,transitions:S&&{getPosition:S.getPosition,getAngle:S.getAngle,getSize:S.getSize,getFillColor:S.getBackgroundColor,getLineColor:S.getBorderColor,getLineWidth:S.getBorderWidth,getPixelOffset:S.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:L.getPosition,getAngle:L.getAngle,getSize:L.getSize,getFillColor:L.getBackgroundColor,getLineColor:L.getBorderColor,getLineWidth:L.getBorderWidth,getPixelOffset:L.getPixelOffset,getBoundingRect:{getText:L.getText,getTextAnchor:L.getTextAnchor,getAlignmentBaseline:L.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:c,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new x({sdf:C.sdf,smoothing:Number.isFinite(C.smoothing)?C.smoothing:an.smoothing,outlineWidth:O/(C.radius||an.radius),outlineColor:T,iconAtlas:o,iconMapping:s,getPosition:u,getColor:f,getSize:d,getAngle:h,getPixelOffset:g,billboard:w,sizeScale:I*i,sizeUnits:k,sizeMinPixels:M*i,sizeMaxPixels:j*i,transitions:S&&{getPosition:S.getPosition,getAngle:S.getAngle,getColor:S.getColor,getSize:S.getSize,getPixelOffset:S.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:L.getText,getPosition:L.getPosition,getAngle:L.getAngle,getColor:L.getColor,getSize:L.getSize,getPixelOffset:L.getPixelOffset,getIconOffsets:{getTextAnchor:L.getTextAnchor,getAlignmentBaseline:L.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:c,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){n_(e)}};ni.defaultProps=l_,ni.layerName="TextLayer";let Ro=ni;const wr={circle:{type:jr,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Br,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Ro,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Sr={type:Co,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Io={type:To,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Sn({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Wi(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[s]=r[o],n&&(i.transitions[s]=n[o])),i[s]=a}return i}function c_(t){if(Array.isArray(t))return t;switch(Be.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Be.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function Sl(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:o=t.length}=n;for(let s=i;s<o;s++){const a=t[s],{geometry:l}=a;if(l)if(l.type==="GeometryCollection"){Be.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");const{geometries:c}=l;for(let u=0;u<c.length;u++){const f=c[u];Cl(f,r,e,a,s)}}else Cl(l,r,e,a,s)}return r}function Cl(t,e,n,r,i){const{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=e;if(!f_(o,s)){Be.warn(`${o} coordinates are malformed`)();return}switch(o){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":s.forEach(f=>{a.push(n({geometry:{type:"Point",coordinates:f}},r,i))});break;case"LineString":l.push(n({geometry:t},r,i));break;case"MultiLineString":s.forEach(f=>{l.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"Polygon":c.push(n({geometry:t},r,i)),s.forEach(f=>{u.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"MultiPolygon":s.forEach(f=>{c.push(n({geometry:{type:"Polygon",coordinates:f}},r,i)),f.forEach(d=>{u.push(n({geometry:{type:"LineString",coordinates:d}},r,i))})});break}}const u_={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function f_(t,e){let n=u_[t];for(Be.assert(n,`Unknown GeoJSON type ${t}`);e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function Ef(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function fr(t){return t.geometry.coordinates}function d_(t,e){const n=Ef(),{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=fr,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=fr,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=fr,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=fr,n}function h_(t,e){const n=Ef(),{points:r,lines:i,polygons:o}=t,s=Bx(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const p_=["points","linestrings","polygons"],g_={...Sn(wr.circle),...Sn(wr.icon),...Sn(wr.text),...Sn(Sr),...Sn(Io),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}},ri=class ri extends ci{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=h_(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=c_(e.data),i=this.getSubLayerRow.bind(this);let o={};const s={};if(Array.isArray(n.dataChanged)){const l=this.state.features;for(const c in l)o[c]=l[c].slice(),s[c]=[];for(const c of n.dataChanged){const u=Sl(r,i,c);for(const f in l)s[f].push(Nx({data:o[f],getIndex:d=>d.__source.index,dataRange:c,replace:u[f]}))}}else o=Sl(r,i);const a=d_(o,s);this.setState({features:o,featuresDiff:s,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=p_.find(o=>i.id.startsWith(`${this.id}-${o}-`)),r>=0&&i.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n=`${this.id}-points-`,r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){var s;const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",o=this.shouldRenderSubLayer(i,(s=r.polygons)==null?void 0:s.data)&&this.getSubLayerClass(i,Io.type);if(o){const a=Wi(this,Io.props),l=e&&n;return l||delete a.getLineColor,a.updateTriggers.lineColors=l,new o(a,this.getSubLayerProps({id:i,updateTriggers:a.updateTriggers}),r.polygons)}return null}_renderLineLayers(){var l,c;const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",o="linestrings",s=!e&&n&&this.shouldRenderSubLayer(i,(l=r.polygonsOutline)==null?void 0:l.data)&&this.getSubLayerClass(i,Sr.type),a=this.shouldRenderSubLayer(o,(c=r.lines)==null?void 0:c.data)&&this.getSubLayerClass(o,Sr.type);if(s||a){const u=Wi(this,Sr.props);return[s&&new s(u,this.getSubLayerProps({id:i,updateTriggers:u.updateTriggers}),r.polygonsOutline),a&&new a(u,this.getSubLayerProps({id:o,updateTriggers:u.updateTriggers}),r.lines)]}return null}_renderPointLayers(){var a;const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(l=>l.__source.index===i));const o=new Set(e.split("+")),s=[];for(const l of o){const c=`points-${l}`,u=wr[l],f=u&&this.shouldRenderSubLayer(c,(a=n.points)==null?void 0:a.data)&&this.getSubLayerClass(c,u.type);if(f){const d=Wi(this,u.props);let h=n.points;if(l==="text"&&r){const{instancePickingColors:g,...p}=h.data.attributes;h={...h,data:{...h.data,attributes:p}}}s.push(new f(d,this.getSubLayerProps({id:c,updateTriggers:d.updateTriggers,highlightedObjectIndex:i}),h))}}return s}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:o,index:s}=i,a=$x(o,s);return e(a,i)}}};ri.layerName="GeoJsonLayer",ri.defaultProps=g_;let Hr=ri;const Jt={SUM:1,MEAN:2,MIN:3,MAX:4};function Pf(t,e){return t+e}function m_(t,e){return e>t?e:t}function y_(t,e){return e<t?e:t}function v_(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(Pf,0)/n.length:null}function b_(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(Pf,0):null}function x_(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(m_,-1/0):null}function __(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(y_,1/0):null}function w_(t,e,n){const r=Jt[t]||Jt.SUM;switch(e=S_(e,n),r){case Jt.MIN:return i=>__(i,e);case Jt.SUM:return i=>b_(i,e);case Jt.MEAN:return i=>v_(i,e);case Jt.MAX:return i=>x_(i,e);default:return null}}function S_(t,e={}){return Number.isFinite(t)?t:n=>(e.index=n.index,t(n.source,e))}function C_(t,e={}){return n=>(e.indices=n.map(r=>r.index),t(n.map(r=>r.source),e))}const Af=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function E_(t,e=!1,n=Float32Array){let r;if(Number.isFinite(t[0]))r=new n(t);else{r=new n(t.length*4);let i=0;for(let o=0;o<t.length;o++){const s=t[o];r[i++]=s[0],r[i++]=s[1],r[i++]=s[2],r[i++]=Number.isFinite(s[3])?s[3]:255}}if(e)for(let i=0;i<r.length;i++)r[i]/=255;return r}function P_(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}const Ps=class Ps extends ci{initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:P_(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){const r=this.getShaders({});r&&r.defines&&(r.defines.NON_INSTANCED_MODEL=1),this.updateShaders(r)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getAttributes()}getModuleSettings(){const{viewport:e,mousePosition:n,device:r}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,picking:{isActive:0},devicePixelRatio:r.canvasContext.cssToDeviceRatio()})}updateShaders(e){}isAggregationDirty(e,n={}){const{props:r,oldProps:i,changeFlags:o}=e,{compareAll:s=!1,dimension:a}=n,{ignoreProps:l}=this.state,{props:c,accessors:u=[]}=a,{updateTriggersChanged:f}=o;if(o.dataChanged)return!0;if(f){if(f.all)return!0;for(const d of u)if(f[d])return!0}if(s)return o.extensionsChanged?!0:Qf({oldProps:i,newProps:r,ignoreProps:l,propTypes:this.constructor._propTypes});for(const d of c)if(r[d]!==i[d])return!0;return!1}isAttributeChanged(e){const{changedAttributes:n}=this.state;return e?n&&n[e]!==void 0:!A_(n)}_getAttributeManager(){return new tc(this.context.device,{id:this.props.id,stats:this.context.stats})}};Ps.layerName="AggregationLayer";let Gr=Ps;function A_(t){let e=!0;for(const n in t){e=!1;break}return e}function wi(t,e,n){const r=n;return r.domain=()=>t,r.range=()=>e,r}function El(t,e){return wi(t,e,r=>D_(t,e,r))}function T_(t,e){return wi(t,e,r=>z_(t,e,r))}function O_(t,e){const n=t.sort(Tf);let r=0;const i=Math.max(1,e.length),o=new Array(i-1);for(;++r<i;)o[r-1]=k_(n,r/i);const s=a=>I_(o,e,a);return s.thresholds=()=>o,wi(t,e,s)}function Tf(t,e){return t-e}function k_(t,e){const n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];const r=(n-1)*e,i=Math.floor(r),o=t[i],s=t[i+1];return o+(s-o)*(r-i)}function R_(t,e){let n=0,r=t.length;for(;n<r;){const i=n+r>>>1;Tf(t[i],e)>0?r=i:n=i+1}return n}function I_(t,e,n){return e[R_(t,n)]}function L_(t,e,n,r){const i=`${r}`;let o=e.get(i);return o===void 0&&(o=t.push(r),e.set(i,o)),n[(o-1)%n.length]}function M_(t,e){const n=new Map,r=[];for(const o of t){const s=`${o}`;n.has(s)||n.set(s,r.push(o))}return wi(t,e,o=>L_(r,n,e,o))}function D_(t,e,n){const r=t[1]-t[0];if(r<=0)return Be.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];const i=r/e.length,o=Math.floor((n-t[0])/i),s=Math.max(Math.min(o,e.length-1),0);return e[s]}function z_(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}function Of(t){return t!=null}function N_(t){const e=[];return t.forEach(n=>{!e.includes(n)&&Of(n)&&e.push(n)}),e}function kf(t,e){return(typeof e=="function"?t.map(e):t).filter(Of)}function $_(t,e){return kf(t,e)}function F_(t,e){return N_(kf(t,e))}function B_(t,e,n){return Math.max(e,Math.min(n,t))}function j_(t){switch(t){case"quantize":return El;case"linear":return T_;case"quantile":return O_;case"ordinal":return M_;default:return El}}const Rf=t=>t.length,U_=3402823466e29,If=t=>t.points,Lf=t=>t.index,Pl=(t,e)=>t<e?-1:t>e?1:t>=e?0:NaN,W_={getValue:Rf,getPoints:If,getIndex:Lf,filterData:null};class V_{constructor(e=[],n=W_){this.aggregatedBins=this.getAggregatedBins(e,n),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(e,n){const{getValue:r=Rf,getPoints:i=If,getIndex:o=Lf,filterData:s}=n,a=typeof s=="function",l=e.length,c=[];let u=0;for(let f=0;f<l;f++){const d=e[f],h=i(d),g=o(d),p=a?h.filter(s):h;d.filteredPoints=a?p:null;const m=p.length?r(p):null;m!=null&&(c[u]={i:Number.isFinite(g)?g:f,value:m,counts:p.length},u++)}return c}_percentileToIndex(e){const n=this.sortedBins.length;if(n<2)return[0,0];const[r,i]=e.map(a=>B_(a,0,100)),o=Math.ceil(r/100*(n-1)),s=Math.floor(i/100*(n-1));return[o,s]}getBinMap(){const e={};for(const n of this.aggregatedBins)e[n.i]=n;return e}_updateMinMaxValues(){let e=0,n=0,r=U_,i=0;for(const o of this.aggregatedBins)e=e>o.counts?e:o.counts,n=n>o.value?n:o.value,r=r<o.value?r:o.value,i+=o.counts;this.maxCount=e,this.maxValue=n,this.minValue=r,this.totalCount=i}getValueRange(e){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((i,o)=>Pl(i.value,o.value))),!this.sortedBins.length)return[];let n=0,r=this.sortedBins.length-1;if(Array.isArray(e)){const i=this._percentileToIndex(e);n=i[0],r=i[1]}return[this.sortedBins[n].value,this.sortedBins[r].value]}getValueDomainByScale(e,[n=0,r=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((o,s)=>Pl(o.value,s.value))),!this.sortedBins.length)return[];const i=this._percentileToIndex([n,r]);return this._getScaleDomain(e,i)}_getScaleDomain(e,[n,r]){const i=this.sortedBins;switch(e){case"quantize":case"linear":return[i[n].value,i[r].value];case"quantile":return $_(i.slice(n,r+1),o=>o.value);case"ordinal":return F_(i,o=>o.value);default:return[i[n].value,i[r].value]}}}function Al(){}const Tl=["getBins","getDomain","getScaleFunc"],Ol=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],H_=t=>t.cellSize;class G_{constructor(e){this.state={layerData:{data:void 0},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=e.getCellSize||H_,this._getAggregator=e.getAggregator,this._addDimension(e.dimensions||Ol)}static defaultDimensions(){return Ol}updateState(e,n){const{oldProps:r,props:i,changeFlags:o}=e;this.updateGetValueFuncs(r,i,o);const s=this.needsReProjectPoints(r,i,o);let a=!1;return o.dataChanged||s?(this.getAggregatedData(i,n),a=!0):((this.getDimensionChanges(r,i,o)||[]).forEach(c=>typeof c=="function"&&c()),a=!0),this.setState({aggregationDirty:a}),this.state}setState(e){this.state={...this.state,...e}}setDimensionState(e,n){this.setState({dimensions:{...this.state.dimensions,[e]:{...this.state.dimensions[e],...n}}})}normalizeResult(e={}){return e.hexagons?{data:e.hexagons,...e}:e.layerData?{data:e.layerData,...e}:e}getAggregatedData(e,n){const i=this._getAggregator(e)(e,n);this.setState({layerData:this.normalizeResult(i)}),this.changeFlags={layerData:!0},this.getSortedBins(e)}updateGetValueFuncs(e,n,r){for(const i in this.dimensionUpdaters){const{value:o,weight:s,aggregation:a}=this.dimensionUpdaters[i].getBins.triggers;let l=n[o.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[i].getBins,e,n,r)&&(l?l=C_(l,{data:n.data}):l=w_(n[a.prop],n[s.prop],{data:n.data})),l&&this.setDimensionState(i,{getValue:l})}}needsReProjectPoints(e,n,r){return this._getCellSize(e)!==this._getCellSize(n)||this._getAggregator(e)!==this._getAggregator(n)||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPosition)}addDimension(e){this._addDimension(e)}_addDimension(e=[]){e.forEach(n=>{const{key:r}=n;this.dimensionUpdaters[r]=this.getDimensionUpdaters(n),this.state.dimensions[r]={getValue:null,domain:null,sortedBins:null,scaleFunc:Al}})}getDimensionUpdaters({key:e,accessor:n,pickingInfo:r,getBins:i,getDomain:o,getScaleFunc:s,nullValue:a}){return{key:e,accessor:n,pickingInfo:r,getBins:{updater:this.getDimensionSortedBins.bind(this),...i},getDomain:{updater:this.getDimensionValueDomain.bind(this),...o},getScaleFunc:{updater:this.getDimensionScale.bind(this),...s},attributeAccessor:this.getSubLayerDimensionAttribute(e,a)}}needUpdateDimensionStep(e,n,r,i){return Object.values(e.triggers).some(o=>o.updateTrigger?i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged[o.updateTrigger]):n[o.prop]!==r[o.prop])}getDimensionChanges(e,n,r){const i=[];for(const o in this.dimensionUpdaters){const s=Tl.find(a=>this.needUpdateDimensionStep(this.dimensionUpdaters[o][a],e,n,r));s&&i.push(this.dimensionUpdaters[o][s].updater.bind(this,n,this.dimensionUpdaters[o]))}return i.length?i:null}getUpdateTriggers(e){const n=e.updateTriggers||{},r={};for(const i in this.dimensionUpdaters){const{accessor:o}=this.dimensionUpdaters[i];r[o]={},Tl.forEach(s=>{Object.values(this.dimensionUpdaters[i][s].triggers).forEach(({prop:a,updateTrigger:l})=>{if(l){const c=n[l];typeof c=="object"&&!Array.isArray(c)?Object.assign(r[o],c):c!==void 0&&(r[o][a]=c)}else r[o][a]=e[a]})})}return r}getSortedBins(e){for(const n in this.dimensionUpdaters)this.getDimensionSortedBins(e,this.dimensionUpdaters[n])}getDimensionSortedBins(e,n){const{key:r}=n,{getValue:i}=this.state.dimensions[r],o=new V_(this.state.layerData.data||[],{getValue:i,filterData:e._filterData});this.setDimensionState(r,{sortedBins:o}),this.getDimensionValueDomain(e,n)}getDimensionValueDomain(e,n){const{getDomain:r,key:i}=n,{triggers:{lowerPercentile:o,upperPercentile:s,scaleType:a}}=r,l=this.state.dimensions[i].sortedBins.getValueDomainByScale(e[a.prop],[e[o.prop],e[s.prop]]);this.setDimensionState(i,{valueDomain:l}),this.getDimensionScale(e,n)}getDimensionScale(e,n){const{key:r,getScaleFunc:i,getDomain:o}=n,{domain:s,range:a}=i.triggers,{scaleType:l}=o.triggers,{onSet:c}=i,u=e[a.prop],f=e[s.prop]||this.state.dimensions[r].valueDomain,h=j_(l&&e[l.prop])(f,u);typeof c=="object"&&typeof e[c.props]=="function"&&e[c.props](h.domain()),this.setDimensionState(r,{scaleFunc:h})}getSubLayerDimensionAttribute(e,n){return r=>{const{sortedBins:i,scaleFunc:o}=this.state.dimensions[e],s=i.binMap[r.index];if(s&&s.counts===0)return n;const a=s&&s.value,l=o.domain();return a>=l[0]&&a<=l[l.length-1]?o(a):n}}getSubLayerAccessors(e){const n={};for(const r in this.dimensionUpdaters){const{accessor:i}=this.dimensionUpdaters[r];n[i]=this.getSubLayerDimensionAttribute(e,r)}return n}getPickingInfo({info:e}){const n=e.picked&&e.index>-1;let r=null;if(n){const i=this.state.layerData.data[e.index],o={};for(const s in this.dimensionUpdaters){const{pickingInfo:a}=this.dimensionUpdaters[s],{sortedBins:l}=this.state.dimensions[s],c=l.binMap[i.index]&&l.binMap[i.index].value;o[a]=c}r=Object.assign(o,i,{points:i.filteredPoints||i.points})}return e.picked=!!r,e.object=r,e}getAccessor(e){return this.dimensionUpdaters.hasOwnProperty(e)?this.dimensionUpdaters[e].attributeAccessor:Al}}var Qt=Math.PI/3,K_=[0,Qt,2*Qt,3*Qt,4*Qt,5*Qt];function Z_(t){return t[0]}function Y_(t){return t[1]}function q_(){var t=0,e=0,n=1,r=1,i=Z_,o=Y_,s,a,l;function c(f){var d={},h=[],g,p=f.length;for(g=0;g<p;++g)if(!(isNaN(y=+i.call(null,m=f[g],g,f))||isNaN(b=+o.call(null,m,g,f)))){var m,y,b,_=Math.round(b=b/l),w=Math.round(y=y/a-(_&1)/2),C=b-_;if(Math.abs(C)*3>1){var O=y-w,T=w+(y<w?-1:1)/2,I=_+(b<_?-1:1),k=y-T,M=b-I;O*O+C*C>k*k+M*M&&(w=T+(_&1?1:-1)/2,_=I)}var j=w+"-"+_,S=d[j];S?S.push(m):(h.push(S=d[j]=[m]),S.x=(w+(_&1)/2)*a,S.y=_*l)}return h}function u(f){var d=0,h=0;return K_.map(function(g){var p=Math.sin(g)*f,m=-Math.cos(g)*f,y=p-d,b=m-h;return d=p,h=m,[y,b]})}return c.hexagon=function(f){return"m"+u(f==null?s:+f).join("l")+"z"},c.centers=function(){for(var f=[],d=Math.round(e/l),h=Math.round(t/a),g=d*l;g<r+s;g+=l,++d)for(var p=h*a+(d&1)*a/2;p<n+a/2;p+=a)f.push([p,g]);return f},c.mesh=function(){var f=u(s).slice(0,4).join("l");return c.centers().map(function(d){return"M"+d+"m"+f}).join("")},c.x=function(f){return arguments.length?(i=f,c):i},c.y=function(f){return arguments.length?(o=f,c):o},c.radius=function(f){return arguments.length?(s=+f,a=s*2*Math.sin(Qt),l=s*1.5,c):s},c.size=function(f){return arguments.length?(t=e=0,n=+f[0],r=+f[1],c):[n-t,r-e]},c.extent=function(f){return arguments.length?(t=+f[0][0],e=+f[0][1],n=+f[1][0],r=+f[1][1],c):[[t,e],[n,r]]},c.radius(1)}function X_(t,e){const{data:n,radius:r}=t,{viewport:i,attributes:o}=e,s=n.length?J_(n,e):null,a=Q_(r,i,s),l=[],{iterable:c,objectInfo:u}=Wo(n),f=o.positions.value,{size:d}=o.positions.getAccessor();for(const p of c){u.index++;const m=u.index*d,y=[f[m],f[m+1]];Number.isFinite(y[0])&&Number.isFinite(y[1])?l.push({screenCoord:i.projectFlat(y),source:p,index:u.index}):Be.warn("HexagonLayer: invalid position")()}return{hexagons:q_().radius(a).x(p=>p.screenCoord[0]).y(p=>p.screenCoord[1])(l).map((p,m)=>({position:i.unprojectFlat([p.x,p.y]),points:p,index:m})),radiusCommon:a}}function J_(t,e){const{attributes:n}=e,r=n.positions.value,{size:i}=n.positions.getAccessor();let o=1/0,s=1/0,a=-1/0,l=-1/0,c;for(c=0;c<i*t.length;c+=i){const u=r[c],f=r[c+1];Number.isFinite(u)&&Number.isFinite(f)&&(o=Math.min(u,o),a=Math.max(u,a),s=Math.min(f,s),l=Math.max(f,l))}return[o,s,a,l].every(Number.isFinite)?[(o+a)/2,(s+l)/2]:null}function Q_(t,e,n){const{unitsPerMeter:r}=e.getDistanceScales(n);return t*r[0]}function kl(){}const ew={colorDomain:null,colorRange:Af,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:kl,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:kl,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:X_,getPosition:{type:"accessor",value:t=>t.position},material:!0,_filterData:{type:"function",value:null,optional:!0}},ii=class ii extends Gr{initializeState(){const e=new G_({getAggregator:r=>r.hexagonAggregator,getCellSize:r=>r.radius});this.state={cpuAggregator:e,aggregatorState:e.state,vertices:null},this.getAttributeManager().add({positions:{size:3,type:"float64",accessor:"getPosition"}})}updateState(e){if(super.updateState(e),e.changeFlags.propsOrDataChanged){const n=this.state.cpuAggregator.updateState(e,{viewport:this.context.viewport,attributes:this.getAttributes()});if(this.state.aggregatorState.layerData!==n.layerData){const{hexagonVertices:r}=n.layerData||{};this.setState({vertices:r&&this.convertLatLngToMeterOffset(r)})}this.setState({aggregatorState:n})}}convertLatLngToMeterOffset(e){const{viewport:n}=this.context;if(Array.isArray(e)&&e.length===6){const r=e[0],i=e[3],o=[(r[0]+i[0])/2,(r[1]+i[1])/2],s=n.projectFlat(o),{metersPerUnit:a}=n.getDistanceScales(o);return e.map(c=>{const u=n.projectFlat(c);return[(u[0]-s[0])*a[0],(u[1]-s[1])*a[1]]})}return Be.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}getPickingInfo({info:e}){return this.state.cpuAggregator.getPickingInfo({info:e})}_onGetSublayerColor(e){return this.state.cpuAggregator.getAccessor("fillColor")(e)}_onGetSublayerElevation(e){return this.state.cpuAggregator.getAccessor("elevation")(e)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:e,extruded:n,coverage:r,material:i,transitions:o}=this.props,{aggregatorState:s,vertices:a}=this.state,l=this.getSubLayerClass("hexagon-cell",So),c=this._getSublayerUpdateTriggers(),u=a?{vertices:a,radius:1}:{radius:s.layerData.radiusCommon||1,radiusUnits:"common",angle:90};return new l({...u,diskResolution:6,elevationScale:e,extruded:n,coverage:r,material:i,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:o&&{getFillColor:o.getColorValue||o.getColorWeight,getElevation:o.getElevationValue||o.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:c}),{data:s.layerData.data})}};ii.layerName="HexagonLayer",ii.defaultProps=ew;let Lo=ii;function tw(t){const e=t.map(a=>a[0]),n=t.map(a=>a[1]),r=Math.min.apply(null,e),i=Math.max.apply(null,e),o=Math.min.apply(null,n),s=Math.max.apply(null,n);return[r,o,i,s]}function nw(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}const Rl=new Float32Array(12);function Il(t,e=2){let n=0;for(const r of t)for(let i=0;i<e;i++)Rl[n++]=r[i]||0;return Rl}function rw(t,e,n){const[r,i,o,s]=t,a=o-r,l=s-i;let c=a,u=l;a/l<e/n?c=e/n*l:u=n/e*a,c<e&&(c=e,u=n);const f=(o+r)/2,d=(s+i)/2;return[f-c/2,d-u/2,f+c/2,d+u/2]}function iw(t,e){const[n,r,i,o]=e;return[(t[0]-n)/(i-n),(t[1]-r)/(o-r)]}const ow=`#version 300 es
#define SHADER_NAME heatp-map-layer-vertex-shader
uniform sampler2D maxTexture;
uniform float intensity;
uniform vec2 colorDomain;
uniform float threshold;
uniform float aggregationMode;
in vec3 positions;
in vec2 texCoords;
out vec2 vTexCoords;
out float vIntensityMin;
out float vIntensityMax;
void main(void) {
gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));
vTexCoords = texCoords;
vec4 maxTexture = texture(maxTexture, vec2(0.5));
float maxValue = aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;
float minValue = maxValue * threshold;
if (colorDomain[1] > 0.) {
maxValue = colorDomain[1];
minValue = colorDomain[0];
}
vIntensityMax = intensity / maxValue;
vIntensityMin = intensity / minValue;
}
`,sw=`#version 300 es
#define SHADER_NAME triangle-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D weightsTexture;
uniform sampler2D colorTexture;
uniform float aggregationMode;
in vec2 vTexCoords;
in float vIntensityMin;
in float vIntensityMax;
out vec4 fragColor;
vec4 getLinearColor(float value) {
float factor = clamp(value * vIntensityMax, 0., 1.);
vec4 color = texture(colorTexture, vec2(factor, 0.5));
color.a *= min(value * vIntensityMin, 1.0);
return color;
}
void main(void) {
vec4 weights = texture(weightsTexture, vTexCoords);
float weight = weights.r;
if (aggregationMode > 0.5) {
weight /= max(1.0, weights.a);
}
if (weight <= 0.) {
discard;
}
vec4 linearColor = getLinearColor(weight);
linearColor.a *= opacity;
fragColor = linearColor;
}
`,As=class As extends It{getShaders(){return{vs:ow,fs:sw,modules:[Lt]}}initializeState({device:e}){this.setState({model:this._getModel(e)})}_getModel(e){const{vertexCount:n,data:r,weightsTexture:i,maxTexture:o,colorTexture:s}=this.props;return new Je(e,{...this.getShaders(),id:this.props.id,bindings:{weightsTexture:i,maxTexture:o,colorTexture:s},attributes:r.attributes,bufferLayout:[{name:"positions",format:"float32x3"},{name:"texCoords",format:"float32x2"}],topology:"triangle-fan-webgl",vertexCount:n})}draw({uniforms:e}){const{model:n}=this.state,{intensity:r,threshold:i,aggregationMode:o,colorDomain:s}=this.props;n.setUniforms({...e,intensity:r,threshold:i,aggregationMode:o,colorDomain:s}),n.draw(this.context.renderPass)}};As.layerName="TriangleLayer";let Mo=As;const Ll=`#version 300 es
in vec3 positions;
in vec3 positions64Low;
in float weights;
out vec4 weightsTexture;
uniform float radiusPixels;
uniform float textureWidth;
uniform vec4 commonBounds;
uniform float weightsScale;
void main()
{
weightsTexture = vec4(weights * weightsScale, 0., 0., 1.);
float radiusTexels = project_pixel_size(radiusPixels) * textureWidth / (commonBounds.z - commonBounds.x);
gl_PointSize = radiusTexels * 2.;
vec3 commonPosition = project_position(positions, positions64Low);
gl_Position.xy = (commonPosition.xy - commonBounds.xy) / (commonBounds.zw - commonBounds.xy) ;
gl_Position.xy = (gl_Position.xy * 2.) - (1.);
gl_Position.w = 1.0;
}
`,Ml=`#version 300 es
in vec4 weightsTexture;
out vec4 fragColor;
float gaussianKDE(float u){
return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);
}
void main()
{
float dist = length(gl_PointCoord - vec2(0.5, 0.5));
if (dist > 0.5) {
discard;
}
fragColor = weightsTexture * gaussianKDE(2. * dist);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,aw=`#version 300 es
uniform sampler2D inTexture;
uniform float textureSize;
out vec4 outTexture;
void main()
{
int yIndex = gl_VertexID / int(textureSize);
int xIndex = gl_VertexID - (yIndex * int(textureSize));
vec2 uv = (0.5 + vec2(float(xIndex), float(yIndex))) / textureSize;
outTexture = texture(inTexture, uv);
gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
gl_PointSize = 1.0;
}
`,lw=`#version 300 es
in vec4 outTexture;
out vec4 fragColor;
void main() {
fragColor = outTexture;
fragColor.g = outTexture.r / max(1.0, outTexture.a);
}
`,cw=2,Vi={format:"rgba8unorm",mipmaps:!1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}},Dl=[0,0],uw={SUM:0,MEAN:1},fw={getPosition:{type:"accessor",value:t=>t.position},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:Af,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},dw=["float32-renderable-webgl","texture-blend-float-webgl"],hw={data:{props:["radiusPixels"]}},oi=class oi extends Gr{initializeState(){super.initializeAggregationLayer(hw),this.setState({colorDomain:Dl}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){super.updateState(e),this._updateHeatmapState(e)}_updateHeatmapState(e){const{props:n,oldProps:r}=e,i=this._getChangeFlags(e);(i.dataChanged||i.viewportChanged)&&(i.boundsChanged=this._updateBounds(i.dataChanged),this._updateTextureRenderingBounds()),i.dataChanged||i.boundsChanged?(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0})):i.viewportZoomChanged&&this._debouncedUpdateWeightmap(),n.colorRange!==r.colorRange&&this._updateColorTexture(e),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:e.context.viewport.zoom})}renderLayers(){const{weightsTexture:e,triPositionBuffer:n,triTexCoordBuffer:r,maxWeightsTexture:i,colorTexture:o,colorDomain:s}=this.state,{updateTriggers:a,intensity:l,threshold:c,aggregation:u}=this.props,f=this.getSubLayerClass("triangle",Mo);return new f(this.getSubLayerProps({id:"triangle-layer",updateTriggers:a}),{coordinateSystem:gt.DEFAULT,data:{attributes:{positions:n,texCoords:r}},vertexCount:4,maxTexture:i,colorTexture:o,aggregationMode:uw[u]||0,weightsTexture:e,intensity:l,threshold:c,colorDomain:s})}finalizeState(e){super.finalizeState(e);const{weightsTransform:n,weightsTexture:r,maxWeightTransform:i,maxWeightsTexture:o,triPositionBuffer:s,triTexCoordBuffer:a,colorTexture:l,updateTimer:c}=this.state;n==null||n.destroy(),r==null||r.destroy(),i==null||i.destroy(),o==null||o.destroy(),s==null||s.destroy(),a==null||a.destroy(),l==null||l.destroy(),c&&clearTimeout(c)}_getAttributeManager(){return new tc(this.context.device,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(e){const n={},{dimensions:r}=this.state;n.dataChanged=this.isAttributeChanged()&&"attribute changed"||this.isAggregationDirty(e,{compareAll:!0,dimension:r.data})&&"aggregation is dirty",n.viewportChanged=e.changeFlags.viewportChanged;const{zoom:i}=this.state;return(!e.context.viewport||e.context.viewport.zoom!==i)&&(n.viewportZoomChanged=!0),n}_createTextures(){const{textureSize:e,format:n}=this.state;this.setState({weightsTexture:this.context.device.createTexture({...Vi,width:e,height:e,format:n}),maxWeightsTexture:this.context.device.createTexture({...Vi,width:1,height:1,format:n})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:"float64",accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}_setupTextureParams(){const{device:e}=this.context,{weightsTextureSize:n}=this.props,r=Math.min(n,e.limits.maxTextureDimension2D),i=dw.every(a=>e.features.has(a)),o=i?"rgba32float":"rgba8unorm",s=i?1:1/255;this.setState({textureSize:r,format:o,weightsScale:s}),i||Be.warn(`HeatmapLayer: ${this.id} rendering to float texture not supported, falling back to low precision format`)()}_createWeightsTransform(e){let{weightsTransform:n}=this.state;const{weightsTexture:r}=this.state,i=this.getAttributeManager();n==null||n.destroy(),n=new Os(this.context.device,{id:`${this.id}-weights-transform`,bufferLayout:i.getBufferLayouts(),vertexCount:1,targetTexture:r,parameters:{depthWriteEnabled:!1,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"},topology:"point-list",...e}),this.setState({weightsTransform:n})}_setupResources(){this._createTextures();const{device:e}=this.context,{textureSize:n,weightsTexture:r,maxWeightsTexture:i}=this.state,o=this.getShaders({vs:Ll,fs:Ml});this._createWeightsTransform(o);const s=this.getShaders({vs:aw,fs:lw}),a=new Os(e,{id:`${this.id}-max-weights-transform`,bindings:{inTexture:r},uniforms:{textureSize:n},targetTexture:i,...s,vertexCount:n*n,topology:"point-list",parameters:{depthWriteEnabled:!1,blendColorOperation:"max",blendAlphaOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}});this.setState({weightsTexture:r,maxWeightsTexture:i,maxWeightTransform:a,zoom:null,triPositionBuffer:e.createBuffer({byteLength:48}),triTexCoordBuffer:e.createBuffer({byteLength:48})})}updateShaders(e){this._createWeightsTransform({vs:Ll,fs:Ml,...e})}_updateMaxWeightValue(){const{maxWeightTransform:e}=this.state;e.run({parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]})}_updateBounds(e=!1){const{viewport:n}=this.context,r=[n.unproject([0,0]),n.unproject([n.width,0]),n.unproject([n.width,n.height]),n.unproject([0,n.height])].map(a=>a.map(Math.fround)),i=tw(r),o={visibleWorldBounds:i,viewportCorners:r};let s=!1;if(e||!this.state.worldBounds||!nw(this.state.worldBounds,i)){const a=this._worldToCommonBounds(i),l=this._commonToWorldBounds(a);this.props.coordinateSystem===gt.LNGLAT&&(l[1]=Math.max(l[1],-85.051129),l[3]=Math.min(l[3],85.051129),l[0]=Math.max(l[0],-360),l[2]=Math.min(l[2],360));const c=this._worldToCommonBounds(l);o.worldBounds=l,o.normalizedCommonBounds=c,s=!0}return this.setState(o),s}_updateTextureRenderingBounds(){const{triPositionBuffer:e,triTexCoordBuffer:n,normalizedCommonBounds:r,viewportCorners:i}=this.state,{viewport:o}=this.context;e.write(Il(i,3));const s=i.map(a=>iw(o.projectPosition(a),r));n.write(Il(s,2))}_updateColorTexture(e){const{colorRange:n}=e.props;let{colorTexture:r}=this.state;const i=E_(n,!1,Uint8Array);r&&(r==null?void 0:r.width)===n.length?r.setSubImageData({data:i}):(r==null||r.destroy(),r=this.context.device.createTexture({...Vi,data:i,width:n.length,height:1})),this.setState({colorTexture:r})}_updateWeightmap(){const{radiusPixels:e,colorDomain:n,aggregation:r}=this.props,{worldBounds:i,textureSize:o,weightsScale:s}=this.state,a=this.state.weightsTransform;this.state.isWeightMapDirty=!1;const l=this._worldToCommonBounds(i,{useLayerCoordinateSystem:!0});if(n&&r==="SUM"){const{viewport:h}=this.context,g=h.distanceScales.metersPerUnit[2]*(l[2]-l[0])/o;this.state.colorDomain=n.map(p=>p*g*s)}else this.state.colorDomain=n||Dl;const u=this.getAttributeManager().getAttributes(),f=this.getModuleSettings(),d={radiusPixels:e,commonBounds:l,textureWidth:o,weightsScale:s};this._setModelAttributes(a.model,u),a.model.setVertexCount(this.getNumInstances()),a.model.setUniforms(d),a.model.updateModuleSettings(f),a.run({parameters:{viewport:[0,0,o,o]},clearColor:[0,0,0,0]}),this._updateMaxWeightValue()}_debouncedUpdateWeightmap(e=!1){let{updateTimer:n}=this.state;const{debounceTimeout:r}=this.props;e?(n=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(n),n=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),r)),this.setState({updateTimer:n})}_worldToCommonBounds(e,n={}){const{useLayerCoordinateSystem:r=!1}=n,[i,o,s,a]=e,{viewport:l}=this.context,{textureSize:c}=this.state,{coordinateSystem:u}=this.props,f=r&&(u===gt.LNGLAT_OFFSETS||u===gt.METER_OFFSETS),d=f?l.projectPosition(this.props.coordinateOrigin):[0,0],h=c*cw/l.scale;let g,p;return r&&!f?(g=this.projectPosition([i,o,0]),p=this.projectPosition([s,a,0])):(g=l.projectPosition([i,o,0]),p=l.projectPosition([s,a,0])),rw([g[0]-d[0],g[1]-d[1],p[0]-d[0],p[1]-d[1]],h,h)}_commonToWorldBounds(e){const[n,r,i,o]=e,{viewport:s}=this.context,a=s.unprojectPosition([n,r]),l=s.unprojectPosition([i,o]);return a.slice(0,2).concat(l.slice(0,2))}};oi.layerName="HeatmapLayer",oi.defaultProps=fw;let Do=oi;function dr(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}class pw{constructor(e){this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:o,id:s,bbox:a,userData:l,zoom:c}=this,u=this._loaderId;this._abortController=new AbortController;const{signal:f}=this._abortController,d=await n.scheduleRequest(this,p=>p.isSelected?1:-1);if(!d){this._isCancelled=!0;return}if(this._isCancelled){d.done();return}let h=null,g;try{h=await e({index:o,id:s,bbox:a,userData:l,zoom:c,signal:f})}catch(p){g=p||!0}finally{d.done()}if(u===this._loaderId){if(this._loader=void 0,this.content=h,this._isCancelled&&!h){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,g?i(g,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)==null||e.abort())}}const Ie={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},zl=new oe,gw=new oe;class ms{constructor(e=[0,0,0],n=[0,0,0],r){r=r||zl.copy(e).add(n).scale(.5),this.center=new oe(r),this.halfDiagonal=new oe(n).subtract(this.center),this.minimum=new oe(e),this.maximum=new oe(n)}clone(){return new ms(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=gw.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),o=this.center.dot(r)+e.distance;return o-i>0?Ie.INSIDE:o+i<0?Ie.OUTSIDE:Ie.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=zl.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,o;return o=Math.abs(n.x)-r.x,o>0&&(i+=o*o),o=Math.abs(n.y)-r.y,o>0&&(i+=o*o),o=Math.abs(n.z)-r.z,o>0&&(i+=o*o),i}}const Cn=new oe,Nl=new oe;class ys{constructor(e=[0,0,0],n=0){this.radius=-0,this.center=new oe,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Cn.from(n),this.center=new oe().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new ys(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,o=e.radius,s=Cn.copy(i).subtract(n),a=s.magnitude();if(r>=a+o)return this.clone();if(o>=a+r)return e.clone();const l=(r+a+o)*.5;return Nl.copy(s).scale((-r+l)/a).add(n),this.center.copy(Nl),this.radius=l,this}expand(e){const r=Cn.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=ed(Cn,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Cn.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,o=e.normal.dot(n)+e.distance;return o<-r?Ie.OUTSIDE:o<r?Ie.INTERSECTING:Ie.INSIDE}}const mw=new oe,yw=new oe,hr=new oe,pr=new oe,gr=new oe,vw=new oe,bw=new oe,dt={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class vs{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){this.center=new oe().from(e),this.halfAxes=new $e(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new oe(e).len(),new oe(n).len(),new oe(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new oe(e).normalize(),o=new oe(n).normalize(),s=new oe(r).normalize();return new ks().fromMatrix3(new $e([...i,...o,...s]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new ks(r),o=new $e().fromQuaternion(i);return o[0]=o[0]*n[0],o[1]=o[1]*n[0],o[2]=o[2]*n[0],o[3]=o[3]*n[1],o[4]=o[4]*n[1],o[5]=o[5]*n[1],o[6]=o[6]*n[2],o[7]=o[7]*n[2],o[8]=o[8]*n[2],this.center=new oe().from(e),this.halfAxes=o,this}clone(){return new vs(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new ys){const n=this.halfAxes,r=n.getColumn(0,hr),i=n.getColumn(1,pr),o=n.getColumn(2,gr),s=mw.copy(r).add(i).add(o);return e.center.copy(this.center),e.radius=s.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,o=r.x,s=r.y,a=r.z,l=Math.abs(o*i[dt.COLUMN0ROW0]+s*i[dt.COLUMN0ROW1]+a*i[dt.COLUMN0ROW2])+Math.abs(o*i[dt.COLUMN1ROW0]+s*i[dt.COLUMN1ROW1]+a*i[dt.COLUMN1ROW2])+Math.abs(o*i[dt.COLUMN2ROW0]+s*i[dt.COLUMN2ROW1]+a*i[dt.COLUMN2ROW2]),c=r.dot(n)+e.distance;return c<=-l?Ie.OUTSIDE:c>=l?Ie.INSIDE:Ie.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=yw.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,hr),o=r.getColumn(1,pr),s=r.getColumn(2,gr),a=i.magnitude(),l=o.magnitude(),c=s.magnitude();i.normalize(),o.normalize(),s.normalize();let u=0,f;return f=Math.abs(n.dot(i))-a,f>0&&(u+=f*f),f=Math.abs(n.dot(o))-l,f>0&&(u+=f*f),f=Math.abs(n.dot(s))-c,f>0&&(u+=f*f),u}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;const s=this.center,a=this.halfAxes,l=a.getColumn(0,hr),c=a.getColumn(1,pr),u=a.getColumn(2,gr),f=vw.copy(l).add(c).add(u).add(s),d=bw.copy(f).subtract(e);let h=n.dot(d);return i=Math.min(h,i),o=Math.max(h,o),f.copy(s).add(l).add(c).subtract(u),d.copy(f).subtract(e),h=n.dot(d),i=Math.min(h,i),o=Math.max(h,o),f.copy(s).add(l).subtract(c).add(u),d.copy(f).subtract(e),h=n.dot(d),i=Math.min(h,i),o=Math.max(h,o),f.copy(s).add(l).subtract(c).subtract(u),d.copy(f).subtract(e),h=n.dot(d),i=Math.min(h,i),o=Math.max(h,o),s.copy(f).subtract(l).add(c).add(u),d.copy(f).subtract(e),h=n.dot(d),i=Math.min(h,i),o=Math.max(h,o),s.copy(f).subtract(l).add(c).subtract(u),d.copy(f).subtract(e),h=n.dot(d),i=Math.min(h,i),o=Math.max(h,o),s.copy(f).subtract(l).subtract(c).add(u),d.copy(f).subtract(e),h=n.dot(d),i=Math.min(h,i),o=Math.max(h,o),s.copy(f).subtract(l).subtract(c).subtract(u),d.copy(f).subtract(e),h=n.dot(d),i=Math.min(h,i),o=Math.max(h,o),r[0]=i,r[1]=o,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,hr);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,pr);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,gr);return i.transformAsPoint(e),this.halfAxes=new $e([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const $l=new oe,Fl=new oe;class jn{constructor(e=[0,0,1],n=0){this.normal=new oe,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return Hi(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=$l.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),Hi(yr(this.normal.len(),1)),this.distance=i,this}clone(){return new jn(this.normal,this.distance)}equals(e){return yr(this.distance,e.distance)&&yr(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=Fl.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){const r=$l.from(e),i=this.getPointDistance(r),o=Fl.copy(this.normal).scale(i);return r.subtract(o).to(n)}}const Bl=[new oe([1,0,0]),new oe([0,1,0]),new oe([0,0,1])],jl=new oe,xw=new oe;class mt{constructor(e=[]){this.planes=e}fromBoundingSphere(e){this.planes.length=2*Bl.length;const n=e.center,r=e.radius;let i=0;for(const o of Bl){let s=this.planes[i],a=this.planes[i+1];s||(s=this.planes[i]=new jn),a||(a=this.planes[i+1]=new jn);const l=jl.copy(o).scale(-r).add(n);s.fromPointNormal(l,o);const c=jl.copy(o).scale(r).add(n),u=xw.copy(o).negate();a.fromPointNormal(c,u),i+=2}return this}computeVisibility(e){let n=Ie.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case Ie.OUTSIDE:return Ie.OUTSIDE;case Ie.INTERSECTING:n=Ie.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(Hi(Number.isFinite(n),"parentPlaneMask is required."),n===mt.MASK_OUTSIDE||n===mt.MASK_INSIDE)return n;let r=mt.MASK_INSIDE;const i=this.planes;for(let o=0;o<this.planes.length;++o){const s=o<31?1<<o:0;if(o<31&&!(n&s))continue;const a=i[o],l=e.intersectPlane(a);if(l===Ie.OUTSIDE)return mt.MASK_OUTSIDE;l===Ie.INTERSECTING&&(r|=s)}return r}}mt.MASK_OUTSIDE=4294967295;mt.MASK_INSIDE=0;mt.MASK_INDETERMINATE=2147483647;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;new oe;const ot=new $e,_w=new $e,ww=new $e,mr=new $e,Ul=new $e;function Sw(t,e={}){const n=td,r=10;let i=0,o=0;const s=_w,a=ww;s.identity(),a.copy(t);const l=n*Cw(a);for(;o<r&&Ew(a)>l;)Pw(a,mr),Ul.copy(mr).transpose(),a.multiplyRight(mr),a.multiplyLeft(Ul),s.multiplyRight(mr),++i>2&&(++o,i=0);return e.unitary=s.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function Cw(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const zo=[1,0,0],No=[2,2,1];function Ew(t){let e=0;for(let n=0;n<3;++n){const r=t[ot.getElementIndex(No[n],zo[n])];e+=2*r*r}return Math.sqrt(e)}function Pw(t,e){const n=nd;let r=0,i=1;for(let c=0;c<3;++c){const u=Math.abs(t[ot.getElementIndex(No[c],zo[c])]);u>r&&(i=c,r=u)}const o=zo[i],s=No[i];let a=1,l=0;if(Math.abs(t[ot.getElementIndex(s,o)])>n){const c=t[ot.getElementIndex(s,s)],u=t[ot.getElementIndex(o,o)],f=t[ot.getElementIndex(s,o)],d=(c-u)/2/f;let h;d<0?h=-1/(-d+Math.sqrt(1+d*d)):h=1/(d+Math.sqrt(1+d*d)),a=1/Math.sqrt(1+h*h),l=h*a}return $e.IDENTITY.to(e),e[ot.getElementIndex(o,o)]=e[ot.getElementIndex(s,s)]=a,e[ot.getElementIndex(s,o)]=l,e[ot.getElementIndex(o,s)]=-l,e}const Et=new oe,Aw=new oe,Tw=new oe,Ow=new oe,kw=new oe,Rw=new $e,Iw={diagonal:new $e,unitary:new $e};function Lw(t,e=new vs){if(!t||t.length===0)return e.halfAxes=new $e([0,0,0,0,0,0,0,0,0]),e.center=new oe,e;const n=t.length,r=new oe(0,0,0);for(const k of t)r.add(k);const i=1/n;r.multiplyByScalar(i);let o=0,s=0,a=0,l=0,c=0,u=0;for(const k of t){const M=Et.copy(k).subtract(r);o+=M.x*M.x,s+=M.x*M.y,a+=M.x*M.z,l+=M.y*M.y,c+=M.y*M.z,u+=M.z*M.z}o*=i,s*=i,a*=i,l*=i,c*=i,u*=i;const f=Rw;f[0]=o,f[1]=s,f[2]=a,f[3]=s,f[4]=l,f[5]=c,f[6]=a,f[7]=c,f[8]=u;const{unitary:d}=Sw(f,Iw),h=e.halfAxes.copy(d);let g=h.getColumn(0,Tw),p=h.getColumn(1,Ow),m=h.getColumn(2,kw),y=-Number.MAX_VALUE,b=-Number.MAX_VALUE,_=-Number.MAX_VALUE,w=Number.MAX_VALUE,C=Number.MAX_VALUE,O=Number.MAX_VALUE;for(const k of t)Et.copy(k),y=Math.max(Et.dot(g),y),b=Math.max(Et.dot(p),b),_=Math.max(Et.dot(m),_),w=Math.min(Et.dot(g),w),C=Math.min(Et.dot(p),C),O=Math.min(Et.dot(m),O);g=g.multiplyByScalar(.5*(w+y)),p=p.multiplyByScalar(.5*(C+b)),m=m.multiplyByScalar(.5*(O+_)),e.center.copy(g).add(p).add(m);const T=Aw.set(y-w,b-C,_-O).multiplyByScalar(.5),I=new $e([T[0],0,0,0,T[1],0,0,0,T[2]]);return e.halfAxes.multiplyRight(I),e}const nn=512,Wl=3,Mf=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Df=Mf.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Mw=Df.concat([[.25,.5],[.75,.5]]);class rn{constructor(e,n,r){this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new rn(e,n,r),new rn(e,n+1,r),new rn(e+1,n,r),new rn(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:o,maxZ:s,bounds:a,offset:l,project:c}=e,u=this.getBoundingVolume(i,l,c);if(a&&!this.insideBounds(a)||r.computeVisibility(u)<0)return!1;if(!this.childVisible){let{z:d}=this;if(d<s&&d>=o){const h=u.distanceTo(n.cameraPosition)*n.scale/n.height;d+=Math.floor(Math.log2(h))}if(d>=s)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const d of this.children)d.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const o=Math.pow(2,this.z),s=nn/o;return this.x*s<r&&this.y*s<i&&(this.x+1)*s>e&&(this.y+1)*s>n}getBoundingVolume(e,n,r){if(r){const l=this.z<1?Mw:this.z<2?Df:Mf,c=[];for(const u of l){const f=Fo(this.x+u[0],this.y+u[1],this.z);f[2]=e[0],c.push(r(f)),e[0]!==e[1]&&(f[2]=e[1],c.push(r(f)))}return Lw(c)}const i=Math.pow(2,this.z),o=nn/i,s=this.x*o+n*nn,a=nn-(this.y+1)*o;return new ms([s,a,e[0]],[s+o,a+o,e[1]])}}function Dw(t,e,n,r){const i=t instanceof rd&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map(({normal:h,distance:g})=>new jn(h.clone().negate(),g)),s=new mt(o),a=t.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,c=n&&n[1]*a||0,u=t instanceof Rs&&t.pitch<=60?e:0;if(r){const[h,g,p,m]=r,y=Cr([h,m]),b=Cr([p,g]);r=[y[0],nn-y[1],b[0],nn-b[1]]}const f=new rn(0,0,0),d={viewport:t,project:i,cullingVolume:s,elevationBounds:[l,c],minZ:u,maxZ:e,bounds:r,offset:0};if(f.update(d),t instanceof Rs&&t.subViewports&&t.subViewports.length>1){for(d.offset=-1;f.update(d)&&!(--d.offset<-Wl););for(d.offset=1;f.update(d)&&!(++d.offset>Wl););}return f.getSelected()}const _t=512,zw=[-1/0,-1/0,1/0,1/0],Nw={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function zf(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function $w(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function Fw(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const o=$w(r)%t.length;t=t[o]}let i=t;for(const o of Object.keys(n)){const s=new RegExp(`{${o}}`,"g");i=i.replace(s,String(n[o]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function Bw(t,e,n){let r;return r=t.getBounds(),t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function jw({viewport:t,z:e,cullRect:n}){return(t.subViewports||[t]).map(i=>$o(i,e||0,n))}function $o(t,e,n){if(!Array.isArray(e)){const o=n.x-t.x,s=n.y-t.y,{width:a,height:l}=n,c={targetZ:e},u=t.unproject([o,s],c),f=t.unproject([o+a,s],c),d=t.unproject([o,s+l],c),h=t.unproject([o+a,s+l],c);return[Math.min(u[0],f[0],d[0],h[0]),Math.min(u[1],f[1],d[1],h[1]),Math.max(u[0],f[0],d[0],h[0]),Math.max(u[1],f[1],d[1],h[1])]}const r=$o(t,e[0],n),i=$o(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function Uw(t,e,n){return n?zf(t,n).map(i=>i*e/_t):t.map(r=>r*e/_t)}function bs(t,e){return Math.pow(2,t)*_t/e}function Fo(t,e,n){const r=bs(n,_t),i=t/r*360-180,o=Math.PI-2*Math.PI*e/r,s=180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)));return[i,s]}function Vl(t,e,n,r){const i=bs(n,r);return[t/i*_t,e/i*_t]}function Ww(t,e,n,r,i=_t){if(t.isGeospatial){const[c,u]=Fo(e,n,r),[f,d]=Fo(e+1,n+1,r);return{west:c,north:u,east:f,south:d}}const[o,s]=Vl(e,n,r,i),[a,l]=Vl(e+1,n+1,r,i);return{left:o,top:s,right:a,bottom:l}}function Vw(t,e,n,r,i){const o=Bw(t,null,r),s=bs(e,n),[a,l,c,u]=Uw(o,s,i),f=[];for(let d=Math.floor(a);d<c;d++)for(let h=Math.floor(l);h<u;h++)f.push({x:d,y:h,z:e});return f}function Hw({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:o=_t,modelMatrix:s,modelMatrixInverse:a,zoomOffset:l=0}){let c=t.isGeospatial?Math.round(t.zoom+Math.log2(_t/o))+l:Math.ceil(t.zoom)+l;if(typeof n=="number"&&Number.isFinite(n)&&c<n){if(!i)return[];c=n}typeof e=="number"&&Number.isFinite(e)&&c>e&&(c=e);let u=i;return s&&a&&i&&!t.isGeospatial&&(u=zf(i,s)),t.isGeospatial?Dw(t,c,r,i):Vw(t,c,o,u||zw,a)}function Gw(t){let e={},n;return r=>{for(const i in r)if(!Kw(r[i],e[i])){n=t(r),e=r;break}return n}}function Kw(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}const Hl=1,Si=2,Zw="never",Yw="no-overlap",xs="best-available",qw=5,Xw={[xs]:eS,[Yw]:tS,[Zw]:()=>{}},Jw={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class Qw{constructor(e){this._getCullBounds=Gw(jw),this.opts={...Jw,...e},this.setOptions(this.opts),this.onTileLoad=n=>{var r,i;(i=(r=this.opts).onTileLoad)==null||i.call(r,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new id({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Jn,this._modelMatrixInverse=new Jn}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={zRange:null,modelMatrix:null}){const i=r?new Jn(r):new Jn,o=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!yr(this._zRange,n)||o){o&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(l=>this._getTile(l,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const s=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const r=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:i}=e;for(const[o,s,a,l]of r){let c;if("west"in i)c=i.west<a&&i.east>o&&i.south<l&&i.north>s;else{const u=Math.min(i.top,i.bottom),f=Math.max(i.top,i.bottom);c=i.left<a&&i.right>o&&u<l&&f>s}if(c)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:o,modelMatrixInverse:s}){const{tileSize:a,extent:l,zoomOffset:c}=this.opts;return Hw({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:a,extent:l,modelMatrix:o,modelMatrixInverse:s,zoomOffset:c})}getTileId(e){return`${e.x}-${e.y}-${e.z}`}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:Ww(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||xs,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:Xw[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){var s,a;const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:qw*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[l,c]of e)if(!c.isVisible&&!c.isSelected&&(this._cacheByteSize-=n.maxCacheByteSize?c.byteLength:0,e.delete(l),(a=(s=this.opts).onTileUnload)==null||a.call(s,c)),e.size<=r&&this._cacheByteSize<=i)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((l,c)=>l.zoom-c.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),o=!1;return!i&&n?(i=new pw(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),o=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(o=!0),i&&o&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function eS(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!Nf(e)&&_s(e);for(const e of t)e.isVisible=!!(e.state&Si)}function tS(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&Nf(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=!!(n.state&Si),n.children&&(n.isVisible||n.state&Hl))for(const r of n.children)r.state=Hl;else n.isSelected&&_s(n)}function Nf(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=Si,!0;e=e.parent}return!1}function _s(t){for(const e of t.children)e.isLoaded||e.content?e.state|=Si:_s(e)}const nS={TilesetClass:Qw,data:{type:"data",value:[]},dataComparator:Nw.equal,renderSubLayers:{type:"function",value:t=>new Hr(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:xs,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0},si=class si extends ci{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(n=(e=this.state)==null?void 0:e.tileset)==null||n.finalize()}get isLoaded(){var e,n,r;return!!((r=(n=(e=this.state)==null?void 0:e.tileset)==null?void 0:n.selectedTiles)!=null&&r.every(i=>i.isLoaded&&i.layers&&i.layers.every(o=>o.isLoaded)))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():n.tiles.forEach(o=>{o.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:o,maxZoom:s,minZoom:a,maxRequests:l,debounceTime:c,zoomOffset:u}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:s,minZoom:a,tileSize:e,refinementStrategy:i,extent:o,maxRequests:l,debounceTime:c,zoomOffset:u,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const e=this.state.tileset,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:o}=e,s=this.state.isLoaded!==o,a=this.state.frameNumber!==i;o&&(s||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:i}),this.state.isLoaded=o}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:o}=e;return e.url=typeof n=="string"||Array.isArray(n)?Fw(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:o}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo(e){const n=e.sourceLayer,r=n.props.tile,i=e.info;return i.picked&&(i.tile=r),i.sourceTile=r,i.sourceTileSubLayer=n,i}_updateAutoHighlight(e){e.sourceTileSubLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=od(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}};si.defaultProps=nS,si.layerName="TileLayer";let Bo=si;var $f={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(c,u){if(!i[c]){if(!r[c]){var f=typeof dr=="function"&&dr;if(!u&&f)return f(c,!0);if(a)return a(c,!0);var d=new Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[c]={exports:{}};r[c][0].call(h.exports,function(g){var p=r[c][1][g];return s(p||g)},h,h.exports,n,r,i,o)}return i[c].exports}for(var a=typeof dr=="function"&&dr,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){var o=n("./utils"),s=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var c,u,f,d,h,g,p,m=[],y=0,b=l.length,_=b,w=o.getTypeOf(l)!=="string";y<l.length;)_=b-y,f=w?(c=l[y++],u=y<b?l[y++]:0,y<b?l[y++]:0):(c=l.charCodeAt(y++),u=y<b?l.charCodeAt(y++):0,y<b?l.charCodeAt(y++):0),d=c>>2,h=(3&c)<<4|u>>4,g=1<_?(15&u)<<2|f>>6:64,p=2<_?63&f:64,m.push(a.charAt(d)+a.charAt(h)+a.charAt(g)+a.charAt(p));return m.join("")},i.decode=function(l){var c,u,f,d,h,g,p=0,m=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var b,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&_--,l.charAt(l.length-2)===a.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(b=s.uint8array?new Uint8Array(0|_):new Array(0|_);p<l.length;)c=a.indexOf(l.charAt(p++))<<2|(d=a.indexOf(l.charAt(p++)))>>4,u=(15&d)<<4|(h=a.indexOf(l.charAt(p++)))>>2,f=(3&h)<<6|(g=a.indexOf(l.charAt(p++))),b[m++]=c,h!==64&&(b[m++]=u),g!==64&&(b[m++]=f);return b}},{"./support":30,"./utils":32}],2:[function(n,r,i){var o=n("./external"),s=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,f,d,h,g){this.compressedSize=u,this.uncompressedSize=f,this.crc32=d,this.compression=h,this.compressedContent=g}c.prototype={getContentWorker:function(){var u=new s(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new s(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,f,d){return u.pipe(new a).pipe(new l("uncompressedSize")).pipe(f.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,i){var o=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,i){var o=n("./utils"),s=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();r.exports=function(a,l){return a!==void 0&&a.length?o.getTypeOf(a)!=="string"?function(c,u,f,d){var h=s,g=d+f;c^=-1;for(var p=d;p<g;p++)c=c>>>8^h[255&(c^u[p])];return-1^c}(0|l,a,a.length,0):function(c,u,f,d){var h=s,g=d+f;c^=-1;for(var p=d;p<g;p++)c=c>>>8^h[255&(c^u.charCodeAt(p))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(n,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,r,i){var o=null;o=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:o}},{lie:37}],7:[function(n,r,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=n("pako"),a=n("./utils"),l=n("./stream/GenericWorker"),c=o?"uint8array":"array";function u(f,d){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=d,this.meta={}}i.magic="\b\0",a.inherits(u,l),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,f.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(d){f.push({data:d,meta:f.meta})}},i.compressWorker=function(f){return new u("Deflate",f)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,i){function o(h,g){var p,m="";for(p=0;p<g;p++)m+=String.fromCharCode(255&h),h>>>=8;return m}function s(h,g,p,m,y,b){var _,w,C=h.file,O=h.compression,T=b!==c.utf8encode,I=a.transformTo("string",b(C.name)),k=a.transformTo("string",c.utf8encode(C.name)),M=C.comment,j=a.transformTo("string",b(M)),S=a.transformTo("string",c.utf8encode(M)),L=k.length!==C.name.length,x=S.length!==M.length,z="",q="",W="",X=C.dir,V=C.date,te={crc32:0,compressedSize:0,uncompressedSize:0};g&&!p||(te.crc32=h.crc32,te.compressedSize=h.compressedSize,te.uncompressedSize=h.uncompressedSize);var N=0;g&&(N|=8),T||!L&&!x||(N|=2048);var $=0,ee=0;X&&($|=16),y==="UNIX"?(ee=798,$|=function(J,ge){var _e=J;return J||(_e=ge?16893:33204),(65535&_e)<<16}(C.unixPermissions,X)):(ee=20,$|=function(J){return 63&(J||0)}(C.dosPermissions)),_=V.getUTCHours(),_<<=6,_|=V.getUTCMinutes(),_<<=5,_|=V.getUTCSeconds()/2,w=V.getUTCFullYear()-1980,w<<=4,w|=V.getUTCMonth()+1,w<<=5,w|=V.getUTCDate(),L&&(q=o(1,1)+o(u(I),4)+k,z+="up"+o(q.length,2)+q),x&&(W=o(1,1)+o(u(j),4)+S,z+="uc"+o(W.length,2)+W);var Q="";return Q+=`
\0`,Q+=o(N,2),Q+=O.magic,Q+=o(_,2),Q+=o(w,2),Q+=o(te.crc32,4),Q+=o(te.compressedSize,4),Q+=o(te.uncompressedSize,4),Q+=o(I.length,2),Q+=o(z.length,2),{fileRecord:f.LOCAL_FILE_HEADER+Q+I+z,dirRecord:f.CENTRAL_FILE_HEADER+o(ee,2)+Q+o(j.length,2)+"\0\0\0\0"+o($,4)+o(m,4)+I+z+j}}var a=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),f=n("../signature");function d(h,g,p,m){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=p,this.encodeFileName=m,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,l),d.prototype.push=function(h){var g=h.meta.percent||0,p=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,l.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:p?(g+100*(p-m-1))/p:100}}))},d.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var g=this.streamFiles&&!h.file.dir;if(g){var p=s(h,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(h){this.accumulate=!1;var g=this.streamFiles&&!h.file.dir,p=s(h,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),g)this.push({data:function(m){return f.DATA_DESCRIPTOR+o(m.crc32,4)+o(m.compressedSize,4)+o(m.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var h=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var p=this.bytesWritten-h,m=function(y,b,_,w,C){var O=a.transformTo("string",C(w));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(y,2)+o(y,2)+o(b,4)+o(_,4)+o(O.length,2)+O}(this.dirRecords.length,p,h,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(h){this._sources.push(h);var g=this;return h.on("data",function(p){g.processChunk(p)}),h.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),h.on("error",function(p){g.error(p)}),this},d.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(h){var g=this._sources;if(!l.prototype.error.call(this,h))return!1;for(var p=0;p<g.length;p++)try{g[p].error(h)}catch{}return!0},d.prototype.lock=function(){l.prototype.lock.call(this);for(var h=this._sources,g=0;g<h.length;g++)h[g].lock()},r.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,i){var o=n("../compressions"),s=n("./ZipFileWorker");i.generateWorker=function(a,l,c){var u=new s(l.streamFiles,c,l.platform,l.encodeFileName),f=0;try{a.forEach(function(d,h){f++;var g=function(b,_){var w=b||_,C=o[w];if(!C)throw new Error(w+" is not a valid compression method !");return C}(h.options.compression,l.compression),p=h.options.compressionOptions||l.compressionOptions||{},m=h.dir,y=h.date;h._compressWorker(g,p).withStreamInfo("file",{name:d,dir:m,date:y,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(d){u.error(d)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new o;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(o.prototype=n("./object")).loadAsync=n("./load"),o.support=n("./support"),o.defaults=n("./defaults"),o.version="3.10.1",o.loadAsync=function(s,a){return new o().loadAsync(s,a)},o.external=n("./external"),r.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,i){var o=n("./utils"),s=n("./external"),a=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function f(d){return new s.Promise(function(h,g){var p=d.decompressed.getContentWorker().pipe(new c);p.on("error",function(m){g(m)}).on("end",function(){p.streamInfo.crc32!==d.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}r.exports=function(d,h){var g=this;return h=o.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(d)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",d,!0,h.optimizedBinaryString,h.base64).then(function(p){var m=new l(h);return m.load(p),m}).then(function(p){var m=[s.Promise.resolve(p)],y=p.files;if(h.checkCRC32)for(var b=0;b<y.length;b++)m.push(f(y[b]));return s.Promise.all(m)}).then(function(p){for(var m=p.shift(),y=m.files,b=0;b<y.length;b++){var _=y[b],w=_.fileNameStr,C=o.resolve(_.fileNameStr);g.file(C,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:h.createFolders}),_.dir||(g.file(C).unsafeOriginalName=w)}return m.zipComment.length&&(g.comment=m.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,i){var o=n("../utils"),s=n("../stream/GenericWorker");function a(l,c){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}o.inherits(a,s),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,i){var o=n("readable-stream").Readable;function s(a,l,c){o.call(this,l),this._helper=a;var u=this;a.on("data",function(f,d){u.push(f)||u._helper.pause(),c&&c(d)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}n("../utils").inherits(s,o),s.prototype._read=function(){this._helper.resume()},r.exports=s},{"../utils":32,"readable-stream":16}],14:[function(n,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,s);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,s)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var s=new Buffer(o);return s.fill(0),s},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(n,r,i){function o(C,O,T){var I,k=a.getTypeOf(O),M=a.extend(T||{},u);M.date=M.date||new Date,M.compression!==null&&(M.compression=M.compression.toUpperCase()),typeof M.unixPermissions=="string"&&(M.unixPermissions=parseInt(M.unixPermissions,8)),M.unixPermissions&&16384&M.unixPermissions&&(M.dir=!0),M.dosPermissions&&16&M.dosPermissions&&(M.dir=!0),M.dir&&(C=y(C)),M.createFolders&&(I=m(C))&&b.call(this,I,!0);var j=k==="string"&&M.binary===!1&&M.base64===!1;T&&T.binary!==void 0||(M.binary=!j),(O instanceof f&&O.uncompressedSize===0||M.dir||!O||O.length===0)&&(M.base64=!1,M.binary=!0,O="",M.compression="STORE",k="string");var S=null;S=O instanceof f||O instanceof l?O:g.isNode&&g.isStream(O)?new p(C,O):a.prepareContent(C,O,M.binary,M.optimizedBinaryString,M.base64);var L=new d(C,S,M);this.files[C]=L}var s=n("./utf8"),a=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),f=n("./compressedObject"),d=n("./zipObject"),h=n("./generate"),g=n("./nodejsUtils"),p=n("./nodejs/NodejsStreamInputAdapter"),m=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var O=C.lastIndexOf("/");return 0<O?C.substring(0,O):""},y=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},b=function(C,O){return O=O!==void 0?O:u.createFolders,C=y(C),this.files[C]||o.call(this,C,null,{dir:!0,createFolders:O}),this.files[C]};function _(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var O,T,I;for(O in this.files)I=this.files[O],(T=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&C(T,I)},filter:function(C){var O=[];return this.forEach(function(T,I){C(T,I)&&O.push(I)}),O},file:function(C,O,T){if(arguments.length!==1)return C=this.root+C,o.call(this,C,O,T),this;if(_(C)){var I=C;return this.filter(function(M,j){return!j.dir&&I.test(M)})}var k=this.files[this.root+C];return k&&!k.dir?k:null},folder:function(C){if(!C)return this;if(_(C))return this.filter(function(k,M){return M.dir&&C.test(k)});var O=this.root+C,T=b.call(this,O),I=this.clone();return I.root=T.name,I},remove:function(C){C=this.root+C;var O=this.files[C];if(O||(C.slice(-1)!=="/"&&(C+="/"),O=this.files[C]),O&&!O.dir)delete this.files[C];else for(var T=this.filter(function(k,M){return M.name.slice(0,C.length)===C}),I=0;I<T.length;I++)delete this.files[T[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var O,T={};try{if((T=a.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");a.checkSupport(T.type),T.platform!=="darwin"&&T.platform!=="freebsd"&&T.platform!=="linux"&&T.platform!=="sunos"||(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var I=T.comment||this.comment||"";O=h.generateWorker(this,T,I)}catch(k){(O=new l("error")).error(k)}return new c(O,T.type||"string",T.mimeType)},generateAsync:function(C,O){return this.generateInternalStream(C).accumulate(O)},generateNodeStream:function(C,O){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(O)}};r.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,i){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,i){var o=n("./DataReader");function s(a){o.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}n("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),f=a.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===l&&this.data[d+1]===c&&this.data[d+2]===u&&this.data[d+3]===f)return d-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),f=a.charCodeAt(3),d=this.readData(4);return l===d[0]&&c===d[1]&&u===d[2]&&f===d[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=s},{"../utils":32,"./DataReader":18}],18:[function(n,r,i){var o=n("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return o.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=s},{"../utils":32}],19:[function(n,r,i){var o=n("./Uint8ArrayReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,i){var o=n("./DataReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=s},{"../utils":32,"./DataReader":18}],21:[function(n,r,i){var o=n("./ArrayReader");function s(a){o.call(this,a)}n("../utils").inherits(s,o),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,i){var o=n("../utils"),s=n("../support"),a=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(f){var d=o.getTypeOf(f);return o.checkSupport(d),d!=="string"||s.uint8array?d==="nodebuffer"?new c(f):s.uint8array?new u(o.transformTo("uint8array",f)):new a(o.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,i){var o=n("./GenericWorker"),s=n("../utils");function a(l){o.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(a,o),a.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,i){var o=n("./GenericWorker"),s=n("../crc32");function a(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,o),a.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,i){var o=n("../utils"),s=n("./GenericWorker");function a(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(a,s),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}s.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,i){var o=n("../utils"),s=n("./GenericWorker");function a(l){s.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=o.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}o.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,i){function o(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(l){a.processChunk(l)}),s.on("end",function(){a.end()}),s.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},r.exports=o},{}],29:[function(n,r,i){var o=n("../utils"),s=n("./ConvertWorker"),a=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),f=null;if(c.nodestream)try{f=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(g,p){return new u.Promise(function(m,y){var b=[],_=g._internalType,w=g._outputType,C=g._mimeType;g.on("data",function(O,T){b.push(O),p&&p(T)}).on("error",function(O){b=[],y(O)}).on("end",function(){try{var O=function(T,I,k){switch(T){case"blob":return o.newBlob(o.transformTo("arraybuffer",I),k);case"base64":return l.encode(I);default:return o.transformTo(T,I)}}(w,function(T,I){var k,M=0,j=null,S=0;for(k=0;k<I.length;k++)S+=I[k].length;switch(T){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(j=new Uint8Array(S),k=0;k<I.length;k++)j.set(I[k],M),M+=I[k].length;return j;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+T+"'")}}(_,b),C);m(O)}catch(T){y(T)}b=[]}).resume()})}function h(g,p,m){var y=p;switch(p){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=p,this._mimeType=m,o.checkSupport(y),this._worker=g.pipe(new s(y)),g.lock()}catch(b){this._worker=new a("error"),this._worker.error(b)}}h.prototype={accumulate:function(g){return d(this,g)},on:function(g,p){var m=this;return g==="data"?this._worker.on(g,function(y){p.call(m,y.data,y.meta)}):this._worker.on(g,function(){o.delay(p,arguments,m)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},g)}},r.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(o),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,i){for(var o=n("./utils"),s=n("./support"),a=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function d(){l.call(this,"utf-8 encode")}i.utf8encode=function(h){return s.nodebuffer?a.newBufferFrom(h,"utf-8"):function(g){var p,m,y,b,_,w=g.length,C=0;for(b=0;b<w;b++)(64512&(m=g.charCodeAt(b)))==55296&&b+1<w&&(64512&(y=g.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),C+=m<128?1:m<2048?2:m<65536?3:4;for(p=s.uint8array?new Uint8Array(C):new Array(C),b=_=0;_<C;b++)(64512&(m=g.charCodeAt(b)))==55296&&b+1<w&&(64512&(y=g.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),m<128?p[_++]=m:(m<2048?p[_++]=192|m>>>6:(m<65536?p[_++]=224|m>>>12:(p[_++]=240|m>>>18,p[_++]=128|m>>>12&63),p[_++]=128|m>>>6&63),p[_++]=128|63&m);return p}(h)},i.utf8decode=function(h){return s.nodebuffer?o.transformTo("nodebuffer",h).toString("utf-8"):function(g){var p,m,y,b,_=g.length,w=new Array(2*_);for(p=m=0;p<_;)if((y=g[p++])<128)w[m++]=y;else if(4<(b=c[y]))w[m++]=65533,p+=b-1;else{for(y&=b===2?31:b===3?15:7;1<b&&p<_;)y=y<<6|63&g[p++],b--;1<b?w[m++]=65533:y<65536?w[m++]=y:(y-=65536,w[m++]=55296|y>>10&1023,w[m++]=56320|1023&y)}return w.length!==m&&(w.subarray?w=w.subarray(0,m):w.length=m),o.applyFromCharCode(w)}(h=o.transformTo(s.uint8array?"uint8array":"array",h))},o.inherits(f,l),f.prototype.processChunk=function(h){var g=o.transformTo(s.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var p=g;(g=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),g.set(p,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var m=function(b,_){var w;for((_=_||b.length)>b.length&&(_=b.length),w=_-1;0<=w&&(192&b[w])==128;)w--;return w<0||w===0?_:w+c[b[w]]>_?w:_}(g),y=g;m!==g.length&&(s.uint8array?(y=g.subarray(0,m),this.leftOver=g.subarray(m,g.length)):(y=g.slice(0,m),this.leftOver=g.slice(m,g.length))),this.push({data:i.utf8decode(y),meta:h.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,o.inherits(d,l),d.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,i){var o=n("./support"),s=n("./base64"),a=n("./nodejsUtils"),l=n("./external");function c(p){return p}function u(p,m){for(var y=0;y<p.length;++y)m[y]=255&p.charCodeAt(y);return m}n("setimmediate"),i.newBlob=function(p,m){i.checkSupport("blob");try{return new Blob([p],{type:m})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(p),y.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(p,m,y){var b=[],_=0,w=p.length;if(w<=y)return String.fromCharCode.apply(null,p);for(;_<w;)m==="array"||m==="nodebuffer"?b.push(String.fromCharCode.apply(null,p.slice(_,Math.min(_+y,w)))):b.push(String.fromCharCode.apply(null,p.subarray(_,Math.min(_+y,w)))),_+=y;return b.join("")},stringifyByChar:function(p){for(var m="",y=0;y<p.length;y++)m+=String.fromCharCode(p[y]);return m},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function d(p){var m=65536,y=i.getTypeOf(p),b=!0;if(y==="uint8array"?b=f.applyCanBeUsed.uint8array:y==="nodebuffer"&&(b=f.applyCanBeUsed.nodebuffer),b)for(;1<m;)try{return f.stringifyByChunk(p,y,m)}catch{m=Math.floor(m/2)}return f.stringifyByChar(p)}function h(p,m){for(var y=0;y<p.length;y++)m[y]=p[y];return m}i.applyFromCharCode=d;var g={};g.string={string:c,array:function(p){return u(p,new Array(p.length))},arraybuffer:function(p){return g.string.uint8array(p).buffer},uint8array:function(p){return u(p,new Uint8Array(p.length))},nodebuffer:function(p){return u(p,a.allocBuffer(p.length))}},g.array={string:d,array:c,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(p)}},g.arraybuffer={string:function(p){return d(new Uint8Array(p))},array:function(p){return h(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:c,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(new Uint8Array(p))}},g.uint8array={string:d,array:function(p){return h(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:c,nodebuffer:function(p){return a.newBufferFrom(p)}},g.nodebuffer={string:d,array:function(p){return h(p,new Array(p.length))},arraybuffer:function(p){return g.nodebuffer.uint8array(p).buffer},uint8array:function(p){return h(p,new Uint8Array(p.length))},nodebuffer:c},i.transformTo=function(p,m){if(m=m||"",!p)return m;i.checkSupport(p);var y=i.getTypeOf(m);return g[y][p](m)},i.resolve=function(p){for(var m=p.split("/"),y=[],b=0;b<m.length;b++){var _=m[b];_==="."||_===""&&b!==0&&b!==m.length-1||(_===".."?y.pop():y.push(_))}return y.join("/")},i.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":o.nodebuffer&&a.isBuffer(p)?"nodebuffer":o.uint8array&&p instanceof Uint8Array?"uint8array":o.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(p){if(!o[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(p){var m,y,b="";for(y=0;y<(p||"").length;y++)b+="\\x"+((m=p.charCodeAt(y))<16?"0":"")+m.toString(16).toUpperCase();return b},i.delay=function(p,m,y){setImmediate(function(){p.apply(y||null,m||[])})},i.inherits=function(p,m){function y(){}y.prototype=m.prototype,p.prototype=new y},i.extend=function(){var p,m,y={};for(p=0;p<arguments.length;p++)for(m in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],m)&&y[m]===void 0&&(y[m]=arguments[p][m]);return y},i.prepareContent=function(p,m,y,b,_){return l.Promise.resolve(m).then(function(w){return o.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,O){var T=new FileReader;T.onload=function(I){C(I.target.result)},T.onerror=function(I){O(I.target.error)},T.readAsArrayBuffer(w)}):w}).then(function(w){var C=i.getTypeOf(w);return C?(C==="arraybuffer"?w=i.transformTo("uint8array",w):C==="string"&&(_?w=s.decode(w):y&&b!==!0&&(w=function(O){return u(O,o.uint8array?new Uint8Array(O.length):new Array(O.length))}(w))),w):l.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,i){var o=n("./reader/readerFor"),s=n("./utils"),a=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(d)+", expected "+s.pretty(f)+")")}},isSignature:function(f,d){var h=this.reader.index;this.reader.setIndex(f);var g=this.reader.readString(4)===d;return this.reader.setIndex(h),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),d=c.uint8array?"uint8array":"array",h=s.transformTo(d,f);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,d,h,g=this.zip64EndOfCentralSize-44;0<g;)f=this.reader.readInt(2),d=this.reader.readInt(4),h=this.reader.readData(d),this.zip64ExtensibleData[f]={id:f,length:d,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,d;for(f=0;f<this.files.length;f++)d=this.files[f],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var d=f;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var g=d-h;if(0<g)this.isSignature(d,a.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(f){this.reader=o(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,i){var o=n("./reader/readerFor"),s=n("./utils"),a=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),f=n("./support");function d(h,g){this.options=h,this.loadOptions=g}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var g,p;if(h.skip(22),this.fileNameLength=h.readInt(2),p=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(m){for(var y in u)if(Object.prototype.hasOwnProperty.call(u,y)&&u[y].magic===m)return u[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,g,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var g=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(g),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=o(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var g,p,m,y=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<y;)g=h.readInt(2),p=h.readInt(2),m=h.readData(p),this.extraFields[g]={id:g,length:p,value:m};h.setIndex(y)},handleUTF8:function(){var h=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var p=s.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var y=s.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var g=o(h.value);return g.readInt(1)!==1||l(this.fileName)!==g.readInt(4)?null:c.utf8decode(g.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var g=o(h.value);return g.readInt(1)!==1||l(this.fileComment)!==g.readInt(4)?null:c.utf8decode(g.readData(h.length-5))}return null}},r.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,i){function o(g,p,m){this.name=g,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=p,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var s=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");o.prototype={internalStream:function(g){var p=null,m="string";try{if(!g)throw new Error("No output type specified.");var y=(m=g.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),p=this._decompressWorker();var b=!this._dataBinary;b&&!y&&(p=p.pipe(new l.Utf8EncodeWorker)),!b&&y&&(p=p.pipe(new l.Utf8DecodeWorker))}catch(_){(p=new u("error")).error(_)}return new s(p,m,"")},async:function(g,p){return this.internalStream(g).accumulate(p)},nodeStream:function(g,p){return this.internalStream(g||"nodebuffer").toNodejsStream(p)},_compressWorker:function(g,p){if(this._data instanceof c&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(m,g,p)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<f.length;h++)o.prototype[f[h]]=d;r.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,i){(function(o){var s,a,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var c=0,u=new l(g),f=o.document.createTextNode("");u.observe(f,{characterData:!0}),s=function(){f.data=c=++c%2}}else if(o.setImmediate||o.MessageChannel===void 0)s="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var p=o.document.createElement("script");p.onreadystatechange=function(){g(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},o.document.documentElement.appendChild(p)}:function(){setTimeout(g,0)};else{var d=new o.MessageChannel;d.port1.onmessage=g,s=function(){d.port2.postMessage(0)}}var h=[];function g(){var p,m;a=!0;for(var y=h.length;y;){for(m=h,h=[],p=-1;++p<y;)m[p]();y=h.length}a=!1}r.exports=function(p){h.push(p)!==1||a||s()}}).call(this,typeof Xn<"u"?Xn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,i){var o=n("immediate");function s(){}var a={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function f(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,y!==s&&p(this,y)}function d(y,b,_){this.promise=y,typeof b=="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function h(y,b,_){o(function(){var w;try{w=b(_)}catch(C){return a.reject(y,C)}w===y?a.reject(y,new TypeError("Cannot resolve promise with itself")):a.resolve(y,w)})}function g(y){var b=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof b=="function")return function(){b.apply(y,arguments)}}function p(y,b){var _=!1;function w(T){_||(_=!0,a.reject(y,T))}function C(T){_||(_=!0,a.resolve(y,T))}var O=m(function(){b(C,w)});O.status==="error"&&w(O.value)}function m(y,b){var _={};try{_.value=y(b),_.status="success"}catch(w){_.status="error",_.value=w}return _}(r.exports=f).prototype.finally=function(y){if(typeof y!="function")return this;var b=this.constructor;return this.then(function(_){return b.resolve(y()).then(function(){return _})},function(_){return b.resolve(y()).then(function(){throw _})})},f.prototype.catch=function(y){return this.then(null,y)},f.prototype.then=function(y,b){if(typeof y!="function"&&this.state===c||typeof b!="function"&&this.state===l)return this;var _=new this.constructor(s);return this.state!==u?h(_,this.state===c?y:b,this.outcome):this.queue.push(new d(_,y,b)),_},d.prototype.callFulfilled=function(y){a.resolve(this.promise,y)},d.prototype.otherCallFulfilled=function(y){h(this.promise,this.onFulfilled,y)},d.prototype.callRejected=function(y){a.reject(this.promise,y)},d.prototype.otherCallRejected=function(y){h(this.promise,this.onRejected,y)},a.resolve=function(y,b){var _=m(g,b);if(_.status==="error")return a.reject(y,_.value);var w=_.value;if(w)p(y,w);else{y.state=c,y.outcome=b;for(var C=-1,O=y.queue.length;++C<O;)y.queue[C].callFulfilled(b)}return y},a.reject=function(y,b){y.state=l,y.outcome=b;for(var _=-1,w=y.queue.length;++_<w;)y.queue[_].callRejected(b);return y},f.resolve=function(y){return y instanceof this?y:a.resolve(new this(s),y)},f.reject=function(y){var b=new this(s);return a.reject(b,y)},f.all=function(y){var b=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,w=!1;if(!_)return this.resolve([]);for(var C=new Array(_),O=0,T=-1,I=new this(s);++T<_;)k(y[T],T);return I;function k(M,j){b.resolve(M).then(function(S){C[j]=S,++O!==_||w||(w=!0,a.resolve(I,C))},function(S){w||(w=!0,a.reject(I,S))})}},f.race=function(y){var b=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,w=!1;if(!_)return this.resolve([]);for(var C=-1,O=new this(s);++C<_;)T=y[C],b.resolve(T).then(function(I){w||(w=!0,a.resolve(O,I))},function(I){w||(w=!0,a.reject(O,I))});var T;return O}},{immediate:36}],38:[function(n,r,i){var o={};(0,n("./lib/utils/common").assign)(o,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,i){var o=n("./zlib/deflate"),s=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,f=0,d=-1,h=0,g=8;function p(y){if(!(this instanceof p))return new p(y);this.options=s.assign({level:d,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},y||{});var b=this.options;b.raw&&0<b.windowBits?b.windowBits=-b.windowBits:b.gzip&&0<b.windowBits&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var _=o.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(_!==f)throw new Error(l[_]);if(b.header&&o.deflateSetHeader(this.strm,b.header),b.dictionary){var w;if(w=typeof b.dictionary=="string"?a.string2buf(b.dictionary):u.call(b.dictionary)==="[object ArrayBuffer]"?new Uint8Array(b.dictionary):b.dictionary,(_=o.deflateSetDictionary(this.strm,w))!==f)throw new Error(l[_]);this._dict_set=!0}}function m(y,b){var _=new p(b);if(_.push(y,!0),_.err)throw _.msg||l[_.err];return _.result}p.prototype.push=function(y,b){var _,w,C=this.strm,O=this.options.chunkSize;if(this.ended)return!1;w=b===~~b?b:b===!0?4:0,typeof y=="string"?C.input=a.string2buf(y):u.call(y)==="[object ArrayBuffer]"?C.input=new Uint8Array(y):C.input=y,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new s.Buf8(O),C.next_out=0,C.avail_out=O),(_=o.deflate(C,w))!==1&&_!==f)return this.onEnd(_),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(C.output,C.next_out))):this.onData(s.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&_!==1);return w===4?(_=o.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===f):w!==2||(this.onEnd(f),!(C.avail_out=0))},p.prototype.onData=function(y){this.chunks.push(y)},p.prototype.onEnd=function(y){y===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},i.Deflate=p,i.deflate=m,i.deflateRaw=function(y,b){return(b=b||{}).raw=!0,m(y,b)},i.gzip=function(y,b){return(b=b||{}).gzip=!0,m(y,b)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,i){var o=n("./zlib/inflate"),s=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),f=n("./zlib/gzheader"),d=Object.prototype.toString;function h(p){if(!(this instanceof h))return new h(p);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},p||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||p&&p.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&!(15&m.windowBits)&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var y=o.inflateInit2(this.strm,m.windowBits);if(y!==l.Z_OK)throw new Error(c[y]);this.header=new f,o.inflateGetHeader(this.strm,this.header)}function g(p,m){var y=new h(m);if(y.push(p,!0),y.err)throw y.msg||c[y.err];return y.result}h.prototype.push=function(p,m){var y,b,_,w,C,O,T=this.strm,I=this.options.chunkSize,k=this.options.dictionary,M=!1;if(this.ended)return!1;b=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof p=="string"?T.input=a.binstring2buf(p):d.call(p)==="[object ArrayBuffer]"?T.input=new Uint8Array(p):T.input=p,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new s.Buf8(I),T.next_out=0,T.avail_out=I),(y=o.inflate(T,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&k&&(O=typeof k=="string"?a.string2buf(k):d.call(k)==="[object ArrayBuffer]"?new Uint8Array(k):k,y=o.inflateSetDictionary(this.strm,O)),y===l.Z_BUF_ERROR&&M===!0&&(y=l.Z_OK,M=!1),y!==l.Z_STREAM_END&&y!==l.Z_OK)return this.onEnd(y),!(this.ended=!0);T.next_out&&(T.avail_out!==0&&y!==l.Z_STREAM_END&&(T.avail_in!==0||b!==l.Z_FINISH&&b!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=a.utf8border(T.output,T.next_out),w=T.next_out-_,C=a.buf2string(T.output,_),T.next_out=w,T.avail_out=I-w,w&&s.arraySet(T.output,T.output,_,w,0),this.onData(C)):this.onData(s.shrinkBuf(T.output,T.next_out)))),T.avail_in===0&&T.avail_out===0&&(M=!0)}while((0<T.avail_in||T.avail_out===0)&&y!==l.Z_STREAM_END);return y===l.Z_STREAM_END&&(b=l.Z_FINISH),b===l.Z_FINISH?(y=o.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===l.Z_OK):b!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(T.avail_out=0))},h.prototype.onData=function(p){this.chunks.push(p)},h.prototype.onEnd=function(p){p===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},i.Inflate=h,i.inflate=g,i.inflateRaw=function(p,m){return(m=m||{}).raw=!0,g(p,m)},i.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(l[f]=u[f])}}return l},i.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var s={arraySet:function(l,c,u,f,d){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+f),d);else for(var h=0;h<f;h++)l[d+h]=c[u+h]},flattenChunks:function(l){var c,u,f,d,h,g;for(c=f=0,u=l.length;c<u;c++)f+=l[c].length;for(g=new Uint8Array(f),c=d=0,u=l.length;c<u;c++)h=l[c],g.set(h,d),d+=h.length;return g}},a={arraySet:function(l,c,u,f,d){for(var h=0;h<f;h++)l[d+h]=c[u+h]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(o)},{}],42:[function(n,r,i){var o=n("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new o.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(f,d){if(d<65537&&(f.subarray&&a||!f.subarray&&s))return String.fromCharCode.apply(null,o.shrinkBuf(f,d));for(var h="",g=0;g<d;g++)h+=String.fromCharCode(f[g]);return h}l[254]=l[254]=1,i.string2buf=function(f){var d,h,g,p,m,y=f.length,b=0;for(p=0;p<y;p++)(64512&(h=f.charCodeAt(p)))==55296&&p+1<y&&(64512&(g=f.charCodeAt(p+1)))==56320&&(h=65536+(h-55296<<10)+(g-56320),p++),b+=h<128?1:h<2048?2:h<65536?3:4;for(d=new o.Buf8(b),p=m=0;m<b;p++)(64512&(h=f.charCodeAt(p)))==55296&&p+1<y&&(64512&(g=f.charCodeAt(p+1)))==56320&&(h=65536+(h-55296<<10)+(g-56320),p++),h<128?d[m++]=h:(h<2048?d[m++]=192|h>>>6:(h<65536?d[m++]=224|h>>>12:(d[m++]=240|h>>>18,d[m++]=128|h>>>12&63),d[m++]=128|h>>>6&63),d[m++]=128|63&h);return d},i.buf2binstring=function(f){return u(f,f.length)},i.binstring2buf=function(f){for(var d=new o.Buf8(f.length),h=0,g=d.length;h<g;h++)d[h]=f.charCodeAt(h);return d},i.buf2string=function(f,d){var h,g,p,m,y=d||f.length,b=new Array(2*y);for(h=g=0;h<y;)if((p=f[h++])<128)b[g++]=p;else if(4<(m=l[p]))b[g++]=65533,h+=m-1;else{for(p&=m===2?31:m===3?15:7;1<m&&h<y;)p=p<<6|63&f[h++],m--;1<m?b[g++]=65533:p<65536?b[g++]=p:(p-=65536,b[g++]=55296|p>>10&1023,b[g++]=56320|1023&p)}return u(b,g)},i.utf8border=function(f,d){var h;for((d=d||f.length)>f.length&&(d=f.length),h=d-1;0<=h&&(192&f[h])==128;)h--;return h<0||h===0?d:h+l[f[h]]>d?h:d}},{"./common":41}],43:[function(n,r,i){r.exports=function(o,s,a,l){for(var c=65535&o|0,u=o>>>16&65535|0,f=0;a!==0;){for(a-=f=2e3<a?2e3:a;u=u+(c=c+s[l++]|0)|0,--f;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,i){var o=function(){for(var s,a=[],l=0;l<256;l++){s=l;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;a[l]=s}return a}();r.exports=function(s,a,l,c){var u=o,f=c+l;s^=-1;for(var d=c;d<f;d++)s=s>>>8^u[255&(s^a[d])];return-1^s}},{}],46:[function(n,r,i){var o,s=n("../utils/common"),a=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),f=0,d=4,h=0,g=-2,p=-1,m=4,y=2,b=8,_=9,w=286,C=30,O=19,T=2*w+1,I=15,k=3,M=258,j=M+k+1,S=42,L=113,x=1,z=2,q=3,W=4;function X(v,H){return v.msg=u[H],H}function V(v){return(v<<1)-(4<v?9:0)}function te(v){for(var H=v.length;0<=--H;)v[H]=0}function N(v){var H=v.state,U=H.pending;U>v.avail_out&&(U=v.avail_out),U!==0&&(s.arraySet(v.output,H.pending_buf,H.pending_out,U,v.next_out),v.next_out+=U,H.pending_out+=U,v.total_out+=U,v.avail_out-=U,H.pending-=U,H.pending===0&&(H.pending_out=0))}function $(v,H){a._tr_flush_block(v,0<=v.block_start?v.block_start:-1,v.strstart-v.block_start,H),v.block_start=v.strstart,N(v.strm)}function ee(v,H){v.pending_buf[v.pending++]=H}function Q(v,H){v.pending_buf[v.pending++]=H>>>8&255,v.pending_buf[v.pending++]=255&H}function J(v,H){var U,A,P=v.max_chain_length,D=v.strstart,K=v.prev_length,Z=v.nice_match,B=v.strstart>v.w_size-j?v.strstart-(v.w_size-j):0,F=v.window,G=v.w_mask,Y=v.prev,ne=v.strstart+M,fe=F[D+K-1],ue=F[D+K];v.prev_length>=v.good_match&&(P>>=2),Z>v.lookahead&&(Z=v.lookahead);do if(F[(U=H)+K]===ue&&F[U+K-1]===fe&&F[U]===F[D]&&F[++U]===F[D+1]){D+=2,U++;do;while(F[++D]===F[++U]&&F[++D]===F[++U]&&F[++D]===F[++U]&&F[++D]===F[++U]&&F[++D]===F[++U]&&F[++D]===F[++U]&&F[++D]===F[++U]&&F[++D]===F[++U]&&D<ne);if(A=M-(ne-D),D=ne-M,K<A){if(v.match_start=H,Z<=(K=A))break;fe=F[D+K-1],ue=F[D+K]}}while((H=Y[H&G])>B&&--P!=0);return K<=v.lookahead?K:v.lookahead}function ge(v){var H,U,A,P,D,K,Z,B,F,G,Y=v.w_size;do{if(P=v.window_size-v.lookahead-v.strstart,v.strstart>=Y+(Y-j)){for(s.arraySet(v.window,v.window,Y,Y,0),v.match_start-=Y,v.strstart-=Y,v.block_start-=Y,H=U=v.hash_size;A=v.head[--H],v.head[H]=Y<=A?A-Y:0,--U;);for(H=U=Y;A=v.prev[--H],v.prev[H]=Y<=A?A-Y:0,--U;);P+=Y}if(v.strm.avail_in===0)break;if(K=v.strm,Z=v.window,B=v.strstart+v.lookahead,F=P,G=void 0,G=K.avail_in,F<G&&(G=F),U=G===0?0:(K.avail_in-=G,s.arraySet(Z,K.input,K.next_in,G,B),K.state.wrap===1?K.adler=l(K.adler,Z,G,B):K.state.wrap===2&&(K.adler=c(K.adler,Z,G,B)),K.next_in+=G,K.total_in+=G,G),v.lookahead+=U,v.lookahead+v.insert>=k)for(D=v.strstart-v.insert,v.ins_h=v.window[D],v.ins_h=(v.ins_h<<v.hash_shift^v.window[D+1])&v.hash_mask;v.insert&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[D+k-1])&v.hash_mask,v.prev[D&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=D,D++,v.insert--,!(v.lookahead+v.insert<k)););}while(v.lookahead<j&&v.strm.avail_in!==0)}function _e(v,H){for(var U,A;;){if(v.lookahead<j){if(ge(v),v.lookahead<j&&H===f)return x;if(v.lookahead===0)break}if(U=0,v.lookahead>=k&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+k-1])&v.hash_mask,U=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),U!==0&&v.strstart-U<=v.w_size-j&&(v.match_length=J(v,U)),v.match_length>=k)if(A=a._tr_tally(v,v.strstart-v.match_start,v.match_length-k),v.lookahead-=v.match_length,v.match_length<=v.max_lazy_match&&v.lookahead>=k){for(v.match_length--;v.strstart++,v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+k-1])&v.hash_mask,U=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart,--v.match_length!=0;);v.strstart++}else v.strstart+=v.match_length,v.match_length=0,v.ins_h=v.window[v.strstart],v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+1])&v.hash_mask;else A=a._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++;if(A&&($(v,!1),v.strm.avail_out===0))return x}return v.insert=v.strstart<k-1?v.strstart:k-1,H===d?($(v,!0),v.strm.avail_out===0?q:W):v.last_lit&&($(v,!1),v.strm.avail_out===0)?x:z}function ce(v,H){for(var U,A,P;;){if(v.lookahead<j){if(ge(v),v.lookahead<j&&H===f)return x;if(v.lookahead===0)break}if(U=0,v.lookahead>=k&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+k-1])&v.hash_mask,U=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),v.prev_length=v.match_length,v.prev_match=v.match_start,v.match_length=k-1,U!==0&&v.prev_length<v.max_lazy_match&&v.strstart-U<=v.w_size-j&&(v.match_length=J(v,U),v.match_length<=5&&(v.strategy===1||v.match_length===k&&4096<v.strstart-v.match_start)&&(v.match_length=k-1)),v.prev_length>=k&&v.match_length<=v.prev_length){for(P=v.strstart+v.lookahead-k,A=a._tr_tally(v,v.strstart-1-v.prev_match,v.prev_length-k),v.lookahead-=v.prev_length-1,v.prev_length-=2;++v.strstart<=P&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+k-1])&v.hash_mask,U=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),--v.prev_length!=0;);if(v.match_available=0,v.match_length=k-1,v.strstart++,A&&($(v,!1),v.strm.avail_out===0))return x}else if(v.match_available){if((A=a._tr_tally(v,0,v.window[v.strstart-1]))&&$(v,!1),v.strstart++,v.lookahead--,v.strm.avail_out===0)return x}else v.match_available=1,v.strstart++,v.lookahead--}return v.match_available&&(A=a._tr_tally(v,0,v.window[v.strstart-1]),v.match_available=0),v.insert=v.strstart<k-1?v.strstart:k-1,H===d?($(v,!0),v.strm.avail_out===0?q:W):v.last_lit&&($(v,!1),v.strm.avail_out===0)?x:z}function he(v,H,U,A,P){this.good_length=v,this.max_lazy=H,this.nice_length=U,this.max_chain=A,this.func=P}function we(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=b,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*T),this.dyn_dtree=new s.Buf16(2*(2*C+1)),this.bl_tree=new s.Buf16(2*(2*O+1)),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(I+1),this.heap=new s.Buf16(2*w+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*w+1),te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ve(v){var H;return v&&v.state?(v.total_in=v.total_out=0,v.data_type=y,(H=v.state).pending=0,H.pending_out=0,H.wrap<0&&(H.wrap=-H.wrap),H.status=H.wrap?S:L,v.adler=H.wrap===2?0:1,H.last_flush=f,a._tr_init(H),h):X(v,g)}function Re(v){var H=ve(v);return H===h&&function(U){U.window_size=2*U.w_size,te(U.head),U.max_lazy_match=o[U.level].max_lazy,U.good_match=o[U.level].good_length,U.nice_match=o[U.level].nice_length,U.max_chain_length=o[U.level].max_chain,U.strstart=0,U.block_start=0,U.lookahead=0,U.insert=0,U.match_length=U.prev_length=k-1,U.match_available=0,U.ins_h=0}(v.state),H}function Se(v,H,U,A,P,D){if(!v)return g;var K=1;if(H===p&&(H=6),A<0?(K=0,A=-A):15<A&&(K=2,A-=16),P<1||_<P||U!==b||A<8||15<A||H<0||9<H||D<0||m<D)return X(v,g);A===8&&(A=9);var Z=new we;return(v.state=Z).strm=v,Z.wrap=K,Z.gzhead=null,Z.w_bits=A,Z.w_size=1<<Z.w_bits,Z.w_mask=Z.w_size-1,Z.hash_bits=P+7,Z.hash_size=1<<Z.hash_bits,Z.hash_mask=Z.hash_size-1,Z.hash_shift=~~((Z.hash_bits+k-1)/k),Z.window=new s.Buf8(2*Z.w_size),Z.head=new s.Buf16(Z.hash_size),Z.prev=new s.Buf16(Z.w_size),Z.lit_bufsize=1<<P+6,Z.pending_buf_size=4*Z.lit_bufsize,Z.pending_buf=new s.Buf8(Z.pending_buf_size),Z.d_buf=1*Z.lit_bufsize,Z.l_buf=3*Z.lit_bufsize,Z.level=H,Z.strategy=D,Z.method=U,Re(v)}o=[new he(0,0,0,0,function(v,H){var U=65535;for(U>v.pending_buf_size-5&&(U=v.pending_buf_size-5);;){if(v.lookahead<=1){if(ge(v),v.lookahead===0&&H===f)return x;if(v.lookahead===0)break}v.strstart+=v.lookahead,v.lookahead=0;var A=v.block_start+U;if((v.strstart===0||v.strstart>=A)&&(v.lookahead=v.strstart-A,v.strstart=A,$(v,!1),v.strm.avail_out===0)||v.strstart-v.block_start>=v.w_size-j&&($(v,!1),v.strm.avail_out===0))return x}return v.insert=0,H===d?($(v,!0),v.strm.avail_out===0?q:W):(v.strstart>v.block_start&&($(v,!1),v.strm.avail_out),x)}),new he(4,4,8,4,_e),new he(4,5,16,8,_e),new he(4,6,32,32,_e),new he(4,4,16,16,ce),new he(8,16,32,32,ce),new he(8,16,128,128,ce),new he(8,32,128,256,ce),new he(32,128,258,1024,ce),new he(32,258,258,4096,ce)],i.deflateInit=function(v,H){return Se(v,H,b,15,8,0)},i.deflateInit2=Se,i.deflateReset=Re,i.deflateResetKeep=ve,i.deflateSetHeader=function(v,H){return v&&v.state?v.state.wrap!==2?g:(v.state.gzhead=H,h):g},i.deflate=function(v,H){var U,A,P,D;if(!v||!v.state||5<H||H<0)return v?X(v,g):g;if(A=v.state,!v.output||!v.input&&v.avail_in!==0||A.status===666&&H!==d)return X(v,v.avail_out===0?-5:g);if(A.strm=v,U=A.last_flush,A.last_flush=H,A.status===S)if(A.wrap===2)v.adler=0,ee(A,31),ee(A,139),ee(A,8),A.gzhead?(ee(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),ee(A,255&A.gzhead.time),ee(A,A.gzhead.time>>8&255),ee(A,A.gzhead.time>>16&255),ee(A,A.gzhead.time>>24&255),ee(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),ee(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(ee(A,255&A.gzhead.extra.length),ee(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(v.adler=c(v.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=69):(ee(A,0),ee(A,0),ee(A,0),ee(A,0),ee(A,0),ee(A,A.level===9?2:2<=A.strategy||A.level<2?4:0),ee(A,3),A.status=L);else{var K=b+(A.w_bits-8<<4)<<8;K|=(2<=A.strategy||A.level<2?0:A.level<6?1:A.level===6?2:3)<<6,A.strstart!==0&&(K|=32),K+=31-K%31,A.status=L,Q(A,K),A.strstart!==0&&(Q(A,v.adler>>>16),Q(A,65535&v.adler)),v.adler=1}if(A.status===69)if(A.gzhead.extra){for(P=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>P&&(v.adler=c(v.adler,A.pending_buf,A.pending-P,P)),N(v),P=A.pending,A.pending!==A.pending_buf_size));)ee(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>P&&(v.adler=c(v.adler,A.pending_buf,A.pending-P,P)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=73)}else A.status=73;if(A.status===73)if(A.gzhead.name){P=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>P&&(v.adler=c(v.adler,A.pending_buf,A.pending-P,P)),N(v),P=A.pending,A.pending===A.pending_buf_size)){D=1;break}D=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,ee(A,D)}while(D!==0);A.gzhead.hcrc&&A.pending>P&&(v.adler=c(v.adler,A.pending_buf,A.pending-P,P)),D===0&&(A.gzindex=0,A.status=91)}else A.status=91;if(A.status===91)if(A.gzhead.comment){P=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>P&&(v.adler=c(v.adler,A.pending_buf,A.pending-P,P)),N(v),P=A.pending,A.pending===A.pending_buf_size)){D=1;break}D=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,ee(A,D)}while(D!==0);A.gzhead.hcrc&&A.pending>P&&(v.adler=c(v.adler,A.pending_buf,A.pending-P,P)),D===0&&(A.status=103)}else A.status=103;if(A.status===103&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&N(v),A.pending+2<=A.pending_buf_size&&(ee(A,255&v.adler),ee(A,v.adler>>8&255),v.adler=0,A.status=L)):A.status=L),A.pending!==0){if(N(v),v.avail_out===0)return A.last_flush=-1,h}else if(v.avail_in===0&&V(H)<=V(U)&&H!==d)return X(v,-5);if(A.status===666&&v.avail_in!==0)return X(v,-5);if(v.avail_in!==0||A.lookahead!==0||H!==f&&A.status!==666){var Z=A.strategy===2?function(B,F){for(var G;;){if(B.lookahead===0&&(ge(B),B.lookahead===0)){if(F===f)return x;break}if(B.match_length=0,G=a._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,G&&($(B,!1),B.strm.avail_out===0))return x}return B.insert=0,F===d?($(B,!0),B.strm.avail_out===0?q:W):B.last_lit&&($(B,!1),B.strm.avail_out===0)?x:z}(A,H):A.strategy===3?function(B,F){for(var G,Y,ne,fe,ue=B.window;;){if(B.lookahead<=M){if(ge(B),B.lookahead<=M&&F===f)return x;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=k&&0<B.strstart&&(Y=ue[ne=B.strstart-1])===ue[++ne]&&Y===ue[++ne]&&Y===ue[++ne]){fe=B.strstart+M;do;while(Y===ue[++ne]&&Y===ue[++ne]&&Y===ue[++ne]&&Y===ue[++ne]&&Y===ue[++ne]&&Y===ue[++ne]&&Y===ue[++ne]&&Y===ue[++ne]&&ne<fe);B.match_length=M-(fe-ne),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=k?(G=a._tr_tally(B,1,B.match_length-k),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(G=a._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),G&&($(B,!1),B.strm.avail_out===0))return x}return B.insert=0,F===d?($(B,!0),B.strm.avail_out===0?q:W):B.last_lit&&($(B,!1),B.strm.avail_out===0)?x:z}(A,H):o[A.level].func(A,H);if(Z!==q&&Z!==W||(A.status=666),Z===x||Z===q)return v.avail_out===0&&(A.last_flush=-1),h;if(Z===z&&(H===1?a._tr_align(A):H!==5&&(a._tr_stored_block(A,0,0,!1),H===3&&(te(A.head),A.lookahead===0&&(A.strstart=0,A.block_start=0,A.insert=0))),N(v),v.avail_out===0))return A.last_flush=-1,h}return H!==d?h:A.wrap<=0?1:(A.wrap===2?(ee(A,255&v.adler),ee(A,v.adler>>8&255),ee(A,v.adler>>16&255),ee(A,v.adler>>24&255),ee(A,255&v.total_in),ee(A,v.total_in>>8&255),ee(A,v.total_in>>16&255),ee(A,v.total_in>>24&255)):(Q(A,v.adler>>>16),Q(A,65535&v.adler)),N(v),0<A.wrap&&(A.wrap=-A.wrap),A.pending!==0?h:1)},i.deflateEnd=function(v){var H;return v&&v.state?(H=v.state.status)!==S&&H!==69&&H!==73&&H!==91&&H!==103&&H!==L&&H!==666?X(v,g):(v.state=null,H===L?X(v,-3):h):g},i.deflateSetDictionary=function(v,H){var U,A,P,D,K,Z,B,F,G=H.length;if(!v||!v.state||(D=(U=v.state).wrap)===2||D===1&&U.status!==S||U.lookahead)return g;for(D===1&&(v.adler=l(v.adler,H,G,0)),U.wrap=0,G>=U.w_size&&(D===0&&(te(U.head),U.strstart=0,U.block_start=0,U.insert=0),F=new s.Buf8(U.w_size),s.arraySet(F,H,G-U.w_size,U.w_size,0),H=F,G=U.w_size),K=v.avail_in,Z=v.next_in,B=v.input,v.avail_in=G,v.next_in=0,v.input=H,ge(U);U.lookahead>=k;){for(A=U.strstart,P=U.lookahead-(k-1);U.ins_h=(U.ins_h<<U.hash_shift^U.window[A+k-1])&U.hash_mask,U.prev[A&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=A,A++,--P;);U.strstart=A,U.lookahead=k-1,ge(U)}return U.strstart+=U.lookahead,U.block_start=U.strstart,U.insert=U.lookahead,U.lookahead=0,U.match_length=U.prev_length=k-1,U.match_available=0,v.next_in=Z,v.input=B,v.avail_in=K,U.wrap=D,h},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,i){r.exports=function(o,s){var a,l,c,u,f,d,h,g,p,m,y,b,_,w,C,O,T,I,k,M,j,S,L,x,z;a=o.state,l=o.next_in,x=o.input,c=l+(o.avail_in-5),u=o.next_out,z=o.output,f=u-(s-o.avail_out),d=u+(o.avail_out-257),h=a.dmax,g=a.wsize,p=a.whave,m=a.wnext,y=a.window,b=a.hold,_=a.bits,w=a.lencode,C=a.distcode,O=(1<<a.lenbits)-1,T=(1<<a.distbits)-1;e:do{_<15&&(b+=x[l++]<<_,_+=8,b+=x[l++]<<_,_+=8),I=w[b&O];t:for(;;){if(b>>>=k=I>>>24,_-=k,(k=I>>>16&255)===0)z[u++]=65535&I;else{if(!(16&k)){if(!(64&k)){I=w[(65535&I)+(b&(1<<k)-1)];continue t}if(32&k){a.mode=12;break e}o.msg="invalid literal/length code",a.mode=30;break e}M=65535&I,(k&=15)&&(_<k&&(b+=x[l++]<<_,_+=8),M+=b&(1<<k)-1,b>>>=k,_-=k),_<15&&(b+=x[l++]<<_,_+=8,b+=x[l++]<<_,_+=8),I=C[b&T];n:for(;;){if(b>>>=k=I>>>24,_-=k,!(16&(k=I>>>16&255))){if(!(64&k)){I=C[(65535&I)+(b&(1<<k)-1)];continue n}o.msg="invalid distance code",a.mode=30;break e}if(j=65535&I,_<(k&=15)&&(b+=x[l++]<<_,(_+=8)<k&&(b+=x[l++]<<_,_+=8)),h<(j+=b&(1<<k)-1)){o.msg="invalid distance too far back",a.mode=30;break e}if(b>>>=k,_-=k,(k=u-f)<j){if(p<(k=j-k)&&a.sane){o.msg="invalid distance too far back",a.mode=30;break e}if(L=y,(S=0)===m){if(S+=g-k,k<M){for(M-=k;z[u++]=y[S++],--k;);S=u-j,L=z}}else if(m<k){if(S+=g+m-k,(k-=m)<M){for(M-=k;z[u++]=y[S++],--k;);if(S=0,m<M){for(M-=k=m;z[u++]=y[S++],--k;);S=u-j,L=z}}}else if(S+=m-k,k<M){for(M-=k;z[u++]=y[S++],--k;);S=u-j,L=z}for(;2<M;)z[u++]=L[S++],z[u++]=L[S++],z[u++]=L[S++],M-=3;M&&(z[u++]=L[S++],1<M&&(z[u++]=L[S++]))}else{for(S=u-j;z[u++]=z[S++],z[u++]=z[S++],z[u++]=z[S++],2<(M-=3););M&&(z[u++]=z[S++],1<M&&(z[u++]=z[S++]))}break}}break}}while(l<c&&u<d);l-=M=_>>3,b&=(1<<(_-=M<<3))-1,o.next_in=l,o.next_out=u,o.avail_in=l<c?c-l+5:5-(l-c),o.avail_out=u<d?d-u+257:257-(u-d),a.hold=b,a.bits=_}},{}],49:[function(n,r,i){var o=n("../utils/common"),s=n("./adler32"),a=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,f=2,d=0,h=-2,g=1,p=852,m=592;function y(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function b(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(S){var L;return S&&S.state?(L=S.state,S.total_in=S.total_out=L.total=0,S.msg="",L.wrap&&(S.adler=1&L.wrap),L.mode=g,L.last=0,L.havedict=0,L.dmax=32768,L.head=null,L.hold=0,L.bits=0,L.lencode=L.lendyn=new o.Buf32(p),L.distcode=L.distdyn=new o.Buf32(m),L.sane=1,L.back=-1,d):h}function w(S){var L;return S&&S.state?((L=S.state).wsize=0,L.whave=0,L.wnext=0,_(S)):h}function C(S,L){var x,z;return S&&S.state?(z=S.state,L<0?(x=0,L=-L):(x=1+(L>>4),L<48&&(L&=15)),L&&(L<8||15<L)?h:(z.window!==null&&z.wbits!==L&&(z.window=null),z.wrap=x,z.wbits=L,w(S))):h}function O(S,L){var x,z;return S?(z=new b,(S.state=z).window=null,(x=C(S,L))!==d&&(S.state=null),x):h}var T,I,k=!0;function M(S){if(k){var L;for(T=new o.Buf32(512),I=new o.Buf32(32),L=0;L<144;)S.lens[L++]=8;for(;L<256;)S.lens[L++]=9;for(;L<280;)S.lens[L++]=7;for(;L<288;)S.lens[L++]=8;for(c(u,S.lens,0,288,T,0,S.work,{bits:9}),L=0;L<32;)S.lens[L++]=5;c(f,S.lens,0,32,I,0,S.work,{bits:5}),k=!1}S.lencode=T,S.lenbits=9,S.distcode=I,S.distbits=5}function j(S,L,x,z){var q,W=S.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new o.Buf8(W.wsize)),z>=W.wsize?(o.arraySet(W.window,L,x-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(z<(q=W.wsize-W.wnext)&&(q=z),o.arraySet(W.window,L,x-z,q,W.wnext),(z-=q)?(o.arraySet(W.window,L,x-z,z,0),W.wnext=z,W.whave=W.wsize):(W.wnext+=q,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=q))),0}i.inflateReset=w,i.inflateReset2=C,i.inflateResetKeep=_,i.inflateInit=function(S){return O(S,15)},i.inflateInit2=O,i.inflate=function(S,L){var x,z,q,W,X,V,te,N,$,ee,Q,J,ge,_e,ce,he,we,ve,Re,Se,v,H,U,A,P=0,D=new o.Buf8(4),K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return h;(x=S.state).mode===12&&(x.mode=13),X=S.next_out,q=S.output,te=S.avail_out,W=S.next_in,z=S.input,V=S.avail_in,N=x.hold,$=x.bits,ee=V,Q=te,H=d;e:for(;;)switch(x.mode){case g:if(x.wrap===0){x.mode=13;break}for(;$<16;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(2&x.wrap&&N===35615){D[x.check=0]=255&N,D[1]=N>>>8&255,x.check=a(x.check,D,2,0),$=N=0,x.mode=2;break}if(x.flags=0,x.head&&(x.head.done=!1),!(1&x.wrap)||(((255&N)<<8)+(N>>8))%31){S.msg="incorrect header check",x.mode=30;break}if((15&N)!=8){S.msg="unknown compression method",x.mode=30;break}if($-=4,v=8+(15&(N>>>=4)),x.wbits===0)x.wbits=v;else if(v>x.wbits){S.msg="invalid window size",x.mode=30;break}x.dmax=1<<v,S.adler=x.check=1,x.mode=512&N?10:12,$=N=0;break;case 2:for(;$<16;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(x.flags=N,(255&x.flags)!=8){S.msg="unknown compression method",x.mode=30;break}if(57344&x.flags){S.msg="unknown header flags set",x.mode=30;break}x.head&&(x.head.text=N>>8&1),512&x.flags&&(D[0]=255&N,D[1]=N>>>8&255,x.check=a(x.check,D,2,0)),$=N=0,x.mode=3;case 3:for(;$<32;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}x.head&&(x.head.time=N),512&x.flags&&(D[0]=255&N,D[1]=N>>>8&255,D[2]=N>>>16&255,D[3]=N>>>24&255,x.check=a(x.check,D,4,0)),$=N=0,x.mode=4;case 4:for(;$<16;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}x.head&&(x.head.xflags=255&N,x.head.os=N>>8),512&x.flags&&(D[0]=255&N,D[1]=N>>>8&255,x.check=a(x.check,D,2,0)),$=N=0,x.mode=5;case 5:if(1024&x.flags){for(;$<16;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}x.length=N,x.head&&(x.head.extra_len=N),512&x.flags&&(D[0]=255&N,D[1]=N>>>8&255,x.check=a(x.check,D,2,0)),$=N=0}else x.head&&(x.head.extra=null);x.mode=6;case 6:if(1024&x.flags&&(V<(J=x.length)&&(J=V),J&&(x.head&&(v=x.head.extra_len-x.length,x.head.extra||(x.head.extra=new Array(x.head.extra_len)),o.arraySet(x.head.extra,z,W,J,v)),512&x.flags&&(x.check=a(x.check,z,J,W)),V-=J,W+=J,x.length-=J),x.length))break e;x.length=0,x.mode=7;case 7:if(2048&x.flags){if(V===0)break e;for(J=0;v=z[W+J++],x.head&&v&&x.length<65536&&(x.head.name+=String.fromCharCode(v)),v&&J<V;);if(512&x.flags&&(x.check=a(x.check,z,J,W)),V-=J,W+=J,v)break e}else x.head&&(x.head.name=null);x.length=0,x.mode=8;case 8:if(4096&x.flags){if(V===0)break e;for(J=0;v=z[W+J++],x.head&&v&&x.length<65536&&(x.head.comment+=String.fromCharCode(v)),v&&J<V;);if(512&x.flags&&(x.check=a(x.check,z,J,W)),V-=J,W+=J,v)break e}else x.head&&(x.head.comment=null);x.mode=9;case 9:if(512&x.flags){for(;$<16;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(N!==(65535&x.check)){S.msg="header crc mismatch",x.mode=30;break}$=N=0}x.head&&(x.head.hcrc=x.flags>>9&1,x.head.done=!0),S.adler=x.check=0,x.mode=12;break;case 10:for(;$<32;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}S.adler=x.check=y(N),$=N=0,x.mode=11;case 11:if(x.havedict===0)return S.next_out=X,S.avail_out=te,S.next_in=W,S.avail_in=V,x.hold=N,x.bits=$,2;S.adler=x.check=1,x.mode=12;case 12:if(L===5||L===6)break e;case 13:if(x.last){N>>>=7&$,$-=7&$,x.mode=27;break}for(;$<3;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}switch(x.last=1&N,$-=1,3&(N>>>=1)){case 0:x.mode=14;break;case 1:if(M(x),x.mode=20,L!==6)break;N>>>=2,$-=2;break e;case 2:x.mode=17;break;case 3:S.msg="invalid block type",x.mode=30}N>>>=2,$-=2;break;case 14:for(N>>>=7&$,$-=7&$;$<32;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if((65535&N)!=(N>>>16^65535)){S.msg="invalid stored block lengths",x.mode=30;break}if(x.length=65535&N,$=N=0,x.mode=15,L===6)break e;case 15:x.mode=16;case 16:if(J=x.length){if(V<J&&(J=V),te<J&&(J=te),J===0)break e;o.arraySet(q,z,W,J,X),V-=J,W+=J,te-=J,X+=J,x.length-=J;break}x.mode=12;break;case 17:for(;$<14;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(x.nlen=257+(31&N),N>>>=5,$-=5,x.ndist=1+(31&N),N>>>=5,$-=5,x.ncode=4+(15&N),N>>>=4,$-=4,286<x.nlen||30<x.ndist){S.msg="too many length or distance symbols",x.mode=30;break}x.have=0,x.mode=18;case 18:for(;x.have<x.ncode;){for(;$<3;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}x.lens[K[x.have++]]=7&N,N>>>=3,$-=3}for(;x.have<19;)x.lens[K[x.have++]]=0;if(x.lencode=x.lendyn,x.lenbits=7,U={bits:x.lenbits},H=c(0,x.lens,0,19,x.lencode,0,x.work,U),x.lenbits=U.bits,H){S.msg="invalid code lengths set",x.mode=30;break}x.have=0,x.mode=19;case 19:for(;x.have<x.nlen+x.ndist;){for(;he=(P=x.lencode[N&(1<<x.lenbits)-1])>>>16&255,we=65535&P,!((ce=P>>>24)<=$);){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(we<16)N>>>=ce,$-=ce,x.lens[x.have++]=we;else{if(we===16){for(A=ce+2;$<A;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(N>>>=ce,$-=ce,x.have===0){S.msg="invalid bit length repeat",x.mode=30;break}v=x.lens[x.have-1],J=3+(3&N),N>>>=2,$-=2}else if(we===17){for(A=ce+3;$<A;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}$-=ce,v=0,J=3+(7&(N>>>=ce)),N>>>=3,$-=3}else{for(A=ce+7;$<A;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}$-=ce,v=0,J=11+(127&(N>>>=ce)),N>>>=7,$-=7}if(x.have+J>x.nlen+x.ndist){S.msg="invalid bit length repeat",x.mode=30;break}for(;J--;)x.lens[x.have++]=v}}if(x.mode===30)break;if(x.lens[256]===0){S.msg="invalid code -- missing end-of-block",x.mode=30;break}if(x.lenbits=9,U={bits:x.lenbits},H=c(u,x.lens,0,x.nlen,x.lencode,0,x.work,U),x.lenbits=U.bits,H){S.msg="invalid literal/lengths set",x.mode=30;break}if(x.distbits=6,x.distcode=x.distdyn,U={bits:x.distbits},H=c(f,x.lens,x.nlen,x.ndist,x.distcode,0,x.work,U),x.distbits=U.bits,H){S.msg="invalid distances set",x.mode=30;break}if(x.mode=20,L===6)break e;case 20:x.mode=21;case 21:if(6<=V&&258<=te){S.next_out=X,S.avail_out=te,S.next_in=W,S.avail_in=V,x.hold=N,x.bits=$,l(S,Q),X=S.next_out,q=S.output,te=S.avail_out,W=S.next_in,z=S.input,V=S.avail_in,N=x.hold,$=x.bits,x.mode===12&&(x.back=-1);break}for(x.back=0;he=(P=x.lencode[N&(1<<x.lenbits)-1])>>>16&255,we=65535&P,!((ce=P>>>24)<=$);){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(he&&!(240&he)){for(ve=ce,Re=he,Se=we;he=(P=x.lencode[Se+((N&(1<<ve+Re)-1)>>ve)])>>>16&255,we=65535&P,!(ve+(ce=P>>>24)<=$);){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}N>>>=ve,$-=ve,x.back+=ve}if(N>>>=ce,$-=ce,x.back+=ce,x.length=we,he===0){x.mode=26;break}if(32&he){x.back=-1,x.mode=12;break}if(64&he){S.msg="invalid literal/length code",x.mode=30;break}x.extra=15&he,x.mode=22;case 22:if(x.extra){for(A=x.extra;$<A;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}x.length+=N&(1<<x.extra)-1,N>>>=x.extra,$-=x.extra,x.back+=x.extra}x.was=x.length,x.mode=23;case 23:for(;he=(P=x.distcode[N&(1<<x.distbits)-1])>>>16&255,we=65535&P,!((ce=P>>>24)<=$);){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(!(240&he)){for(ve=ce,Re=he,Se=we;he=(P=x.distcode[Se+((N&(1<<ve+Re)-1)>>ve)])>>>16&255,we=65535&P,!(ve+(ce=P>>>24)<=$);){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}N>>>=ve,$-=ve,x.back+=ve}if(N>>>=ce,$-=ce,x.back+=ce,64&he){S.msg="invalid distance code",x.mode=30;break}x.offset=we,x.extra=15&he,x.mode=24;case 24:if(x.extra){for(A=x.extra;$<A;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}x.offset+=N&(1<<x.extra)-1,N>>>=x.extra,$-=x.extra,x.back+=x.extra}if(x.offset>x.dmax){S.msg="invalid distance too far back",x.mode=30;break}x.mode=25;case 25:if(te===0)break e;if(J=Q-te,x.offset>J){if((J=x.offset-J)>x.whave&&x.sane){S.msg="invalid distance too far back",x.mode=30;break}ge=J>x.wnext?(J-=x.wnext,x.wsize-J):x.wnext-J,J>x.length&&(J=x.length),_e=x.window}else _e=q,ge=X-x.offset,J=x.length;for(te<J&&(J=te),te-=J,x.length-=J;q[X++]=_e[ge++],--J;);x.length===0&&(x.mode=21);break;case 26:if(te===0)break e;q[X++]=x.length,te--,x.mode=21;break;case 27:if(x.wrap){for(;$<32;){if(V===0)break e;V--,N|=z[W++]<<$,$+=8}if(Q-=te,S.total_out+=Q,x.total+=Q,Q&&(S.adler=x.check=x.flags?a(x.check,q,Q,X-Q):s(x.check,q,Q,X-Q)),Q=te,(x.flags?N:y(N))!==x.check){S.msg="incorrect data check",x.mode=30;break}$=N=0}x.mode=28;case 28:if(x.wrap&&x.flags){for(;$<32;){if(V===0)break e;V--,N+=z[W++]<<$,$+=8}if(N!==(4294967295&x.total)){S.msg="incorrect length check",x.mode=30;break}$=N=0}x.mode=29;case 29:H=1;break e;case 30:H=-3;break e;case 31:return-4;case 32:default:return h}return S.next_out=X,S.avail_out=te,S.next_in=W,S.avail_in=V,x.hold=N,x.bits=$,(x.wsize||Q!==S.avail_out&&x.mode<30&&(x.mode<27||L!==4))&&j(S,S.output,S.next_out,Q-S.avail_out)?(x.mode=31,-4):(ee-=S.avail_in,Q-=S.avail_out,S.total_in+=ee,S.total_out+=Q,x.total+=Q,x.wrap&&Q&&(S.adler=x.check=x.flags?a(x.check,q,Q,S.next_out-Q):s(x.check,q,Q,S.next_out-Q)),S.data_type=x.bits+(x.last?64:0)+(x.mode===12?128:0)+(x.mode===20||x.mode===15?256:0),(ee==0&&Q===0||L===4)&&H===d&&(H=-5),H)},i.inflateEnd=function(S){if(!S||!S.state)return h;var L=S.state;return L.window&&(L.window=null),S.state=null,d},i.inflateGetHeader=function(S,L){var x;return S&&S.state&&2&(x=S.state).wrap?((x.head=L).done=!1,d):h},i.inflateSetDictionary=function(S,L){var x,z=L.length;return S&&S.state?(x=S.state).wrap!==0&&x.mode!==11?h:x.mode===11&&s(1,L,z,0)!==x.check?-3:j(S,L,z,z)?(x.mode=31,-4):(x.havedict=1,d):h},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,i){var o=n("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,f,d,h,g,p,m,y){var b,_,w,C,O,T,I,k,M,j=y.bits,S=0,L=0,x=0,z=0,q=0,W=0,X=0,V=0,te=0,N=0,$=null,ee=0,Q=new o.Buf16(16),J=new o.Buf16(16),ge=null,_e=0;for(S=0;S<=15;S++)Q[S]=0;for(L=0;L<h;L++)Q[f[d+L]]++;for(q=j,z=15;1<=z&&Q[z]===0;z--);if(z<q&&(q=z),z===0)return g[p++]=20971520,g[p++]=20971520,y.bits=1,0;for(x=1;x<z&&Q[x]===0;x++);for(q<x&&(q=x),S=V=1;S<=15;S++)if(V<<=1,(V-=Q[S])<0)return-1;if(0<V&&(u===0||z!==1))return-1;for(J[1]=0,S=1;S<15;S++)J[S+1]=J[S]+Q[S];for(L=0;L<h;L++)f[d+L]!==0&&(m[J[f[d+L]]++]=L);if(T=u===0?($=ge=m,19):u===1?($=s,ee-=257,ge=a,_e-=257,256):($=l,ge=c,-1),S=x,O=p,X=L=N=0,w=-1,C=(te=1<<(W=q))-1,u===1&&852<te||u===2&&592<te)return 1;for(;;){for(I=S-X,M=m[L]<T?(k=0,m[L]):m[L]>T?(k=ge[_e+m[L]],$[ee+m[L]]):(k=96,0),b=1<<S-X,x=_=1<<W;g[O+(N>>X)+(_-=b)]=I<<24|k<<16|M|0,_!==0;);for(b=1<<S-1;N&b;)b>>=1;if(b!==0?(N&=b-1,N+=b):N=0,L++,--Q[S]==0){if(S===z)break;S=f[d+m[L]]}if(q<S&&(N&C)!==w){for(X===0&&(X=q),O+=x,V=1<<(W=S-X);W+X<z&&!((V-=Q[W+X])<=0);)W++,V<<=1;if(te+=1<<W,u===1&&852<te||u===2&&592<te)return 1;g[w=N&C]=q<<24|W<<16|O-p|0}}return N!==0&&(g[O+N]=S-X<<24|64<<16|0),y.bits=q,0}},{"../utils/common":41}],51:[function(n,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,i){var o=n("../utils/common"),s=0,a=1;function l(P){for(var D=P.length;0<=--D;)P[D]=0}var c=0,u=29,f=256,d=f+1+u,h=30,g=19,p=2*d+1,m=15,y=16,b=7,_=256,w=16,C=17,O=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=new Array(2*(d+2));l(j);var S=new Array(2*h);l(S);var L=new Array(512);l(L);var x=new Array(256);l(x);var z=new Array(u);l(z);var q,W,X,V=new Array(h);function te(P,D,K,Z,B){this.static_tree=P,this.extra_bits=D,this.extra_base=K,this.elems=Z,this.max_length=B,this.has_stree=P&&P.length}function N(P,D){this.dyn_tree=P,this.max_code=0,this.stat_desc=D}function $(P){return P<256?L[P]:L[256+(P>>>7)]}function ee(P,D){P.pending_buf[P.pending++]=255&D,P.pending_buf[P.pending++]=D>>>8&255}function Q(P,D,K){P.bi_valid>y-K?(P.bi_buf|=D<<P.bi_valid&65535,ee(P,P.bi_buf),P.bi_buf=D>>y-P.bi_valid,P.bi_valid+=K-y):(P.bi_buf|=D<<P.bi_valid&65535,P.bi_valid+=K)}function J(P,D,K){Q(P,K[2*D],K[2*D+1])}function ge(P,D){for(var K=0;K|=1&P,P>>>=1,K<<=1,0<--D;);return K>>>1}function _e(P,D,K){var Z,B,F=new Array(m+1),G=0;for(Z=1;Z<=m;Z++)F[Z]=G=G+K[Z-1]<<1;for(B=0;B<=D;B++){var Y=P[2*B+1];Y!==0&&(P[2*B]=ge(F[Y]++,Y))}}function ce(P){var D;for(D=0;D<d;D++)P.dyn_ltree[2*D]=0;for(D=0;D<h;D++)P.dyn_dtree[2*D]=0;for(D=0;D<g;D++)P.bl_tree[2*D]=0;P.dyn_ltree[2*_]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function he(P){8<P.bi_valid?ee(P,P.bi_buf):0<P.bi_valid&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function we(P,D,K,Z){var B=2*D,F=2*K;return P[B]<P[F]||P[B]===P[F]&&Z[D]<=Z[K]}function ve(P,D,K){for(var Z=P.heap[K],B=K<<1;B<=P.heap_len&&(B<P.heap_len&&we(D,P.heap[B+1],P.heap[B],P.depth)&&B++,!we(D,Z,P.heap[B],P.depth));)P.heap[K]=P.heap[B],K=B,B<<=1;P.heap[K]=Z}function Re(P,D,K){var Z,B,F,G,Y=0;if(P.last_lit!==0)for(;Z=P.pending_buf[P.d_buf+2*Y]<<8|P.pending_buf[P.d_buf+2*Y+1],B=P.pending_buf[P.l_buf+Y],Y++,Z===0?J(P,B,D):(J(P,(F=x[B])+f+1,D),(G=T[F])!==0&&Q(P,B-=z[F],G),J(P,F=$(--Z),K),(G=I[F])!==0&&Q(P,Z-=V[F],G)),Y<P.last_lit;);J(P,_,D)}function Se(P,D){var K,Z,B,F=D.dyn_tree,G=D.stat_desc.static_tree,Y=D.stat_desc.has_stree,ne=D.stat_desc.elems,fe=-1;for(P.heap_len=0,P.heap_max=p,K=0;K<ne;K++)F[2*K]!==0?(P.heap[++P.heap_len]=fe=K,P.depth[K]=0):F[2*K+1]=0;for(;P.heap_len<2;)F[2*(B=P.heap[++P.heap_len]=fe<2?++fe:0)]=1,P.depth[B]=0,P.opt_len--,Y&&(P.static_len-=G[2*B+1]);for(D.max_code=fe,K=P.heap_len>>1;1<=K;K--)ve(P,F,K);for(B=ne;K=P.heap[1],P.heap[1]=P.heap[P.heap_len--],ve(P,F,1),Z=P.heap[1],P.heap[--P.heap_max]=K,P.heap[--P.heap_max]=Z,F[2*B]=F[2*K]+F[2*Z],P.depth[B]=(P.depth[K]>=P.depth[Z]?P.depth[K]:P.depth[Z])+1,F[2*K+1]=F[2*Z+1]=B,P.heap[1]=B++,ve(P,F,1),2<=P.heap_len;);P.heap[--P.heap_max]=P.heap[1],function(ue,Oe){var ct,je,ut,be,Ct,Dt,Ve=Oe.dyn_tree,Zt=Oe.max_code,Ci=Oe.stat_desc.static_tree,Kf=Oe.stat_desc.has_stree,Zf=Oe.stat_desc.extra_bits,Ts=Oe.stat_desc.extra_base,bn=Oe.stat_desc.max_length,qn=0;for(be=0;be<=m;be++)ue.bl_count[be]=0;for(Ve[2*ue.heap[ue.heap_max]+1]=0,ct=ue.heap_max+1;ct<p;ct++)bn<(be=Ve[2*Ve[2*(je=ue.heap[ct])+1]+1]+1)&&(be=bn,qn++),Ve[2*je+1]=be,Zt<je||(ue.bl_count[be]++,Ct=0,Ts<=je&&(Ct=Zf[je-Ts]),Dt=Ve[2*je],ue.opt_len+=Dt*(be+Ct),Kf&&(ue.static_len+=Dt*(Ci[2*je+1]+Ct)));if(qn!==0){do{for(be=bn-1;ue.bl_count[be]===0;)be--;ue.bl_count[be]--,ue.bl_count[be+1]+=2,ue.bl_count[bn]--,qn-=2}while(0<qn);for(be=bn;be!==0;be--)for(je=ue.bl_count[be];je!==0;)Zt<(ut=ue.heap[--ct])||(Ve[2*ut+1]!==be&&(ue.opt_len+=(be-Ve[2*ut+1])*Ve[2*ut],Ve[2*ut+1]=be),je--)}}(P,D),_e(F,fe,P.bl_count)}function v(P,D,K){var Z,B,F=-1,G=D[1],Y=0,ne=7,fe=4;for(G===0&&(ne=138,fe=3),D[2*(K+1)+1]=65535,Z=0;Z<=K;Z++)B=G,G=D[2*(Z+1)+1],++Y<ne&&B===G||(Y<fe?P.bl_tree[2*B]+=Y:B!==0?(B!==F&&P.bl_tree[2*B]++,P.bl_tree[2*w]++):Y<=10?P.bl_tree[2*C]++:P.bl_tree[2*O]++,F=B,fe=(Y=0)===G?(ne=138,3):B===G?(ne=6,3):(ne=7,4))}function H(P,D,K){var Z,B,F=-1,G=D[1],Y=0,ne=7,fe=4;for(G===0&&(ne=138,fe=3),Z=0;Z<=K;Z++)if(B=G,G=D[2*(Z+1)+1],!(++Y<ne&&B===G)){if(Y<fe)for(;J(P,B,P.bl_tree),--Y!=0;);else B!==0?(B!==F&&(J(P,B,P.bl_tree),Y--),J(P,w,P.bl_tree),Q(P,Y-3,2)):Y<=10?(J(P,C,P.bl_tree),Q(P,Y-3,3)):(J(P,O,P.bl_tree),Q(P,Y-11,7));F=B,fe=(Y=0)===G?(ne=138,3):B===G?(ne=6,3):(ne=7,4)}}l(V);var U=!1;function A(P,D,K,Z){Q(P,(c<<1)+(Z?1:0),3),function(B,F,G,Y){he(B),ee(B,G),ee(B,~G),o.arraySet(B.pending_buf,B.window,F,G,B.pending),B.pending+=G}(P,D,K)}i._tr_init=function(P){U||(function(){var D,K,Z,B,F,G=new Array(m+1);for(B=Z=0;B<u-1;B++)for(z[B]=Z,D=0;D<1<<T[B];D++)x[Z++]=B;for(x[Z-1]=B,B=F=0;B<16;B++)for(V[B]=F,D=0;D<1<<I[B];D++)L[F++]=B;for(F>>=7;B<h;B++)for(V[B]=F<<7,D=0;D<1<<I[B]-7;D++)L[256+F++]=B;for(K=0;K<=m;K++)G[K]=0;for(D=0;D<=143;)j[2*D+1]=8,D++,G[8]++;for(;D<=255;)j[2*D+1]=9,D++,G[9]++;for(;D<=279;)j[2*D+1]=7,D++,G[7]++;for(;D<=287;)j[2*D+1]=8,D++,G[8]++;for(_e(j,d+1,G),D=0;D<h;D++)S[2*D+1]=5,S[2*D]=ge(D,5);q=new te(j,T,f+1,d,m),W=new te(S,I,0,h,m),X=new te(new Array(0),k,0,g,b)}(),U=!0),P.l_desc=new N(P.dyn_ltree,q),P.d_desc=new N(P.dyn_dtree,W),P.bl_desc=new N(P.bl_tree,X),P.bi_buf=0,P.bi_valid=0,ce(P)},i._tr_stored_block=A,i._tr_flush_block=function(P,D,K,Z){var B,F,G=0;0<P.level?(P.strm.data_type===2&&(P.strm.data_type=function(Y){var ne,fe=4093624447;for(ne=0;ne<=31;ne++,fe>>>=1)if(1&fe&&Y.dyn_ltree[2*ne]!==0)return s;if(Y.dyn_ltree[18]!==0||Y.dyn_ltree[20]!==0||Y.dyn_ltree[26]!==0)return a;for(ne=32;ne<f;ne++)if(Y.dyn_ltree[2*ne]!==0)return a;return s}(P)),Se(P,P.l_desc),Se(P,P.d_desc),G=function(Y){var ne;for(v(Y,Y.dyn_ltree,Y.l_desc.max_code),v(Y,Y.dyn_dtree,Y.d_desc.max_code),Se(Y,Y.bl_desc),ne=g-1;3<=ne&&Y.bl_tree[2*M[ne]+1]===0;ne--);return Y.opt_len+=3*(ne+1)+5+5+4,ne}(P),B=P.opt_len+3+7>>>3,(F=P.static_len+3+7>>>3)<=B&&(B=F)):B=F=K+5,K+4<=B&&D!==-1?A(P,D,K,Z):P.strategy===4||F===B?(Q(P,2+(Z?1:0),3),Re(P,j,S)):(Q(P,4+(Z?1:0),3),function(Y,ne,fe,ue){var Oe;for(Q(Y,ne-257,5),Q(Y,fe-1,5),Q(Y,ue-4,4),Oe=0;Oe<ue;Oe++)Q(Y,Y.bl_tree[2*M[Oe]+1],3);H(Y,Y.dyn_ltree,ne-1),H(Y,Y.dyn_dtree,fe-1)}(P,P.l_desc.max_code+1,P.d_desc.max_code+1,G+1),Re(P,P.dyn_ltree,P.dyn_dtree)),ce(P),Z&&he(P)},i._tr_tally=function(P,D,K){return P.pending_buf[P.d_buf+2*P.last_lit]=D>>>8&255,P.pending_buf[P.d_buf+2*P.last_lit+1]=255&D,P.pending_buf[P.l_buf+P.last_lit]=255&K,P.last_lit++,D===0?P.dyn_ltree[2*K]++:(P.matches++,D--,P.dyn_ltree[2*(x[K]+f+1)]++,P.dyn_dtree[2*$(D)]++),P.last_lit===P.lit_bufsize-1},i._tr_align=function(P){Q(P,2,3),J(P,_,j),function(D){D.bi_valid===16?(ee(D,D.bi_buf),D.bi_buf=0,D.bi_valid=0):8<=D.bi_valid&&(D.pending_buf[D.pending++]=255&D.bi_buf,D.bi_buf>>=8,D.bi_valid-=8)}(P)}},{"../utils/common":41}],53:[function(n,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,i){(function(o){(function(s,a){if(!s.setImmediate){var l,c,u,f,d=1,h={},g=!1,p=s.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(s);m=m&&m.setTimeout?m:s,l={}.toString.call(s.process)==="[object process]"?function(w){process.nextTick(function(){b(w)})}:function(){if(s.postMessage&&!s.importScripts){var w=!0,C=s.onmessage;return s.onmessage=function(){w=!1},s.postMessage("","*"),s.onmessage=C,w}}()?(f="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",_,!1):s.attachEvent("onmessage",_),function(w){s.postMessage(f+w,"*")}):s.MessageChannel?((u=new MessageChannel).port1.onmessage=function(w){b(w.data)},function(w){u.port2.postMessage(w)}):p&&"onreadystatechange"in p.createElement("script")?(c=p.documentElement,function(w){var C=p.createElement("script");C.onreadystatechange=function(){b(w),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(w){setTimeout(b,0,w)},m.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var C=new Array(arguments.length-1),O=0;O<C.length;O++)C[O]=arguments[O+1];var T={callback:w,args:C};return h[d]=T,l(d),d++},m.clearImmediate=y}function y(w){delete h[w]}function b(w){if(g)setTimeout(b,0,w);else{var C=h[w];if(C){g=!0;try{(function(O){var T=O.callback,I=O.args;switch(I.length){case 0:T();break;case 1:T(I[0]);break;case 2:T(I[0],I[1]);break;case 3:T(I[0],I[1],I[2]);break;default:T.apply(a,I)}})(C)}finally{y(w),g=!1}}}}function _(w){w.source===s&&typeof w.data=="string"&&w.data.indexOf(f)===0&&b(+w.data.slice(f.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Xn<"u"?Xn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})($f);var rS=$f.exports;const iS=li(rS),oS="4.2.2",sS={dataType:null,batchType:null,id:"zip",module:"zip",name:"Zip Archive",version:oS,extensions:["zip"],mimeTypes:["application/zip"],category:"archive",tests:["PK"],options:{},parse:aS};async function aS(t,e={}){const n=[],r={};try{const i=new iS;return(await i.loadAsync(t,e)).forEach((s,a)=>{const l=a.name,c=lS(i,l,e).then(u=>{r[s]=u});n.push(c)}),await Promise.all(n),r}catch(i){throw e.log.error(`Unable to read zip archive: ${i}`),i}}async function lS(t,e,n={}){try{return await t.file(e).async(n.dataType||"arraybuffer")}catch(r){return n.log.error(`Unable to read ${e} from zip archive: ${r}`),r}}function cS({data:t,world:e,selectLayer:n}){let r=[];new Hr({id:"GeoJsonLayer",data:e,stroked:!0,filled:!0,pickable:!1,getFillColor:[160,160,180,200],getLineColor:[0,0,0,255],lineWidthMinPixels:1,getLineWidth:1});const i=new jr({id:"ScatterplotLayer",data:t,stroked:!0,getPosition:l=>[l.X,l.Y],getRadius:2,getFillColor:[255,140,0],getLineColor:[0,0,0],getLineWidth:1,radiusScale:6,pickable:!1}),o=new Do({id:"HeatmapLayer",data:t,aggregation:"SUM",getPosition:l=>[l.X,l.Y],weightsTextureSize:512}),s=new Lo({id:"HexagonLayer",data:t,opacity:.9,extruded:!0,getPosition:l=>[l.X,l.Y],elevationScale:4,radius:200,pickable:!1}),a=new Bo({data:"https://c.tile.openstreetmap.org/{z}/{x}/{y}.png",minZoom:0,maxZoom:19,tileSize:256,renderSubLayers:l=>{const{bbox:{west:c,south:u,east:f,north:d}}=l.tile;return new xo(l,{data:null,image:l.data,bounds:[c,u,f,d]})}});return r.push(a),n===""&&r.push(s),n===""&&r.push(o),n===""&&r.push(i),console.log("select",n),console.log("layer",r),r}const uS=async(t,e)=>{const n=t.body.getReader(),r=+t.headers.get("Content-Length");let i=0,o=[];for(;;){const{done:l,value:c}=await n.read();if(l)break;o.push(c),i+=c.length,e&&e(~~(i/r*100))}let s=new Uint8Array(i),a=0;for(let l of o)s.set(l,a),a+=l.length;return s},Gl=async(t,e,n)=>{const r=await sd(t),i=t.split("/"),o=i[i.length-1],s=uS(r,function(u){n&&n({fileName:o,rate:u})}),a=await Jl(s,sS),l=await Object.keys(a);let c=[];for(let u=0;u<l.length;u++){const f=await ad(a[l[u]],e);c.push(f)}return c};/* @license
Papa Parse
v5.0.0-beta.0
https://github.com/mholt/PapaParse
License: MIT
*/const Kl="\uFEFF",Ge={parse:fS,unparse:dS,RECORD_SEP:"",UNIT_SEP:"",BYTE_ORDER_MARK:Kl,BAD_DELIMITERS:["\r",`
`,'"',Kl],WORKERS_SUPPORTED:!1,NODE_STREAM_INPUT:1,LocalChunkSize:1024*1024*10,RemoteChunkSize:1024*1024*5,DefaultDelimiter:",",Parser:jo,ParserHandle:Bf,ChunkStreamer:Ff,StringStreamer:fn};function fS(t,e,n){e=e||{};var r=e.dynamicTyping||!1;if(Ne(r)&&(e.dynamicTypingFunction=r,r={}),e.dynamicTyping=r,e.transform=Ne(e.transform)?e.transform:!1,e.worker&&Ge.WORKERS_SUPPORTED){var i=newWorker();i.userStep=e.step,i.userChunk=e.chunk,i.userComplete=e.complete,i.userError=e.error,e.step=Ne(e.step),e.chunk=Ne(e.chunk),e.complete=Ne(e.complete),e.error=Ne(e.error),delete e.worker,i.postMessage({input:t,config:e,workerId:i.id});return}var o=null;return typeof t=="string"&&(o=new fn(e)),o||(o=new n(e)),o.stream(t)}function dS(t,e){var n=!1,r=!0,i=",",o=`\r
`,s='"',a=s+s,l=!1,c=null;f();var u=new RegExp(Un(s),"g");if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return h(null,t,l);if(typeof t[0]=="object")return h(c||d(t[0]),t,l)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:d(t.data[0])),!Array.isArray(t.data[0])&&typeof t.data[0]!="object"&&(t.data=[t.data])),h(t.fields||[],t.data||[],l);throw new Error("Unable to serialize unrecognized input");function f(){if(typeof e=="object"){if(typeof e.delimiter=="string"&&!Ge.BAD_DELIMITERS.filter(function(m){return e.delimiter.indexOf(m)!==-1}).length&&(i=e.delimiter),(typeof e.quotes=="boolean"||Array.isArray(e.quotes))&&(n=e.quotes),(typeof e.skipEmptyLines=="boolean"||typeof e.skipEmptyLines=="string")&&(l=e.skipEmptyLines),typeof e.newline=="string"&&(o=e.newline),typeof e.quoteChar=="string"&&(s=e.quoteChar),typeof e.header=="boolean"&&(r=e.header),Array.isArray(e.columns)){if(e.columns.length===0)throw new Error("Option columns is empty");c=e.columns}e.escapeChar!==void 0&&(a=e.escapeChar+s)}}function d(m){if(typeof m!="object")return[];var y=[];for(var b in m)y.push(b);return y}function h(m,y,b){var _="";typeof m=="string"&&(m=JSON.parse(m)),typeof y=="string"&&(y=JSON.parse(y));var w=Array.isArray(m)&&m.length>0,C=!Array.isArray(y[0]);if(w&&r){for(var O=0;O<m.length;O++)O>0&&(_+=i),_+=g(m[O],O);y.length>0&&(_+=o)}for(var T=0;T<y.length;T++){var I=w?m.length:y[T].length,k=!1,M=w?Object.keys(y[T]).length===0:y[T].length===0;if(b&&!w&&(k=b==="greedy"?y[T].join("").trim()==="":y[T].length===1&&y[T][0].length===0),b==="greedy"&&w){for(var j=[],S=0;S<I;S++){var L=C?m[S]:S;j.push(y[T][L])}k=j.join("").trim()===""}if(!k){for(var x=0;x<I;x++){x>0&&!M&&(_+=i);var z=w&&C?m[x]:x;_+=g(y[T][z],x)}T<y.length-1&&(!b||I>0&&!M)&&(_+=o)}}return _}function g(m,y){if(typeof m>"u"||m===null)return"";if(m.constructor===Date)return JSON.stringify(m).slice(1,25);m=m.toString().replace(u,a);var b=typeof n=="boolean"&&n||Array.isArray(n)&&n[y]||p(m,Ge.BAD_DELIMITERS)||m.indexOf(i)>-1||m.charAt(0)===" "||m.charAt(m.length-1)===" ";return b?s+m+s:m}function p(m,y){for(var b=0;b<y.length;b++)if(m.indexOf(y[b])>-1)return!0;return!1}}function Ff(t){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},e.call(this,t),this.parseChunk=function(n,r){if(this.isFirstChunk&&Ne(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(n);i!==void 0&&(n=i)}this.isFirstChunk=!1;var o=this._partialLine+n;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!(this._handle.paused()||this._handle.aborted())){var a=s.meta.cursor;this._finished||(this._partialLine=o.substring(a-this._baseIndex),this._baseIndex=a),s&&s.data&&(this._rowCount+=s.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(Ne(this._config.chunk)&&!r){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return;s=void 0,this._completeResults=void 0}return!this._config.step&&!this._config.chunk&&(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),!this._completed&&l&&Ne(this._config.complete)&&(!s||!s.meta.aborted)&&(this._config.complete(this._completeResults,this._input),this._completed=!0),!l&&(!s||!s.meta.paused)&&this._nextChunk(),s}},this._sendError=function(n){Ne(this._config.error)&&this._config.error(n)};function e(n){var r=ws(n);r.chunkSize=parseInt(r.chunkSize),!n.step&&!n.chunk&&(r.chunkSize=null),this._handle=new Bf(r),this._handle.streamer=this,this._config=r}}function fn(t){t=t||{},Ff.call(this,t);var e;this.stream=function(n){return e=n,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var n=this._config.chunkSize,r=n?e.substr(0,n):e;return e=n?e.substr(n):"",this._finished=!e,this.parseChunk(r)}}}fn.prototype=Object.create(fn.prototype);fn.prototype.constructor=fn;function Bf(t){var e=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,n=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,r=this,i=0,o=0,s,a,l=!1,c=!1,u,f=[],d={data:[],errors:[],meta:{}};if(Ne(t.step)){var h=t.step;t.step=function(I){if(d=I,m())p();else{if(p(),!d.data||d.data.length===0)return;i+=I.data.length,t.preview&&i>t.preview?a.abort():h(d,r)}}}this.parse=function(I,k,M){var j=t.quoteChar||'"';if(t.newline||(t.newline=O(I,j)),u=!1,t.delimiter)Ne(t.delimiter)&&(t.delimiter=t.delimiter(I),d.meta.delimiter=t.delimiter);else{var S=C(I,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess);S.successful?t.delimiter=S.bestDelimiter:(u=!0,t.delimiter=Ge.DefaultDelimiter),d.meta.delimiter=t.delimiter}var L=ws(t);return t.preview&&t.header&&L.preview++,s=I,a=new jo(L),d=a.parse(s,k,M),p(),l?{meta:{paused:!0}}:d||{meta:{paused:!1}}},this.paused=function(){return l},this.pause=function(){l=!0,a.abort(),s=s.substr(a.getCharIndex())},this.resume=function(){l=!1,r.streamer.parseChunk(s,!0)},this.aborted=function(){return c},this.abort=function(){c=!0,a.abort(),d.meta.aborted=!0,Ne(t.complete)&&t.complete(d),s=""};function g(I){return t.skipEmptyLines==="greedy"?I.join("").trim()==="":I.length===1&&I[0].length===0}function p(){if(d&&u&&(T("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+Ge.DefaultDelimiter+"'"),u=!1),t.skipEmptyLines)for(var I=0;I<d.data.length;I++)g(d.data[I])&&d.data.splice(I--,1);return m()&&y(),w()}function m(){return t.header&&f.length===0}function y(){if(!d)return;function I(M){Ne(t.transformHeader)&&(M=t.transformHeader(M)),f.push(M)}if(Array.isArray(d.data[0])){for(var k=0;m()&&k<d.data.length;k++)d.data[k].forEach(I);d.data.splice(0,1)}else d.data.forEach(I)}function b(I){return t.dynamicTypingFunction&&t.dynamicTyping[I]===void 0&&(t.dynamicTyping[I]=t.dynamicTypingFunction(I)),(t.dynamicTyping[I]||t.dynamicTyping)===!0}function _(I,k){return b(I)?k==="true"||k==="TRUE"?!0:k==="false"||k==="FALSE"?!1:e.test(k)?parseFloat(k):n.test(k)?new Date(k):k===""?null:k:k}function w(){if(!d||!d.data||!t.header&&!t.dynamicTyping&&!t.transform)return d;function I(M,j){var S=t.header?{}:[],L;for(L=0;L<M.length;L++){var x=L,z=M[L];t.header&&(x=L>=f.length?"__parsed_extra":f[L]),t.transform&&(z=t.transform(z,x)),z=_(x,z),x==="__parsed_extra"?(S[x]=S[x]||[],S[x].push(z)):S[x]=z}return t.header&&(L>f.length?T("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+L,o+j):L<f.length&&T("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+L,o+j)),S}var k=1;return!d.data[0]||Array.isArray(d.data[0])?(d.data=d.data.map(I),k=d.data.length):d.data=I(d.data,0),t.header&&d.meta&&(d.meta.fields=f),o+=k,d}function C(I,k,M,j,S){var L,x,z;S=S||[",","	","|",";",Ge.RECORD_SEP,Ge.UNIT_SEP];for(var q=0;q<S.length;q++){var W=S[q],X=0,V=0,te=0;z=void 0;for(var N=new jo({comments:j,delimiter:W,newline:k,preview:10}).parse(I),$=0;$<N.data.length;$++){if(M&&g(N.data[$])){te++;continue}var ee=N.data[$].length;if(V+=ee,typeof z>"u"){z=0;continue}else ee>1&&(X+=Math.abs(ee-z),z=ee)}N.data.length>0&&(V/=N.data.length-te),(typeof x>"u"||X>x)&&V>1.99&&(x=X,L=W)}return t.delimiter=L,{successful:!!L,bestDelimiter:L}}function O(I,k){I=I.substr(0,1024*1024);var M=new RegExp(Un(k)+"([^]*?)"+Un(k),"gm");I=I.replace(M,"");var j=I.split("\r"),S=I.split(`
`),L=S.length>1&&S[0].length<j[0].length;if(j.length===1||L)return`
`;for(var x=0,z=0;z<j.length;z++)j[z][0]===`
`&&x++;return x>=j.length/2?`\r
`:"\r"}function T(I,k,M,j){d.errors.push({type:I,code:k,message:M,row:j})}}function Un(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function jo(t){t=t||{};var e=t.delimiter,n=t.newline,r=t.comments,i=t.step,o=t.preview,s=t.fastMode,a;t.quoteChar===void 0?a='"':a=t.quoteChar;var l=a;if(t.escapeChar!==void 0&&(l=t.escapeChar),(typeof e!="string"||Ge.BAD_DELIMITERS.indexOf(e)>-1)&&(e=","),r===e)throw new Error("Comment character same as delimiter");r===!0?r="#":(typeof r!="string"||Ge.BAD_DELIMITERS.indexOf(r)>-1)&&(r=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var c=0,u=!1;this.parse=function(f,d,h){if(typeof f!="string")throw new Error("Input must be a string");var g=f.length,p=e.length,m=n.length,y=r.length,b=Ne(i);c=0;var _=[],w=[],C=[],O=0;if(!f)return N();if(s||s!==!1&&f.indexOf(a)===-1){for(var T=f.split(n),I=0;I<T.length;I++){if(C=T[I],c+=C.length,I!==T.length-1)c+=n.length;else if(h)return N();if(!(r&&C.substr(0,y)===r)){if(b){if(_=[],W(C.split(e)),$(),u)return N()}else W(C.split(e));if(o&&I>=o)return _=_.slice(0,o),N(!0)}}return N()}for(var k=f.indexOf(e,c),M=f.indexOf(n,c),j=new RegExp(Un(l)+Un(a),"g"),S;;){if(f[c]===a){for(S=c,c++;;){if(S=f.indexOf(a,S+1),S===-1)return h||w.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:_.length,index:c}),V();if(S===g-1){var L=f.substring(c,S).replace(j,a);return V(L)}if(a===l&&f[S+1]===l){S++;continue}if(!(a!==l&&S!==0&&f[S-1]===l)){var x=M===-1?k:Math.min(k,M),z=X(x);if(f[S+1+z]===e){if(C.push(f.substring(c,S).replace(j,a)),c=S+1+z+p,k=f.indexOf(e,c),M=f.indexOf(n,c),b&&($(),u))return N();if(o&&_.length>=o)return N(!0);break}var q=X(M);if(f.substr(S+1+q,m)===n){if(C.push(f.substring(c,S).replace(j,a)),te(S+1+q+m),k=f.indexOf(e,c),b&&($(),u))return N();if(o&&_.length>=o)return N(!0);break}w.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:_.length,index:c}),S++}}if(b&&($(),u))return N();if(o&&_.length>=o)return N(!0);continue}if(r&&C.length===0&&f.substr(c,y)===r){if(M===-1)return N();c=M+m,M=f.indexOf(n,c),k=f.indexOf(e,c);continue}if(k!==-1&&(k<M||M===-1)){C.push(f.substring(c,k)),c=k+p,k=f.indexOf(e,c);continue}if(M!==-1){if(C.push(f.substring(c,M)),te(M+m),b&&($(),u))return N();if(o&&_.length>=o)return N(!0);continue}break}return V();function W(ee){_.push(ee),O=c}function X(ee){var Q=0;if(ee!==-1){var J=f.substring(S+1,ee);J&&J.trim()===""&&(Q=J.length)}return Q}function V(ee){return h||(typeof ee>"u"&&(ee=f.substr(c)),C.push(ee),c=g,W(C),b&&$()),N()}function te(ee){c=ee,W(C),C=[],M=f.indexOf(n,c)}function N(ee,Q){var J=Q||!1;return{data:J?_[0]:_,errors:w,meta:{delimiter:e,linebreak:n,aborted:u,truncated:!!ee,cursor:O+(d||0)}}}function $(){i(N(void 0,!0)),_=[],w=[]}},this.abort=function(){u=!0},this.getCharIndex=function(){return c}}function ws(t){if(typeof t!="object"||t===null)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=ws(t[n]);return e}function Ne(t){return typeof t=="function"}const{ChunkStreamer:jf}=Ge;function Kr(t){t=t||{},jf.call(this,t),this.textDecoder=new TextDecoder(this._config.encoding),this.stream=async function(e){this._input=e;try{for await(const n of e)this.parseChunk(this.getStringChunk(n));this._finished=!0,this.parseChunk("")}catch(n){this._sendError(n)}},this._nextChunk=function(){},this.getStringChunk=function(e){return typeof e=="string"?e:this.textDecoder.decode(e,{stream:!0})}}Kr.prototype=Object.create(jf.prototype);Kr.prototype.constructor=Kr;const hS="4.2.2",Ss="object-row-table",Cs={dataType:null,batchType:null,id:"csv",module:"csv",name:"CSV",version:hS,extensions:["csv","tsv","dsv"],mimeTypes:["text/csv","text/tab-separated-values","text/dsv"],category:"table",parse:async(t,e)=>Zl(new TextDecoder().decode(t),e),parseText:(t,e)=>Zl(t,e),parseInBatches:pS,options:{csv:{shape:Ss,optimizeMemoryUsage:!1,header:"auto",columnPrefix:"column",quoteChar:'"',escapeChar:'"',dynamicTyping:!0,comments:!1,skipEmptyLines:!0,delimitersToGuess:[",","	","|",";"]}}};async function Zl(t,e){const n={...Cs.options.csv,...e==null?void 0:e.csv},r=gS(t),o=n.header==="auto"?Uf(r):!!n.header,s={...n,header:o,download:!1,transformHeader:o?Wf():void 0,error:f=>{throw new Error(f)}},a=Ge.parse(t,s),l=a.data,c=a.meta.fields||Vf(n.columnPrefix,r.length),u=n.shape||Ss;switch(u){case"object-row-table":return{shape:"object-row-table",data:l.map(f=>Array.isArray(f)?cd(f,c):f)};case"array-row-table":return{shape:"array-row-table",data:l.map(f=>Array.isArray(f)?f:ld(f,c))};default:throw new Error(u)}}function pS(t,e){e={...e},e.batchSize==="auto"&&(e.batchSize=4e3);const n={...Cs.options.csv,...e==null?void 0:e.csv},r=new ud;let i=!0,o=null,s=null,a=null;const l={...n,header:!1,download:!1,chunkSize:1024*1024*5,skipEmptyLines:!1,step(c){let u=c.data;if(n.skipEmptyLines&&u.flat().join("").trim()==="")return;const f=c.meta.cursor;if(i&&!o&&(n.header==="auto"?Uf(u):!!n.header)){o=u.map(Wf());return}i&&(i=!1,o||(o=Vf(n.columnPrefix,u.length)),a=mS(u,o)),n.optimizeMemoryUsage&&(u=JSON.parse(JSON.stringify(u)));const d=n.shape||Ss;s=s||new nc(a,{shape:d,...e});try{s.addRow(u);const h=s&&s.getFullBatch({bytesUsed:f});h&&r.enqueue(h)}catch(h){r.enqueue(h)}},complete(c){try{const u=c.meta.cursor,f=s&&s.getFinalBatch({bytesUsed:u});f&&r.enqueue(f)}catch(u){r.enqueue(u)}r.close()}};return Ge.parse(t,l,Kr),r}function Uf(t){return t&&t.every(e=>typeof e=="string")}function gS(t){return Ge.parse(t,{download:!1,dynamicTyping:!0,preview:1}).data[0]}function Wf(){const t=new Set;return e=>{let n=e,r=1;for(;t.has(n);)n=`${e}.${r}`,r++;return t.add(n),n}}function Vf(t,e=0){const n=[];for(let r=0;r<e;r++)n.push(`${t}${r+1}`);return n}function mS(t,e){const n=e?{}:[];for(let r=0;r<t.length;r++){const i=e&&e[r]||r;switch(typeof t[r]){case"number":case"boolean":n[i]={name:String(i),index:r,type:Float32Array};break;case"string":default:n[i]={name:String(i),index:r,type:Array}}}return n}function yS(t,e){var n;try{const r=JSON.parse(t);if((n=e.json)!=null&&n.table){const i=Hf(r)||r;return fd(i)}return r}catch{throw new Error("JSONLoader: failed to parse JSON")}}function Hf(t){if(Array.isArray(t))return t;if(t&&typeof t=="object")for(const e of Object.values(t)){const n=Hf(e);if(n)return n}return null}const Uo=Number.MAX_SAFE_INTEGER;var re;(function(t){t[t.BEGIN=0]="BEGIN",t[t.VALUE=1]="VALUE",t[t.OPEN_OBJECT=2]="OPEN_OBJECT",t[t.CLOSE_OBJECT=3]="CLOSE_OBJECT",t[t.OPEN_ARRAY=4]="OPEN_ARRAY",t[t.CLOSE_ARRAY=5]="CLOSE_ARRAY",t[t.TEXT_ESCAPE=6]="TEXT_ESCAPE",t[t.STRING=7]="STRING",t[t.BACKSLASH=8]="BACKSLASH",t[t.END=9]="END",t[t.OPEN_KEY=10]="OPEN_KEY",t[t.CLOSE_KEY=11]="CLOSE_KEY",t[t.TRUE=12]="TRUE",t[t.TRUE2=13]="TRUE2",t[t.TRUE3=14]="TRUE3",t[t.FALSE=15]="FALSE",t[t.FALSE2=16]="FALSE2",t[t.FALSE3=17]="FALSE3",t[t.FALSE4=18]="FALSE4",t[t.NULL=19]="NULL",t[t.NULL2=20]="NULL2",t[t.NULL3=21]="NULL3",t[t.NUMBER_DECIMAL_POINT=22]="NUMBER_DECIMAL_POINT",t[t.NUMBER_DIGIT=23]="NUMBER_DIGIT"})(re||(re={}));const se={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125},Yl=/[\\"\n]/g,ql={onready:()=>{},onopenobject:()=>{},onkey:()=>{},oncloseobject:()=>{},onopenarray:()=>{},onclosearray:()=>{},onvalue:()=>{},onerror:()=>{},onend:()=>{},onchunkparsed:()=>{}};class vS{constructor(e={}){pe(this,"options",ql);pe(this,"bufferCheckPosition",Uo);pe(this,"q","");pe(this,"c","");pe(this,"p","");pe(this,"closed",!1);pe(this,"closedRoot",!1);pe(this,"sawRoot",!1);pe(this,"error",null);pe(this,"state",re.BEGIN);pe(this,"stack",[]);pe(this,"position",0);pe(this,"column",0);pe(this,"line",1);pe(this,"slashed",!1);pe(this,"unicodeI",0);pe(this,"unicodeS",null);pe(this,"depth",0);pe(this,"textNode");pe(this,"numberNode");this.options={...ql,...e},this.textNode=void 0,this.numberNode="",this.emit("onready")}end(){return(this.state!==re.VALUE||this.depth!==0)&&this._error("Unexpected end"),this._closeValue(),this.c="",this.closed=!0,this.emit("onend"),this}resume(){return this.error=null,this}close(){return this.write(null)}emit(e,n){var r,i;(i=(r=this.options)[e])==null||i.call(r,n,this)}emitNode(e,n){this._closeValue(),this.emit(e,n)}write(e){if(this.error)throw this.error;if(this.closed)return this._error("Cannot write after close. Assign an onready handler.");if(e===null)return this.end();let n=0,r=e.charCodeAt(0),i=this.p;for(;r&&(i=r,this.c=r=e.charCodeAt(n++),i!==r?this.p=i:i=this.p,!!r);)switch(this.position++,r===se.lineFeed?(this.line++,this.column=0):this.column++,this.state){case re.BEGIN:r===se.openBrace?this.state=re.OPEN_OBJECT:r===se.openBracket?this.state=re.OPEN_ARRAY:En(r)||this._error("Non-whitespace before {[.");continue;case re.OPEN_KEY:case re.OPEN_OBJECT:if(En(r))continue;if(this.state===re.OPEN_KEY)this.stack.push(re.CLOSE_KEY);else if(r===se.closeBrace){this.emit("onopenobject"),this.depth++,this.emit("oncloseobject"),this.depth--,this.state=this.stack.pop()||re.VALUE;continue}else this.stack.push(re.CLOSE_OBJECT);r===se.doubleQuote?this.state=re.STRING:this._error('Malformed object key should start with "');continue;case re.CLOSE_KEY:case re.CLOSE_OBJECT:if(En(r))continue;r===se.colon?(this.state===re.CLOSE_OBJECT?(this.stack.push(re.CLOSE_OBJECT),this._closeValue("onopenobject"),this.depth++):this._closeValue("onkey"),this.state=re.VALUE):r===se.closeBrace?(this.emitNode("oncloseobject"),this.depth--,this.state=this.stack.pop()||re.VALUE):r===se.comma?(this.state===re.CLOSE_OBJECT&&this.stack.push(re.CLOSE_OBJECT),this._closeValue(),this.state=re.OPEN_KEY):this._error("Bad object");continue;case re.OPEN_ARRAY:case re.VALUE:if(En(r))continue;if(this.state===re.OPEN_ARRAY)if(this.emit("onopenarray"),this.depth++,this.state=re.VALUE,r===se.closeBracket){this.emit("onclosearray"),this.depth--,this.state=this.stack.pop()||re.VALUE;continue}else this.stack.push(re.CLOSE_ARRAY);r===se.doubleQuote?this.state=re.STRING:r===se.openBrace?this.state=re.OPEN_OBJECT:r===se.openBracket?this.state=re.OPEN_ARRAY:r===se.t?this.state=re.TRUE:r===se.f?this.state=re.FALSE:r===se.n?this.state=re.NULL:r===se.minus?this.numberNode+="-":se._0<=r&&r<=se._9?(this.numberNode+=String.fromCharCode(r),this.state=re.NUMBER_DIGIT):this._error("Bad value");continue;case re.CLOSE_ARRAY:if(r===se.comma)this.stack.push(re.CLOSE_ARRAY),this._closeValue("onvalue"),this.state=re.VALUE;else if(r===se.closeBracket)this.emitNode("onclosearray"),this.depth--,this.state=this.stack.pop()||re.VALUE;else{if(En(r))continue;this._error("Bad array")}continue;case re.STRING:this.textNode===void 0&&(this.textNode="");let o=n-1,s=this.slashed,a=this.unicodeI;e:for(;;){for(;a>0;)if(this.unicodeS+=String.fromCharCode(r),r=e.charCodeAt(n++),this.position++,a===4?(this.textNode+=String.fromCharCode(parseInt(this.unicodeS,16)),a=0,o=n-1):a++,!r)break e;if(r===se.doubleQuote&&!s){this.state=this.stack.pop()||re.VALUE,this.textNode+=e.substring(o,n-1),this.position+=n-1-o;break}if(r===se.backslash&&!s&&(s=!0,this.textNode+=e.substring(o,n-1),this.position+=n-1-o,r=e.charCodeAt(n++),this.position++,!r))break;if(s){if(s=!1,r===se.n?this.textNode+=`
`:r===se.r?this.textNode+="\r":r===se.t?this.textNode+="	":r===se.f?this.textNode+="\f":r===se.b?this.textNode+="\b":r===se.u?(a=1,this.unicodeS=""):this.textNode+=String.fromCharCode(r),r=e.charCodeAt(n++),this.position++,o=n-1,r)continue;break}Yl.lastIndex=n;const l=Yl.exec(e);if(l===null){n=e.length+1,this.textNode+=e.substring(o,n-1),this.position+=n-1-o;break}if(n=l.index+1,r=e.charCodeAt(l.index),!r){this.textNode+=e.substring(o,n-1),this.position+=n-1-o;break}}this.slashed=s,this.unicodeI=a;continue;case re.TRUE:r===se.r?this.state=re.TRUE2:this._error(`Invalid true started with t${r}`);continue;case re.TRUE2:r===se.u?this.state=re.TRUE3:this._error(`Invalid true started with tr${r}`);continue;case re.TRUE3:r===se.e?(this.emit("onvalue",!0),this.state=this.stack.pop()||re.VALUE):this._error(`Invalid true started with tru${r}`);continue;case re.FALSE:r===se.a?this.state=re.FALSE2:this._error(`Invalid false started with f${r}`);continue;case re.FALSE2:r===se.l?this.state=re.FALSE3:this._error(`Invalid false started with fa${r}`);continue;case re.FALSE3:r===se.s?this.state=re.FALSE4:this._error(`Invalid false started with fal${r}`);continue;case re.FALSE4:r===se.e?(this.emit("onvalue",!1),this.state=this.stack.pop()||re.VALUE):this._error(`Invalid false started with fals${r}`);continue;case re.NULL:r===se.u?this.state=re.NULL2:this._error(`Invalid null started with n${r}`);continue;case re.NULL2:r===se.l?this.state=re.NULL3:this._error(`Invalid null started with nu${r}`);continue;case re.NULL3:r===se.l?(this.emit("onvalue",null),this.state=this.stack.pop()||re.VALUE):this._error(`Invalid null started with nul${r}`);continue;case re.NUMBER_DECIMAL_POINT:r===se.period?(this.numberNode+=".",this.state=re.NUMBER_DIGIT):this._error("Leading zero not followed by .");continue;case re.NUMBER_DIGIT:se._0<=r&&r<=se._9?this.numberNode+=String.fromCharCode(r):r===se.period?(this.numberNode.indexOf(".")!==-1&&this._error("Invalid number has two dots"),this.numberNode+="."):r===se.e||r===se.E?((this.numberNode.indexOf("e")!==-1||this.numberNode.indexOf("E")!==-1)&&this._error("Invalid number has two exponential"),this.numberNode+="e"):r===se.plus||r===se.minus?(i===se.e||i===se.E||this._error("Invalid symbol in number"),this.numberNode+=String.fromCharCode(r)):(this._closeNumber(),n--,this.state=this.stack.pop()||re.VALUE);continue;default:this._error(`Unknown state: ${this.state}`)}return this.position>=this.bufferCheckPosition&&bS(this),this.emit("onchunkparsed"),this}_closeValue(e="onvalue"){this.textNode!==void 0&&this.emit(e,this.textNode),this.textNode=void 0}_closeNumber(){this.numberNode&&this.emit("onvalue",parseFloat(this.numberNode)),this.numberNode=""}_error(e=""){this._closeValue(),e+=`
Line: ${this.line}
Column: ${this.column}
Char: ${this.c}`;const n=new Error(e);this.error=n,this.emit("onerror",n)}}function En(t){return t===se.carriageReturn||t===se.lineFeed||t===se.space||t===se.tab}function bS(t){const e=Math.max(Uo,10);let n=0;for(const r of["textNode","numberNode"]){const i=t[r]===void 0?0:t[r].length;if(i>e)switch(r){case"text":break;default:t._error(`Max buffer length exceeded: ${r}`)}n=Math.max(n,i)}t.bufferCheckPosition=Uo-n+t.position}class Ft{constructor(e=null){pe(this,"path");if(this.path=["$"],e instanceof Ft){this.path=[...e.path];return}if(Array.isArray(e)){this.path.push(...e);return}if(typeof e=="string"&&(this.path=e.split("."),this.path[0]!=="$"))throw new Error("JSONPaths must start with $")}clone(){return new Ft(this)}toString(){return this.path.join(".")}push(e){this.path.push(e)}pop(){return this.path.pop()}set(e){this.path[this.path.length-1]=e}equals(e){if(!this||!e||this.path.length!==e.path.length)return!1;for(let n=0;n<this.path.length;++n)if(this.path[n]!==e.path[n])return!1;return!0}setFieldAtPath(e,n){const r=[...this.path];r.shift();const i=r.pop();for(const o of r)e=e[o];e[i]=n}getFieldAtPath(e){const n=[...this.path];n.shift();const r=n.pop();for(const i of n)e=e[i];return e[r]}}class xS{constructor(e){pe(this,"parser");pe(this,"result");pe(this,"previousStates",[]);pe(this,"currentState",Object.freeze({container:[],key:null}));pe(this,"jsonpath",new Ft);this.reset(),this.parser=new vS({onready:()=>{this.jsonpath=new Ft,this.previousStates.length=0,this.currentState.container.length=0},onopenobject:n=>{this._openObject({}),typeof n<"u"&&this.parser.emit("onkey",n)},onkey:n=>{this.jsonpath.set(n),this.currentState.key=n},oncloseobject:()=>{this._closeObject()},onopenarray:()=>{this._openArray()},onclosearray:()=>{this._closeArray()},onvalue:n=>{this._pushOrSet(n)},onerror:n=>{throw n},onend:()=>{this.result=this.currentState.container.pop()},...e})}reset(){this.result=void 0,this.previousStates=[],this.currentState=Object.freeze({container:[],key:null}),this.jsonpath=new Ft}write(e){this.parser.write(e)}close(){this.parser.close()}_pushOrSet(e){const{container:n,key:r}=this.currentState;r!==null?(n[r]=e,this.currentState.key=null):n.push(e)}_openArray(e=[]){this.jsonpath.push(null),this._pushOrSet(e),this.previousStates.push(this.currentState),this.currentState={container:e,isArray:!0,key:null}}_closeArray(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}_openObject(e={}){this.jsonpath.push(null),this._pushOrSet(e),this.previousStates.push(this.currentState),this.currentState={container:e,isArray:!1,key:null}}_closeObject(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}}class _S extends xS{constructor(n={}){super({onopenarray:()=>{if(!this.streamingArray&&this._matchJSONPath()){this.streamingJsonPath=this.getJsonPath().clone(),this.streamingArray=[],this._openArray(this.streamingArray);return}this._openArray()},onopenobject:i=>{this.topLevelObject?this._openObject({}):(this.topLevelObject={},this._openObject(this.topLevelObject)),typeof i<"u"&&this.parser.emit("onkey",i)}});pe(this,"jsonPaths");pe(this,"streamingJsonPath",null);pe(this,"streamingArray",null);pe(this,"topLevelObject",null);const r=n.jsonpaths||[];this.jsonPaths=r.map(i=>new Ft(i))}write(n){super.write(n);let r=[];return this.streamingArray&&(r=[...this.streamingArray],this.streamingArray.length=0),r}getPartialResult(){return this.topLevelObject}getStreamingJsonPath(){return this.streamingJsonPath}getStreamingJsonPathAsString(){return this.streamingJsonPath&&this.streamingJsonPath.toString()}getJsonPath(){return this.jsonpath}_matchJSONPath(){const n=this.getJsonPath();if(this.jsonPaths.length===0)return!0;for(const r of this.jsonPaths)if(r.equals(n))return!0;return!1}}async function*wS(t,e){var f;const n=dd(t),{metadata:r}=e,{jsonpaths:i}=e.json||{};let o=!0;const s=null,a=new nc(s,e),l=new _S({jsonpaths:i});for await(const d of n){const h=l.write(d),g=h.length>0&&l.getStreamingJsonPathAsString();h.length>0&&o&&(r&&(yield{shape:((f=e==null?void 0:e.json)==null?void 0:f.shape)||"array-row-table",batchType:"partial-result",data:[],length:0,bytesUsed:0,container:l.getPartialResult(),jsonpath:g}),o=!1);for(const m of h){a.addRow(m);const y=a.getFullBatch({jsonpath:g});y&&(yield y)}a.chunkComplete(d);const p=a.getFullBatch({jsonpath:g});p&&(yield p)}const c=l.getStreamingJsonPathAsString(),u=a.getFinalBatch({jsonpath:c});u&&(yield u),r&&(yield{shape:"json",batchType:"final-result",container:l.getPartialResult(),jsonpath:l.getStreamingJsonPathAsString(),data:[],length:0})}const SS="4.2.2",Es={dataType:null,batchType:null,name:"JSON",id:"json",module:"json",version:SS,extensions:["json","geojson"],mimeTypes:["application/json"],category:"table",text:!0,options:{json:{shape:void 0,table:!1,jsonpaths:[]}},parse:CS,parseTextSync:Gf,parseInBatches:ES};async function CS(t,e){return Gf(new TextDecoder().decode(t),e)}function Gf(t,e){const n={...e,json:{...Es.options.json,...e==null?void 0:e.json}};return yS(t,n)}function ES(t,e){const n={...e,json:{...Es.options.json,...e==null?void 0:e.json}};return wS(t,n)}const PS=new hd({color:[255,255,255],intensity:1.5}),AS=new rc({timestamp:Date.UTC(2019,7,1,23),color:[255,255,255],intensity:3,_shadow:!0});new rc({timestamp:15549272e5,color:[255,255,255],intensity:10});new pd({ambientLight:PS,dirLight:AS});const TS={latitude:31.35849434267462,longitude:34.332168049944734,bearing:4.759615384615384,pitch:56.49901894659391,zoom:11};function OS(){const[t,e]=E.useState(TS),[n,r]=E.useState([]),[i,o]=E.useState([]),[s,a]=E.useState("");return h1("",{materialPreset:{value:"",options:["","",""],onChange:l=>{a(l)}}}),E.useEffect(()=>{(async()=>{const c=await Gl("./data/gaza_data.zip",Cs,f=>{});r(c[0].data);const u=await Gl("./data/ne_10m_admin_0_countries_jpn.zip",Es,f=>{});o(u[0])})()},[]),de.jsxs("div",{children:[de.jsx(gd,{initialViewState:t,controller:!0,layers:cS({data:n,world:i,selectLayer:s})}),de.jsx("div",{className:"attribution",children:de.jsx("a",{href:"http://www.openstreetmap.org/about/",target:"_blank",rel:"noopener noreferrer",children:" OpenStreetMap"})})]})}Gi.createRoot(document.getElementById("root")).render(de.jsx(OS,{}));
